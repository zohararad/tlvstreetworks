window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},Microsoft.Maps.Gimme=function(){var n=function(){function n(n){Array.prototype.push.apply(this,n)}function t(i,r){var u=!i&&[]||(r||typeof i=="string")&&t.query(i,r)||i instanceof Array&&i||[i];return new n(u)}function i(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i])}return i(n,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(n){return Array.prototype.sort.call(this,n),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){var t=Array.prototype.pop.call(this);return new n([t])},shift:function(){var t=Array.prototype.shift.call(this);return new n([t])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new n(Array.prototype.slice.apply(this,arguments))},splice:function(){return new n(Array.prototype.splice.apply(this,arguments))},concat:function(t){return new n(Array.prototype.concat.apply(this.entities(),t.entities&&t.entities()||arguments))}}),t.Helper={get_guid:function(){var n=0;return function(t){if(!t)return"";if(t===window)return"win";if(t===document)return"doc";if(t.uniqueID)return t.uniqueID;var i="__$gimme$_guid__";return typeof t[i]=="undefined"&&(t[i]=i+n++),t[i]}}()},t.Browser=function(){var n=navigator.userAgent.toLowerCase();return{is_ie:typeof ActiveXObject!="undefined",is_opera:typeof window.opera!="undefined",is_khtml:n.indexOf("khtml")!==-1,is_gecko:n.indexOf("khtml")===-1&&n.indexOf("gecko")!==-1,is_in_quirks_mode:document.compatMode==="BackCompat"}}(),t.undefined={}._$gimme$_undefined,t.ext=n.prototype,t}();return n.ext.select=function(t){return n(t,this[0])},typeof g=="undefined"&&(window.g=n),n.query=function(){return function(){function d(n,t,i){return u[t](n,i)}function k(n,t){var r=[],u=t.length,i;do i=p(n,t[--u]||t),i&&r.push(i);while(u);return r}function p(n,t){if(n===document||!t)return t;var i=t;while((i=i.parentNode)&&i!==n);return i===n&&t||null}function g(n,t){return p(n,document.getElementById(t))}function w(n,t){var u,f,i,e;t=t||document;if(n.id)return o([g(t,n.id)],n);delete n.id,u=t.getElementsByTagName(n.tag||"*");if((!n.classes||n.classes.length<1)&&(!n.attributes||n.attributes.length<1)&&(!n.pseudos||n.pseudos.length<1))return a(u);for(f=[],e=u.length,i=0;i<e;i++)r(n,u[i])&&f.push(u[i]);return f}function r(n,t){if(!t)return!1;for(var r=n.propNames,f=r.length,i=0;i<f;i++)if(!u[r[i]](t,n[r[i]]))return!1;return!0}function a(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]=n[t];return i}function o(n,t){for(var u=[],f=n.length,i=0;i<f;i++)n[i]&&n[i].nodeType===1&&r(t,n[i])&&u.push(n[i]);return u}function l(n,t){return h(n,t)!==-1}function c(n){var r;i.inc();for(var f=i.name,u=[],e=n.length,t=0;t<e;t++)r=n[t],r[f]!==i.t&&(r[f]=i.t,u.push(r));return u}function e(n){this.name=n,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function b(n){this.parse=function(t){var f,i,e=n.preprocessInput,r,u;t=e&&e(t)||t,n.reset(),r=0,u=t.length;while(r<u){f=t.charAt(r),i=i||n[f]||n["default"];if(i){advance=i(t.substring(r,u));if(!advance)throw'No valid match found for "'+i.name+'" rule';r+=advance}else throw'No suitable rule found to handle character "'+f+'"';i=null}return n.finish()}}function s(t,i){var b=i,e,r,h,o,c,l,s;i=i||document,n.inc();if(typeof t!="string")return k(i||document,t);r=[];try{r=a(i.querySelectorAll(t))}catch(p){for(h=y.parse(t),c=h.length,o=0;o<c;o++){var u=h[o],v=u.length,f=v%2-1;e=f===0?w(u[f],i):[i||document];while(u[++f])l=u[f++],s=u[f],s.root=i,e=d(e,l,s);r=c>1?r.concat(e):e}}return r}var i,t,n,u,v,y,h=function(){function t(n,t){return n.indexOf(t)}function n(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i]===t)return i;return-1}return typeof Array.prototype.indexOf!="undefined"?t:n}(),f=function(){function t(n,t){return n.getAttribute(t)}function n(n,t){switch(t.toLowerCase()){case"class":return n.className||null;case"id":return n.id||null;case"href":case"src":if(typeof n.getAttribute!="undefined")return n.getAttribute(t,2)}return n.attributes&&n.attributes[t]&&n.attributes[t].nodeValue||n.getAttribute(t)}return function(){var r=document.createElement("div"),i;return r.innerHTML='<a href="#test">test</a>',i=r.firstChild,i.getAttribute("href")==="#test"?t:n}()}();return i=new e("__$gimme$_unique__"),t=new e("__$gimme$_genSib__"),n=new e("__$gimme$_nth__"),u={id:function(n,t){return n.id===t},tag:function(n,t){return n.tagName===t||t==="*"},classes:function(n,t){var i=n.className,u,r;typeof i!="string"&&(i=f(n,"class"));if(!i)return!1;u=" "+i+" ",r=t.length;while(r--)if(u.indexOf(" "+t[r]+" ")===-1)return!1;return!0},attributes:function(){var t={},n={parse:function(n){var i=n.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return t[n]={name:i&&i[1],delim:i&&i[2],val:i&&i[3].replace(/^['"]|["']$/g,"")}},"=":function(n,t){return n===t},"^=":function(n,t){return n.indexOf(t)===0},"$=":function(n,t){var i=n.lastIndexOf(t);return i!==-1&&i+t.length===n.length},"*=":function(n,t){return n.indexOf(t)!==-1},"|=":function(n,t){return n===t||n.indexOf(t+"-")===0},"~=":function(n,t){return n===t||l(n.split(" "),t)},"!=":function(n,t){return n!==t},unknown:function(){return!1}};return function(i,r){var o=r.length,u,e;while(o--){u=t[r[o]]||n.parse(r[o]),e=f(i,u.name);if(!e)return!1;if(!u.delim)continue;if(!n[u.delim||"unknown"](e,u.val))return!1}return!0}}(),pseudos:function(){function i(n){var t=n+"Sibling";return function(n){var i=n[t];while(i&&i.nodeType!==1)i=i[t];return!i}}var r={},t={parse:function(n){var t=n.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),i={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return i.param.wholeValue==="even"?(i.param.a=2,i.param.b=0):i.param.wholeValue==="odd"&&(i.param.a=2,i.param.b=1),r[n]=i},"first-child":i("previous"),"last-child":i("next"),"only-child":function(n){return t["first-child"](n)&&t["last-child"](n)},"nth-child":function(t,i){var l=1e4,s=n.t*l,u=n.name,r=t.parentNode,h=0,f;if(r){if(r[u+":parent"]!==n.t){r[u+":parent"]=n.t;var h=0,a,e=r.children||r.childNodes,o=-1,c=e.length;while(++o<c)e[o].nodeType===1&&(h++,e[o][u]=s+h)}return f=t[u]-s-i.param.b,!i.param.a&&i.param.b?f===0:i.param.a*f>=0&&f%(i.param.a||1)==0}return!1},contains:function(n,t){return(n.textContent||n.innerText||n.innerHTML).indexOf(t.param.wholeValue)!==-1},not:function(){return!1}};return function(n,i){var f=i.length,u;while(f--){u=r[i[f]]||t.parse(i[f]);if(!t[u.name](n,u))return!1}return!0}}()," ":function(n,t){for(var u=[],f=n.length,r,i=0;i<f;i++){r=w(t,n[i]),u=u.concat(r);if(t.id&&r.length===1)break}return c(u)},">":function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r=r.concat(o(n[i].childNodes,t));return r},"+":function(n,t){for(var e=[],o=n.length,f,i,u=0;u<o;u++){f=n[u],i=f.nextSibling;while(i&&i.nodeType!==1)i=i.nextSibling;r(t,i)&&e.push(i)}return e},"~":function(n,i){var e,u;t.inc();for(var s=t.name,o=[],h=n.length,f=0;f<h;f++){e=n[f],u=e.nextSibling;while(u&&u[s]!==t.t)u.nodeType===1&&(u[s]=t.t,r(i,u)&&o.push(u)),u=u.nextSibling}return o}},v=new function(){function i(){this.propNames=[]}var r,t,n,u;return i.prototype.propNames=[],i.prototype.storePropertyValue=function(n,t){this[n]=t,this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},i.prototype.storeArrayValue=function(n,t){this[n]||(this[n]=[]),this[n].push(t),this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},u={preprocessInput:function(n){return n.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){r=[],t=[],n=new i},finish:function(){return n&&n.propNames.length>0&&t.push(n),t.length>0&&r.push(t),r},"default":function(t){var u="tag",r=t.match(/(\w+|\*)/),i;return r?(i=r[0].toUpperCase(),n.storePropertyValue(u,i),i.length):null},"#":function(t){var u="id",i=t.match(/#([_\-\w]+)/),r;return i?(r=i[1],n.storePropertyValue(u,r),i[0].length):null},".":function(t){var u="classes",i=t.match(/\.([_\-\w\d]+)/),r;if(i)return r=i[1],n.storeArrayValue(u,r),i[0].length},"[":function(t){var u="attributes",r=t.match(/(\[.*"\]|.*?\])/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null},":":function(t){var u="pseudos",r=t.match(/:[\w-_]+\b(\(.*\))?/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null}," ":function(){return t.push(n," "),n=new i,1},">":function(){return n.propNames.length>0&&t.push(n),t.push(">"),n=new i,1},"~":function(){return t.push(n,"~"),n=new i,1},"+":function(){return t.push(n,"+"),n=new i,1},",":function(){return t.push(n),r.push(t),t=[],n=new i,1}}},y=new b(v),s.Internal={unique:c,index_of:h,contains:l,has_class:u.classes,get_attr:f},s}()}(),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_attr=n.query.Internal.get_attr,n.Effects={Animation:function(n){function s(n){var r,o,s;_ease=e(n),r=t.length;while(r--){s={};for(o in u)s[o]=i[o][r]+u[o][r]*_ease;f(t[r],s,n)}}var t=n.elements||[],o=n.duration||1,i=n.from||{},r=n.to||{},u={},f,e;(function(){var f,n,h,e={},o={},s={};for(n in i){e[n]=[],o[n]=[],s[n]=[],f=t.length;while(f--)h=t[f],e[n][f]=typeof i[n]=="function"?i[n](h,n):i[n],o[n][f]=typeof r[n]=="function"?r[n](h,n):r[n],s[n][f]=o[n][f]-e[n][f]}i=e,r=o,u=s})(),f=n.animate,e=n.easing||function(n){return n},this.startTime=n.startTime||0,this.duration=o,this.add_element=function(n){t.push(n)},this.remove_element=function(n){var i=t.length;while(i--)if(t[i]===n){t.splice(i,1);break}},this.tick=s},Storyboard:function(n){function r(){f||(f=!0,e=+new Date,l=setInterval(b,1))}function nt(){t=0,i=1,r()}function w(){s(),a&&a(t)}function s(){clearInterval(l),f=!1}function g(){r()}function d(){i=1,r()}function rt(){i=-1,r()}function it(){i*=-1,r()}function tt(n){t=n,h()}function p(){return f}function y(){return i}function v(){return u}function k(){return o}function b(){var n=+new Date;t+=(n-e)/o*i,e=n,t=t<0?0:t>1?1:t,h(),(i===-1&&t===0||i===1&&t===1)&&(s(),c&&c(t))}function h(){var r=u.length,n;while(r--)n=(o*t-u[r].startTime)/u[r].duration,n=i===-1&&n<0?0:i===1&&n>1?1:n,n<0||n>1||u[r].tick(n)}var l,e,t=0,i=1,f=!1,u=n.animations,o=n.duration||0,c=n.completed,a=n.aborted;this.begin=nt,this.abort=w,this.pause=s,this.resume=g,this.forward=d,this.backward=rt,this.reverse=it,this.seek=tt,this.is_running=p,this.get_direction=y,this.get_animations=v,this.get_duration=k},Easing:{Back:new function(){function i(n,t,i,r){return t=.5,i=0,r=.5,Math.pow(1-n,i)*r*Math.sin(2*Math.PI*n*t)*-1+n}function t(){}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Bounce:new function(){function r(n,t,i){return t=t||1.5,i=i||4,Math.abs(Math.pow(n,t)*Math.cos(Math.PI*n*i))}function i(t,i,r){return 1-n.Effects.Easing.Bounce.ease_in(1-t,i,r)}function t(t,i,r){var e=1,f=0,u=n.Effects.Easing.Bounce.ease_in;return t>.5&&(u=n.Effects.Easing.Bounce.ease_out,t-=.5,f=e/2),u(t,i,r)-f}this.ease_in=r,this.ease_out=i,this.ease_in_out=t},Elastic:new function(){function i(){}function t(n,t,i){return t=t||3.5,i=i||5,1-Math.pow(1-n,t)*Math.cos(2*Math.PI*n*i)}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Exponential:new function(){function t(n,t){return Math.pow(n,t)}function n(n,t){return Math.pow(n,1/t)}function i(i,r){return i<=.5?t(i*2,r)*.5:n((i-.5)*2,r)*.5+.5}this.ease_in=t,this.ease_out=n,this.ease_in_out=i}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:function(){var t={};return{add:function(n,i){t[n]=i},remove:function(n){delete t[n]},get:function(i){return t[i]||new n.Effects.Storyboard({animations:[]})},contains:function(n){return!!t[n]}}}()},n.Effects.Storyboard.create=function(t,i,r,u,f,e,o,s){f=Math.floor(f)||n.Effects.Enums.Speeds[f]||n.Effects.Enums.Speeds.quickly;var h=new n.Effects.Storyboard({duration:f,completed:function(){o&&o.call(this),n.Effects.RunningAnimations.remove(e),h=null},aborted:function(){n.Effects.RunningAnimations.remove(e),h=null},animations:[new n.Effects.Animation({from:i,to:r,duration:f,animate:u,easing:s,elements:t})]});return e&&n.Effects.RunningAnimations.add(e,h),h},function(){var t=0,i={};n.Effects.Animation.requestAnimationFrame=function(){function r(n,t){return function(){i[t]&&n(+new Date),delete i[t]}}function e(n,f){var e=i[++t]=r(n,t);return u(e,f),t}function f(u){var f=i[++t]=r(u,t);return n.setTimeout(f,o),t}var o=16,n=window,u=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame;return u?e:f}(),n.Effects.Animation.cancelAnimationFrame=function(n){delete i[n]}}(),n.Ajax=new function(){function t(t,i){n(t,i,!0)}function r(t,i){n(t,i,!1)}function i(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw new Error("Error invoking XMLHTTP");}else throw new Error("XMLHttp is not supported");}function n(n,t,r){var u=i();u.onreadystatechange=function(){if(u.readyState===4){var n=u.responseText;r&&n&&(n=eval("("+u.responseText+")")),t.call(u,n,u.status),u=null,callback=null}},u.open("GET",n,!0),u.send("")}this.request_json=t,this.request_ahah=r},n.Screen=new function(){function r(){var n={width:0,height:0};return n=typeof window.innerWidth!="undefined"?{width:window.innerWidth,height:window.innerHeight}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}function i(n){var t,i;return n=n||window.event,t={x:0,y:0},typeof n.pageX!="undefined"?(t.x=n.pageX,t.y=n.pageY):(i=this.get_scroll_pos(),t.x=n.clientX+i.x,t.y=n.clientY+i.y),t}function t(){return n(window).get_scroll_pos()}this.get_viewport_size=r,this.get_mouse_pos=i,this.get_scroll_pos=t},n.Util=new function(){function t(){return n(arguments,!1)}function i(){return n(arguments,!0)}function n(n,t){function i(){u.apply(this,Array.prototype.slice.call(n,2)),t||(u=null)}var u=n[0],r=n[1];return t===!0?window.setInterval(i,r):window.setTimeout(i,r)}this.set_timeout=t,this.set_interval=i},n.Style=new function(){function f(i){var f=i.scrollTop&&i!==document.documentElement&&i!==document.body&&i.tagName!=="TEXTAREA"&&i.tagName!=="INPUT"?-1:0,r={x:i.scrollLeft*f,y:i.scrollTop*f},u;return n.Browser.is_ie&&t(i,"position")==="static"?(u=i.style.position,i.style.position="relative",r.x+=i.offsetLeft,r.y+=i.offsetTop,i.style.position=u):(r.x+=i.offsetLeft,r.y+=i.offsetTop),r}function l(i){var r={x:0,y:0},u;if(i.getBoundingClientRect){var e=i.getBoundingClientRect(),c=o(),h=n(window).get_scroll_pos();r.x=e.left-c.x+h.x,r.y=e.top-c.y+h.y}else while(i!==null)u=f(i),r.x+=u.x,r.y+=u.y,i=i.offsetParent,i&&!s()&&(r.x+=parseFloat(t(i,"borderLeftWidth"))||0,r.y+=parseFloat(t(i,"borderTopWidth"))||0);return r}function s(){var n,t;return typeof arguments.callee.constantValue=="undefined"&&(n=document.createElement("div"),n.style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n),arguments.callee.constantValue=t.offsetTop===1,document.body.removeChild(n),n=t=null),arguments.callee.constantValue}function o(){var i,r;if(typeof arguments.callee.constantValue=="undefined"){var t=document.body,f=t.style.position,u=t.style.margin,e=t.style.border;t.style.position="static",t.style.margin="0",t.style.border="1px solid transparent",i=t.getBoundingClientRect(),r=n(window).get_scroll_pos(),arguments.callee.constantValue={x:i.left+r.x,y:i.top+r.y},t.style.position=f,t.style.margin=u,t.style.border=e,document.documentElement.className=document.documentElement.className}return arguments.callee.constantValue}function t(n,t){var i="",f,e,u;return n.currentStyle&&(t==="right"||t==="bottom")?i=r(t,"auto","auto",n)+"px":(f=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(n,null)||n.currentStyle,f&&(i=f[t]||"",e=i.match(/px$/),e||(u=i.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/),u&&(i=r(t,i,u[0],n)+"px")))),i}function r(i,r,u,f){var s,a,y,o,l,h,p,w,c,e,v;if(r){if(u==="px")return parseFloat(r);if(r==="auto")switch(i){case"top":case"left":return 0;case"bottom":case"right":s={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},a=n(f);if(a.get_style("position")==="relative")return y=s[i][0],-parseInt(a.get_style(y));o=f.parentNode;while(o!==document&&n(o).get_style("position")==="static")o=o.parentNode;return l=s[i][2],h=o===document?n.Screen.get_viewport_size()[l]:parseInt(n(o).get_style(l)),p=s[i][1],w=s[i][3],h-f[p]-f[w];case"height":return f.clientHeight||f.offsetHeight&&f.offsetHeight-parseFloat(t(f,"borderTopWidth"))-parseFloat(t(f,"borderBottomWidth"))||0;case"width":return f.clientWidth||f.offsetWidth&&f.offsetWidth-parseFloat(t(f,"borderLeftWidth"))-parseFloat(t(f,"borderRightWidth"))||0;default:return 0}else{switch(i){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return i=i.replace("Width","Style"),c=t(f,i),c==="none"?0:parseFloat(c)}f=f||document.body,e=document.createElement("div"),e.style.visbility="hidden",e.style.position="absolute",e.style.lineHeight="0",u==="%"?(f=f.parentNode,i==="height"||i==="top"?e.style.height=r:(i==="width"||i==="left")&&(e.style.width=r)):(e.style.borderStyle="solid",e.style.borderBottomWidth="0",e.style.borderTopWidth=r);try{f.appendChild(e)}catch(b){f=f.parentNode,f.appendChild(e)}return f.offsetWidth,f.offsetHeight,v=e.offsetHeight||e.offsetWidth,f.removeChild(e),v}}else return 0}function v(n,t){var u,r;return t=t||document.body,u=i[n],u||(r=e(n),t.style[r]===undefined&&(r=a(r,t)||n),u=i[n]=r),u}function a(n,t){var r=e("-"+n),i=u.length;while(i--){n=u[i]+r;if(t.style[n]!==undefined)return n}return""}function e(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}var c,h,i,u;this.get_relative_pos=f,this.get_absolute_pos=l,this.offset_includes_borders=s,this.get_bounding_client_rect_offsets=o,c=function(){function t(n,t){n.style.opacity=t}function i(n,t){t*=100;var i;try{i=n.filters.item("DXImageTransform.Microsoft.Alpha"),t<100?(i.Opacity=t,i.enabled||(i.enabled=!0)):i.enabled=!1}catch(r){t<100&&(n.style.filter=(n.currentStyle||n.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")}}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&t||typeof n.style.filter!="undefined"&&i||function(){}}(),this.set_opacity=c,h=function(){function i(n){return parseFloat(n.style.opacity)||t(n,"opacity")}function r(n){var t=n.filters["DXIMageTransform.Microsoft.Alpha"];return t?t.Opacity/100:1}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&i||typeof n.style.filter!="undefined"&&r||function(){}}(),this.get_opacity=h,this.get_rendered_style=t,this.normalize_style=r,i={},u=["O","ms","Moz","Webkit"],this.get_camelized_style_name=v},n.Events=new function(){var i=n.Helper,r=null,t=null;this.capture_mouse=function(i){return n.Events.release_mouse(),r=i,typeof i.setCapture!="undefined"?i.setCapture():(t=function(r){var u=document.createEvent("MouseEvents"),f;u.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),u.__defineGetter__&&(f=n.Screen.get_scroll_pos(),u.__defineGetter__("pageX",function(){return this.clientX+f.x}),u.__defineGetter__("pageY",function(){return this.clientY+f.y})),document.removeEventListener(r.type,t,!0),u.captureTarget=r.target,i.dispatchEvent(u),t!==null&&document.addEventListener(r.type,t,!0),delete u.captureTarget,r.stopPropagation()},document.addEventListener("mouseover",t,!0),document.addEventListener("mouseout",t,!0),document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",t,!0),document.addEventListener("mousedown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("dblclick",t,!0)),this},this.release_mouse=function(){return r!==null&&(typeof r.releaseCapture!="undefined"?r.releaseCapture():(document.removeEventListener("mouseover",t,!0),document.removeEventListener("mouseout",t,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",t,!0),document.removeEventListener("mousedown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("dblclick",t,!0)),r=t=null),this},this.get_capture_target=function(n){return n.captureTarget||n.srcElement||n.target},this.Pseudo=new function(){function t(n,t,i){this.pseudoName=n,this.getNativeName=t,this.getProxiedHandler=i}function h(n,t,i){if(n===t)return!1;var r=0;while(t&&t!=n)r++,t=t.parentNode;return i=i||r,t===n&&i===r}function o(n){var u=i.get_guid(n),t=r[u];return t||(t=r[u]=function(t){var i=t.relatedTarget;if(!i||this===i||h(this,i))return;n.call(this,t)}),t}function c(t){if(!n.Browser.is_gecko)return t;var f=i.get_guid(t),u=r[f];return u||(u=r[f]=function(n){n.wheelDelta=-40*n.detail,t.call(this,n),n.wheelDelta=null}),u}function f(t){if(!n.Browser.is_ie)return t;var e=i.get_guid(t),f=r[e];return f||(f=r[e]=function(n){var f,e,o,r;if(n.pointerType===2){n.type==="MSPointerUp"||n.type==="MSPointerCancel"?delete u[n.pointerId]:(n.preventManipulation&&n.preventManipulation(),u[n.pointerId]={_$targetId:i.get_guid(n.target),identifier:n.pointerId,pageX:n.clientX,pageY:n.clientY}),e=[],o=[];for(f in u)u.hasOwnProperty(f)&&u[f]&&(r=u[f],e.push(r),r._$targetId===i.get_guid(n.target)&&o.push(r));n.touches=e,n.targetTouches=o,t.call(this,n),n.touches=n.targetTouches=null}}),f}function s(){}var r={},u={},e={touchstart:"MSPointerDown",touchend:"MSPointerUp",touchmove:"MSPointerMove",touchcancel:"MSPointerCancel"};return t.prototype.add=function(n,t,i){n.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},t.prototype.remove=function(n,t,i){n.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},{mouseenter:new t("mouseenter",function(){return"mouseover"},function(n){return o(n)}),mouseleave:new t("mouseleave",function(){return"mouseout"},function(n){return o(n)}),mousewheel:new t("mousewheel",function(t){return n.Browser.is_gecko?"DOMMouseScroll":t},function(n){return c(n)}),touchstart:new t("touchstart",function(t){return n.Browser.is_ie?e[t]:t},function(t){return n(document).add_event("touchend",s,!0).add_event("touchcancel",s,!0),f(t)}),touchend:new t("touchend",function(t){return n.Browser.is_ie?e[t]:t},function(n){return f(n)}),touchmove:new t("touchmove",function(t){return n.Browser.is_ie?e[t]:t},function(n){return f(n)}),touchcancel:new t("touchcancel",function(t){return n.Browser.is_ie?e[t]:t},function(n){return f(n)})}}},function(){var f=n.Helper,r,t,e={},u={},i={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1};n.ext.add_event=function(){function s(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].add(this,i,r):this.for_each(function(n){n.addEventListener(t,i,r)}),this}function o(o,s,h,c){function v(i,r){t=t||1,r.eventPhase=t,r.target=r.srcElement,r.currentTarget=i;var u=n.Screen.get_mouse_pos(r);r.pageX=u.x,r.pageY=u.y;switch(r.type){case"keyup":case"keydown":case"keypress":i.type!=="file"&&(r.keyCode===186?r.keyCode=59:r.keyCode===187?r.keyCode=61:r.keyCode===189?r.keyCode=109:null),r.which=r.keyCode,r.charCode=r.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":r.which=[1,1,3,r.button,2][r.button];break;case"mouseover":r.relatedTarget=r.fromElement;break;case"mouseout":r.relatedTarget=r.toElement}return r.preventDefault=function(){r.returnValue=!1},r.stopPropagation=function(){r.cancelBubble=!0},r}function y(n,t,r){var u=i[n],f;return u===!1?!1:(u||(u=i[n]={}),f=u[t],f||(f=u[t]=[]),f.push(r),!0)}function l(n,t){var i=u[n];i||(i=u[n]={}),count=i[t],count||(count=i[t]={handlerCount:0,remainingHandlers:0}),count.handlerCount++,count.remainingHandlers=count.handlerCount}function a(n,u){var a=[],l=n,h,e,s,v,c;while(l)a.push(l),l=l.parentNode;while(h=a.pop()){e=f.get_guid(h);if(i[o][e])for(r||(r=h),v=i[o][e].length,s=0;s<v;s++)u.cancelBubble||(h===u.target&&(u.eventPhase=t=2),c=i[o],c[e]&&c[e][s]&&c[e][s].call(h,u))}return r}return!c&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[o]?n.Events.Pseudo[o].add(this,s,h):this.for_each(function(n){var p=f.get_guid(n),b=f.get_guid(s)+(h||!1).toString(),w="{"+p+" / "+o+" / "+b+"}",c;h&&(h=y(o,p,s)),c=e[w],c||(c=function(f){var e=u[o][p];e.remainingHandlers--,f=v(n,f),i[o]&&t===1&&(r=a(n,f)),t=n===f.target?2:3,f.eventPhase=t,!h&&!f.cancelBubble&&s.call(n,f),(!r||f.cancelBubble||n==r&&e.remainingHandlers===0)&&(t=1,r=undefined,e.remainingHandlers=e.handlerCount),f.eventPhase=f.target=f.currentTarget=f.relatedTarget=f.which=f.preventDefault=f.stopPropagation=f.pageX=f.pageY=undefined},e[w]=c,n.attachEvent("on"+o,c),l(o,p)),w=null,c=null}),this}return document.addEventListener?s:document.attachEvent?o:function(){}}(),n.ext.remove_event=function(){function r(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,r):this.for_each(function(n){n.removeEventListener(t,i,r)}),this}function t(t,r,o,s){function c(t,r,u){var o=i[t],f,e;o&&(f=o[r],f&&(e=n(f).index_of(u),e!==-1&&f.splice(e,1),f.length===0&&delete o[r]))}function h(n,t){var i=u[n]&&u[n][t];i&&(i.handlerCount>0&&i.handlerCount--,i.remainingHandlers=i.handlerCount)}return!s&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,r,o):this.for_each(function(n){var s=f.get_guid(n),l=f.get_guid(r)+(o||!1).toString(),u="{"+s+" / "+t+" / "+l+"}",i;o&&c(t,s,r),i=e[u],i&&(n.detachEvent("on"+t,i),delete e[u],h(t,s)),u=null,i=null}),this}return document.addEventListener?r:document.attachEvent?t:function(){}}()}(),function(){var t=n.Helper;n.ext.add_class=function(i){var r=i.split(/\s+/);return this.for_each(function(i){n(r).for_each(function(n){t.has_class(i,[n])||(i.className===""?i.className=n:i.className+=" "+n)})}),this}}(),n.ext.remove_class=function(n){return this.swap_class(n,"$1")},n.ext.swap_class=function(t,i){i!=="$1"&&(i=" "+i+" ");var r=t.split(/\s+/);return this.for_each(function(t){var u=t.className;n(r).for_each(function(n){var t=new RegExp("(^| )"+n+"( |$)");u=u.replace(t,i)}),t.className=u.replace(/^\s+|\s+$/g,"")}),this},function(){var t=n.Helper;n.ext.has_class=function(n,i){var r=this[i||0];return r&&t.has_class(r,[n])||!1}}(),n.ext.get_html=function(n){var t=this[n||0];return t&&t.innerHTML||""},n.ext.set_html=function(n){return this.for_each(function(t){t.innerHTML=n}),this},n.ext.get_val=function(n){var t=this[n||0];return t&&t.value||""},n.ext.set_val=function(n){return this.for_each(function(t){typeof t.value!="undefined"&&(t.value=n)}),this},function(){var t=n.Helper.get_attr;n.ext.get_attr=function(n,i){var r=this[i||0];return r&&t(r,n)||""}}(),n.ext.set_attr=function(n,t){return this.for_each(function(i){i.setAttribute(n,t)}),this},function(){var r=n.Style.get_rendered_style,i=n.Style.get_opacity,t=n.Style.get_camelized_style_name;n.ext.get_style=function(n,u){var f=this[u||0];return f?n==="opacity"?i(f):r(f,t(n)):""}}(),function(){var i=n.Style.set_opacity,t=n.Style.get_camelized_style_name;n.ext.set_style=function(n){return this.for_each(function(r){var e,u,f;for(e in n){u=n[e],f=t(e);switch(f){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":r.style[f]=typeof u=="number"&&u+"px"||u;break;case"opacity":i(r,u);break;default:r.style[f]=u}}}),this}}(),n.ext.get_native_prop=function(n,t){var i=this[t||0];return i?i[n]:""},n.ext.parent=function(t){var i=this[t||0];return n(i&&i.parentNode)},n.ext.element=function(n){return this[n||0]},n.ext.get_ancestor=function(t,i){var r=this[i||0],u=t;while(u-->0)if(r)r=r.parentNode;else break;return n(r)},n.ext.get_sibling=function(t,i){var f=this[i||0],r=f;if(t!==0){var o=t>0?"nextSibling":"previousSibling",e=Math.abs(t),u=0;while(u<e){r=r[o];if(!r)break;r.nodeType===1&&u++}}return n(r)},n.ext.for_each=function(){function t(n,t){return this.entities().forEach(n,t),this}function n(n,t){for(var r=this.entities(),u=r.length,i=0;i<u;i++)n.call(t,r[i],i,r);return this}return typeof Array.prototype.forEach!="undefined"?t:n}(),n.ext.iterate=function(t){for(var u=this.length,r,i=0;i<u;i++)r=n(this[i]),t.call(r,i);return _callback=null,this},n.ext.filter=function(t){var r=n(),i=this.length;while(i--)t(this[i])&&r.unshift(this[i]);return r},n.ext.map=function(){function i(t,i){return n(this.entities().map(t,i))}function t(t,i){var u=n(),r=this.length;while(r--)u.unshift(t.call(i,this[r]));return u}return typeof Array.prototype.map!="undefined"?i:t}(),function(){var t=n.Helper;n.ext.contains=function(n){return t.contains(this.entities(),n)}}(),function(){var t=n.Helper;n.ext.index_of=function(n){return t.index_of(this.entities(),n)}}(),n.ext.select=function(t){return n(t,this[0])},n.ext.has=function(t,i){var r=this[i||0];return n(t,r).length>0},function(){var t=n.Helper;n.ext.unique=function(){return n(t.unique(this.entities()))}}(),function(){var t=n.Style.get_rendered_style;n.ext.get_style_pos=function(n){var i=this[n||0];return{x:parseFloat(t(i,"left")),y:parseFloat(t(i,"top"))}}}(),function(){var t=n.Style.get_absolute_pos;n.ext.get_absolute_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){var t=n.Style.get_relative_pos;n.ext.get_relative_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){n.ext.get_scroll_pos=function(t){var r=this[t||0],i={x:0,y:0};return r===window?typeof window.pageYOffset!="undefined"?(i.x=window.pageXOffset,i.y=window.pageYOffset):n.Browser.is_in_quirks_mode||typeof document.documentElement.scrollTop=="undefined"?typeof document.body.scrollTop!="undefined"&&(i.x=document.body.scrollLeft,i.y=document.body.scrollTop):(i.x=document.documentElement.scrollLeft,i.y=document.documentElement.scrollTop):(i.x=r.scrollLeft,i.y=r.scrollTop),i}}(),n.ext.animate=function(t,i,r,u,f){function l(n,t,i){switch(n){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;default:return i}}function c(t,i){var u=n(t).get_style(i)+"",r=parseFloat(u);return e.units[i]=u.replace(r,""),r}function a(n,i){var e=c(n,i),r=t[i]+"",u=r.match(/^[+\-*\/]/),f=u&&u[0]||"noOp";return r=Number(r.replace(f,"")),l(f,e,r)}var e={units:{},ops:{}},s={},o,h;for(o in t)e[o]=c,s[o]=a;return h=n.Effects.Storyboard.create(this,e,s,function(t,i){var f=n(t),r,u;for(r in i){if(r==="units")continue;u={},u[r]=i[r]+e.units[r],f.set_style(u)}},i,r,u,f),h.begin(),this},n.ext.bounce=function(t,i,r,u,f){function o(t){return n(t).get_style_pos().y}t===null&&(t=o);var e=n.Effects.Storyboard.create(this,{top:t},{top:i},function(n,t){n.style.top=Math.ceil(t.top)+"px"},r,u,f,n.Effects.Easing.Bounce.ease_out);return e.begin(),this},function(){function t(t,i,r,u,f){this.set_style({zoom:1}),t===null&&(t=function(t,i){return Number(n(t).get_style(i))});var o=n.Effects.Storyboard.create(this,{opacity:t},{opacity:i},function(t,i){n(t).set_style({opacity:i.opacity})},r,u,f,null);return o.begin(),this}n.ext.fade_to=t,n.ext.fade_in=function(n,i,r,u){return t.call(this,0,1,n,i,r,u)},n.ext.fade_out=function(n,i,r,u){return t.call(this,1,0,n,i,r,u)}}(),n.ext.slide=function(t,i,r,u,f,e){function s(t,i){i=i==="left"?"x":"y";var r=t.__pos;return r||(r=t.__pos=n(t).get_style_pos()),i==="y"&&(t.__pos=n.undefined),r[i]}t===null&&(t={x:s,y:s});var o=Math.round,c=n.Effects.Easing.Exponential.ease_in_out,h=n.Effects.Storyboard.create(this,{left:t.x,top:t.y},{left:i.x,top:i.y},function(n,t){n.style.top=o(t.top)+"px",n.style.left=o(t.left)+"px"},r,u,f,e||function(n){return c(n,4)});return h.begin(),this},n.ext.scroll_to=function(t,i,r,u){scrollPos=n.Screen.get_scroll_pos(),elemPos=n(this[0]).get_absolute_pos();var f=Math.round,o=n.Effects.Easing.Exponential.ease_out,e=n.Effects.Storyboard.create([window],{scrollX:scrollPos.x,scrollY:scrollPos.y},{scrollX:elemPos.x,scrollY:elemPos.y},function(n,t){n.scrollTo(f(t.scrollX),f(t.scrollY))},t,i,r,u||function(n){return o(n,4)});return e.begin(),this},n.ext.veil=function(t,i,r,u,f){function l(t,i){var r=parseInt(n(t).get_style(i),10);return t[c]=t[c]||{},t[c][i]=r}var e=n.Effects.Enums.Directions,c,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,c="_$gimme$_veil",s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=l,s.height=s.paddingTop=s.paddingBottom=0),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=l,s.width=s.paddingLeft=s.paddingRight=0),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i!=="none"}),o,s,function(n,i){var r=n.style;(t&e.vertically)===e.vertically&&(r.height=i.height+"px",r.paddingTop=i.paddingTop+"px",r.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(r.width=i.width+"px",r.paddingRight=i.paddingRight+"px",r.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.display="none"}})),h.begin(),this},n.ext.unveil=function(t,i,r,u,f){function c(t,i){var r=t._$gimme$_veil;return r||(r=r||function(){var i=t.cloneNode(!0),f,u,r;return i.style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",i.style.display="block",t.parentNode.appendChild(i),i=n(i),f=parseInt(n(t).get_style("height"),10)||parseInt(i.get_style("height"),10),u=parseInt(n(t).get_style("width"),10)||parseInt(i.get_style("width"),10),i[0].style.padding=t.style.padding,r={height:f,width:u,paddingTop:parseInt(i.get_style("paddingTop"),10),paddingBottom:parseInt(i.get_style("paddingBottom"),10),paddingRight:parseInt(i.get_style("paddingRight"),10),paddingLeft:parseInt(i.get_style("paddingLeft"),10)},t.parentNode.removeChild(i[0]),t.style.overflow="hidden",r}()),r[i]}var e=n.Effects.Enums.Directions,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,e=n.Effects.Enums.Directions,t=Math.floor(t)||e[t]||e.vertically,s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=0,s.height=s.paddingTop=s.paddingBottom=c),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=0,s.width=s.paddingLeft=s.paddingRight=c),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i==="none"||i===null}),o,s,function(n,i){(t&e.vertically)===e.vertically&&(n.style.height=i.height+"px",n.style.paddingTop=i.paddingTop+"px",n.style.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(n.style.width=i.width+"px",n.style.paddingRight=i.paddingRight+"px",n.style.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden",n.style.display="block"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.overflow=""}})),h.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Monday, February 06, 2012 2:45:57 PM"},n}(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},function(){window.Microsoft.Maps.Globals={disableVenueMaps:!1,zoomOriginWidth:256,minMercatorZoom:1,maxMercatorZoom:20,jsonTimeStamp:new Date(1).valueOf()}}(),window.Microsoft.Maps.initMapCode=function(){function i(n,t){this.x=n,this.y=t}function a(n,t,i,r){this.latitude=parseFloat(n),this.longitude=parseFloat(t),pt.isValid(r)&&(this.altitude=parseFloat(i),this.altitudeReference=r)}function it(n,t,i){this.center=n,this.width=t,this.height=i}function dr(t){function i(){var i=e.getWidth(),t=e.getHeight();(i!==f||t!==o)&&(f=i,o=t,n.invoke(e,"resize",{width:i,height:t}))}var e=this,l=t.onresize!==c,r,f,o,h=k(t),s=k(window);this.getWidth=function(){return t.offsetWidth},this.getHeight=function(){return t.offsetHeight},this.startMonitoring=function(){l?(h.add_event("resize",i),u.useOnResize&&(t.onresize=i)):(r||(r=window.setInterval(i,1e3)),s.add_event("resize",i))},this.stopMonitoring=function(){h.remove_event("resize",i),u.useOnResize&&t.onresize===i&&(t.onresize=null),r&&(window.clearInterval(r),_timeoutId=null),s.remove_event("resize",i)},this.poll=function(){f=null,o=null,i()}}function gi(r,f){function rr(){function h(){var n=e.getImageryId();switch(n){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":a.add_class("dark");break;default:a.remove_class("dark")}}var i,c,r,o;f=f||{},s=b(),s.className="MicrosoftMap",u.allowFocus&&(v=b("button","position:fixed;width:1px;height:1px;left:0;top:0;padding:0;font-size:0;line-height:0;border:0;background:transparent;",s),u.useXHR&&k(v).set_style({display:"none"})),ut=tr(),gt=tr(),wt.appendChild(s),rt=k(document),yt=k(ut),a=k(s),f.showHotRegions===!0&&(t.onDemandRoadUriFormat&&(t.roadUriFormat=t.onDemandRoadUriFormat),t.onDemandAerialWithLabelsUriFormat&&(t.aerialWithLabelsUriFormat=t.onDemandAerialWithLabelsUriFormat)),n.invoke(gi,"mapcreationstart",{map:e,options:f}),di=f.credentials,w.authenticate(f.credentials),typeof ft!="undefined"&&ft.authenticate(e.getCredentials),g=new dr(s),n.addHandler(g,"resize",or),ni(f.width,f.height),t.ddCoreStyles&&t.ddCoreStyles!==""&&ii.downloadStyles(t.ddCoreStyles),i=kr(f),i.mapTypeId=i.mapTypeId||lt.auto||lt.road,i.animate=!1,e.setView(i),fi&&e.focus(),a.add_event("mousedown",e.focus).add_event("touchstart",e.focus),y.dispatch(function(){var n={showDashboard:f.showDashboard,showMapTypeSelector:f.showMapTypeSelector,showDualMapTypeSelector:f.showDualMapTypeSelector,disableBirdseye:f.disableBirdseye,showBreadcrumb:f.showBreadcrumb,showScalebar:f.showScalebar,showLogo:f.showLogo,clickable:f.enableClickableLogo,enableSearch:f.enableSearchLogo,showCopyright:f.showCopyright};w.showOverlays(n)}),f.showHotRegions===!0&&(y.dispatch(function(){w.showHotRegions(f.disableLabels)}),f.showVenueMapsExplorer===!0&&y.dispatch(function(){w.showVenueMapsExplorer()})),t.disableAnalytics||f.disableAnalytics||e.addComponent("analyticsProxy",new su(e)),f.fixedMapPosition===!0&&(bi=!1),c=n.addHandler(e,"imagerychanged",h),h(),u.useXHR&&t.message&&(r=b("div","position:absolute; width:100%; top:50%; text-Align:center"),o=b("div","background: #f8f7f5; padding:10px; color: #000;"),o.innerHTML=t.message,r.appendChild(o),e.getRootElement().appendChild(r)),t.clientVersion&&t.serverversion&&t.clientVersion!==t.serverversion}function fr(t){var i=p.length;while(i--)p[i][1]=n.addHandler(t,p[i][0],function(){var t=p[i][0];return function(i){n.invoke(e,t,i)}}());k(s).add_event("mouseenter",function(t){n.invoke(e,"mouseover",new hi(e,ti.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),k(s).add_event("mouseleave",function(t){n.invoke(e,"mouseout",new hi(e,ti.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function nr(){var i,t=p.length;while(t--)i=p[t][1],i&&n.removeHandler(i),p[t][1]=null;k(s).remove_event("mouseenter",function(t){n.invoke(e,"mouseover",new hi(e,ti.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),k(s).remove_event("mouseleave",function(t){n.invoke(e,"mouseout",new hi(e,ti.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function tr(){return b("div","z-index:0;position:absolute;left:50%;top:50%;"+u.safariRenderHack,s)}function ni(n,t){n>0&&t>0?(g.stopMonitoring(),kt=!1,s.style.cssText=ir.replace("{width}",n).replace("{height}",t),ri(n,t)):(s.style.cssText=ur,kt=!0,g.startMonitoring(),g.poll())}function ri(t,i){t=Math.round(Math.max(1,t)),i=Math.round(Math.max(1,i)),(t!==bt||i!==pt)&&(bt=t,pt=i,n.invoke(e,"resize"))}function or(n){kt&&ri(n.width,n.height)}function d(){var t,n;dt&&(t=a.get_absolute_pos(),st=t.x,ot=t.y,n=yt.get_absolute_pos(),tt=n.x,it=n.y,dt=!1,bi&&y.dispatch(ei))}function ei(){dt=!0}function li(n){for(var t in l)if(l.hasOwnProperty(t)&&l[t].getMode()===n)return l[t];return null}function er(t){if(o!=t){var i=o,f=li(i),u=li(t),r="MapTypeId_";t.activating&&t.activating(e,{credentials:di}),i&&i.deactivating&&i.deactivating(),nr(),o=t,f&&a.remove_class(r+f.getMapTypeId()),i&&i.deactivated&&i.deactivated(),u&&a.add_class(r+u.getMapTypeId()),fr(t),t.activated&&t.activated(),n.invoke(e,"modechanged"),n.invoke(e,"imagerychanged"),n.invoke(e,"copyrightchanged")}}function vt(n){var i,t;if(ci!==e)return!1;i=n.target;if(i){t=i.tagName;if(t==="INPUT"&&i.type==="text"||t==="TEXTAREA"||t==="SELECT")return!1}return!0}function at(t,i){if(n.hasHandler(e,t)){var r=new br(t,i.keyCode,i.altKey,i.ctrlKey,i.shiftKey);r.originalEvent=i,n.invoke(e,t,r)}}function si(n){vt(n)&&at("keydown",n)}function oi(n){vt(n)&&at("keyup",n)}function yi(n){vt(n)&&at("keypress",n)}var p;PRF.start("mapobj");var e=this,w=new gr(this),wt=r,s,kt=!0,fi=window.top==window.self,bt,pt,st,ot,tt,it,g,ct="z-index:0;overflow:hidden;background-color:";ct+=f&&f.backgroundColor?et.clone(f.backgroundColor).toHex()+";":"#F4F2EE;";var ur=ct+(k.Browser.is_in_quirks_mode?"position:absolute;top:0;left:0;width:100%;height:100%":"position:absolute;left:0;top:0;right:0;bottom:0"),ir=ct+"position:relative;width:{width}px;height:{height}px",bi=!0,dt=!0,ut,gt,v,rt,yt,a,o=null,di,l=[],ht=null,h={width:null,height:null,disableUserInput:!1,disableKeyboardInput:!1,disableMouseInput:!1,disableTouchInput:!1,disableZooming:!1,disablePanning:!1,labelOverlay:nt.visible,useInertia:!0,inertiaIntensity:-1,tileBuffer:0,showBackground:null},pi=new ai,wi={};this.addComponent=function(t,i){wi[t]=i,n.invoke(e,"componentadded",{componentName:t,component:i})},this.getComponent=function(n){return wi[n]},this.getCredentials=function(n){w?w.getCredentials(n):typeof n=="function"&&n(null)},this.getWidth=function(){return bt},this.getHeight=function(){return pt},this.getPageX=function(){return d(),st},this.getPageY=function(){return d(),ot},this.getViewportX=function(){return d(),tt},this.getViewportY=function(){return d(),it},this.focus=function(){h.disableUserInput||h.disableKeyboardInput||(v&&(v.offsetWidth>0||v.offsetHeight>0)&&fi?v.focus():window.focus(),ci!==e&&(ci&&ci.blur(),v&&rt.add_event("keydown",si).add_event("keypress",yi).add_event("keyup",oi),ci=e,n.invoke(e,"focus")))},this.blur=function(){v&&(v.blur(),rt.remove_event("keydown",si).remove_event("keypress",yi).remove_event("keyup",oi)),ci===e&&(n.invoke(e,"blur"),ci=null)},this.getRootElement=function(){return s},this.getModeLayer=function(){return ut},this.getUserLayer=function(){return gt},this.updateMapPosition=ei,this.dispose=function(){if(e){n.invoke(e,"ondispose",null),w.dispose(),e.blur(),e.entities.clear(),o&&o.deactivating&&o.deactivating(),nr(),o&&o.deactivated&&o.deactivated(),o=null,l.length=0,g.stopMonitoring(),g=null,a.remove_event("mousedown",e.focus).remove_event("touchstart",e.focus),wt.removeChild(s),s=null,wt=null,ut=null,gt=null,rt=null,yt=null,a=null,w=null;var t=vi.length;while(t--)vi[t]===e&&vi.splice(t,1);e=null}},this.setView=function(t){var i,u,r;e.setOptions(t),t.mapTypeId&&(i=l[t.mapTypeId],i!==ht&&(this.entities=pi,u=o,r=null,u&&(r=u.getCenter()),i.activating(),ht=i,er(i.getMode()),i.activated(),n.invoke(e,"maptypechanged"),t.center||t.bounds||!r||u===o||(t.center=r,t.animate==null&&(t.animate=!1)))),o.setView(t)},this.setOptions=function(t){var i,r=!1;for(i in t)h[i]!==c&&t[i]!==c&&h[i]!==t[i]&&(h[i]=t[i],r=!0);r&&(h.width!==c&&h.height!==c&&ni(h.width,h.height),n.invoke(e,"optionschanged"))},this.getOptions=function(){return kr(h)},this.getCenter=function(){return o.getCenter()},this.getZoom=function(){return o.getZoom()},this.getZoomRange=function(){return{min:t.minMercatorZoom,max:t.maxMercatorZoom}},this.getHeading=function(){return o.getHeading()},this.getBounds=function(){return o.getBounds()},this.getMetersPerPixel=function(){return o.getMetersPerPixel()},this.getTargetCenter=function(){return o.getTargetCenter()},this.getTargetZoom=function(){return o.getTargetZoom()},this.getTargetHeading=function(){return o.getTargetHeading()},this.getTargetBounds=function(){return o.getTargetBounds()},this.getTargetMetersPerPixel=function(){return o.getTargetMetersPerPixel()},this.tryLocationToPixel=function(n,t){var i,u,r,f,e;if(!o.tryLocationToViewport)return null;i=o.tryLocationToViewport(n);if(i&&t){u=0,r=0;switch(t){case ui.page:d(),u=tt,r=it;break;case ui.control:d(),u=tt-st,r=it-ot}if(u||r)if(ki(i)){e=i.length;while(e--)f=i[e],f&&(f.x+=u,f.y+=r)}else i.x+=u,i.y+=r}return i},this.tryPixelToLocation=function(n,t){var e,u,r,f;if(!o.tryViewportToLocation)return null;e=n;if(t){u=0,r=0;switch(t){case ui.page:d(),u=tt,r=it;break;case ui.control:d(),u=tt-st,r=it-ot}if(u||r)if(ki(n)){f=n.length,e=new Array(f);while(f--)e[f]=new i(n[f].x-u,n[f].y-r)}else e=new i(n.x-u,n.y-r)}return o.tryViewportToLocation(e)},this.isDownloadingTiles=function(){return o&&o.isDownloadingTiles?o.isDownloadingTiles():!1},this.getImageryId=function(){return o&&o.getImageryId?o.getImageryId():""},this.isMercator=function(){return o.isMercator?o.isMercator():!1},this.isRotationEnabled=function(){return o.isRotationEnabled()},this.getCopyrights=function(n){return o&&o.getCopyrights&&o.getCopyrights(n),[]},this.getMode=function(){return o.getPublicApi?o.getPublicApi():{}},this.setMapType=function(n){this.setView({mapTypeId:n})},this.getMapTypeId=function(){return ht?ht.getMapTypeId():""},this.registerMapType=function(n){var t=n.getMapTypeId();if(l[t])throw"InvalidOperation: already registered";l.push(n),l[t]=n},this.entities=pi,p=[["viewchangestart",null],["viewchange",null],["viewchangeend",null],["targetviewchanged",null],["imagerychanged",null],["copyrightchanged",null],["tiledownloadcomplete",null],["click",null],["dblclick",null],["rightclick",null],["mousedown",null],["mouseup",null],["mousemove",null],["mousewheel",null]],rr(),vi.push(e),PRF.end("MapObject instantiated","mapobj")}function oi(n,t){var r=n,i=t;this.getMapTypeId=function(){return r},this.getMode=function(){return i},this.activating=function(){},this.activated=function(){}}function hi(n,t,i,r,u,f,e,o,s){var h=n;this.pageX=u,this.pageY=f,this.eventName=r,this.targetType=t,this.target=i,this.wheelDelta=e,this.isTouchEvent=o,this.originalEvent=s,this.isPrimary=s.which===1,this.isSecondary=s.which===3,this.getX=function(){return this.pageX-h.getViewportX()},this.getY=function(){return this.pageY-h.getViewportY()}}function br(n,t,i,r,u){this.eventName=n,this.keyCode=t,this.altKey=i,this.ctrlKey=r,this.shiftKey=u,this.originalEvent={}}function et(n,t,i,r){this.a=n,this.r=t,this.g=i,this.b=r}function ai(t){function s(t){t.collection||(t.collection=r),n.invoke(r,"entitychanged",t)}function h(t){n.invoke(r,"entityadded",t)}function c(t){n.invoke(r,"entityremoved",t)}function e(t,i){var f=u.length;while(f--)t[u[f][0]]||(t[u[f][0]]=n.addHandler(t,u[f][1],u[f][2]));n.invoke(r,"entityadded",{collection:r,entity:t,index:i})}function o(t){if(t){var i=u.length;while(i--)n.removeHandler(t[u[i][0]]),t[u[i][0]]=null;n.invoke(r,"entityremoved",{collection:r,entity:t})}}var r=this,f="_ech"+yi.getNext(),u=[[f+"a","entityadded",h],[f+"r","entityremoved",c],[f+"c","entitychanged",s]],i=[];this.get=function(n){return i[n]},this.getLength=function(){return i.length},this.push=function(n){i.push(n),e(n,i.length)},this.insert=function(n,t){i.splice(t,0,n),e(n,t)},this.pop=function(){var n=i.pop();return o(n),n},this.removeAt=function(n){var t=i[n];return i.splice(n,1),o(t),t},this.remove=function(n){var r=null,t=i.length;while(t--)if(i[t]===n){r=this.removeAt(t);break}return r},this.clear=function(){while(i.length>0)this.pop()},this.indexOf=function(n){var t=i.length;while(t--)if(i[t]===n){foundEntity=!0;break}return t},this.setOptions(t)}function pr(n,t){this._location=n,this.setOptions(t,!1)}function d(n,t){d.baseConstructor.call(this,n,t),this.setOptions(t)}function nr(n,i){this._location=n,i&&typeof i.useTransform3d=="boolean"&&(this._useTransform3d=i.useTransform3d),this._icon=t.pushpinImageUrl,this.setOptions(i)}function wi(n,t){this._locations=n,this.setOptions(t)}function tr(n,t){this._locations=n,this.setOptions(t)}function ur(t){var c=this,s=!0,o=0,f=1,h={},u=or.auto,r=!0,e,i;this.setOptions=function(t){if(t){var i=!1;typeof t.visible=="boolean"&&(s=t.visible,i=!0),typeof t.reproject=="boolean"&&(r=t.reproject,i=!0),ei(t.zIndex)&&(o=t.zIndex,i=!0),ei(t.opacity)&&(f=t.opacity,i=!0),t.animationDisplay&&(u=t.animationDisplay,i=!0),i&&n.invoke(c,"entitychanged",{entity:c})}},e=typeof rt!="undefined"?rt:{mercator:{}};for(i in e)t[i]instanceof sr&&(h[i]=t[i]);this.getVisible=function(){return s},this.getZIndex=function(){return o},this.getOpacity=function(){return f},this.getAnimation=function(){return u},this.getReproject=function(){return r},this.getTileSource=function(n){return h[n]},this.setOptions(t)}function sr(n){var f=t.defaultTileSize,u=t.defaultTileSize,i,r;isFinite(n.width)&&(f=n.width),isFinite(n.height)&&(u=n.height),typeof n.uriConstructor=="string"?(i=n.uriConstructor,r=n.uriConstructor):(typeof n.uriConstructor=="function"&&(i=n.uriConstructor),typeof n.uriFormat=="string"&&(r=n.uriFormat)),this.getWidth=function(){return f},this.getHeight=function(){return u},this.getUriConstructor=function(){return i},this.getUriFormat=function(){return r}}function gr(n){this._map=n,this.dispose=function(){this._map=null}}function su(t){function c(){u=n.addHandler(f,"ondispose",e),st.load(s,{callback:function(){h.Analytics&&h.Analytics.AnalyticsManager&&(o=!0,r=new h.Analytics.AnalyticsManager(f))}})}function i(n,t){r?r[n].apply(r,t):o||st.add(s,l,n,t)}function e(){i("dispose",arguments),r=f=null,n.removeHandler(u),u=null}var l=this,s="Microsoft.Maps.Analytics",f=t,u=null,r=null,o=!1;this.logClientAction=function(){i("logClientAction",arguments)},this.addPreProcessor=function(){i("addPreProcessor",arguments)},this.removePreProcessor=function(){i("removePreProcessor",arguments)},this.registerAction=function(){i("registerAction",arguments)},this.registerChildActions=function(){i("registerChildActions",arguments)},this.enable=function(){i("enable",arguments)},this.dispose=e,c()}function r(n,t,i){this.x=n,this.y=t,this.z=i}function ot(n,t){this.width=n,this.height=t}function ht(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}function ct(n,t,i,r,u,f){this.m11=n,this.m12=t,this.m21=i,this.m22=r,this.offsetX=u,this.offsetY=f}function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.m11=n,this.m12=t,this.m13=i,this.m14=r,this.m21=u,this.m22=f,this.m23=e,this.m24=o,this.m31=s,this.m32=h,this.m33=c,this.m34=l,this.offsetX=a,this.offsetY=v,this.offsetZ=y,this.m44=p}function kt(n,t,i,r){this.a=n,this.b=t,this.c=i,this.d=r}function wt(n,t){this.x=n,this.y=t}function g(n,t,i){this.levelOfDetail=n,this.x=t,this.y=i}function f(n,u,o,h,l,a,v,y,p,w){function k(){var l,o,w,v;if(!ni){ut=h===0&&et===-90&&a===0,ft=ut||st<=vt,lt=ft&&ut?f.simpleGround:kt.fromNormal(nt,rt.getUpVector(nt));var n=f.simpleWorldToFrustumNoZ,u=1/g,i=g*1e3;tt=rt.getNadirMatrix(nt),ut||(tt=e.multiply(tt,e.rotationZ(-yt),e.rotationX(-(et+90)),e.rotationZ(-ct)));if(ft)ut?(n.m22=n.m11=u,n.m33=u*-.001,n.offsetX=tt.offsetX*u,n.offsetY=tt.offsetY*u):n=e.multiply(tt,e.scaling(u,u,1/i));else{var y=Math.pow(2,dt)*g,c=1/st,p=c/y;i=Math.min(c*.99,i),l=c-i,o=c+i,n=e.multiply(tt,e.translation(bt),e.translation(0,0,c),new e(p,0,0,0,0,p,0,0,0,0,o/(o-l),1,0,0,l*o/(l-o),0),e.scaling(y/g,y/g,1)),w=n.transform(nt),n.multiplyBy(e.translation(r.multiply(w,-1)))}ut?ot=n.clone():(ht=n.invert().projectOnPlane(lt),ot=ht.invert()),ut?(d=ot.clone(),d.m11*=b,d.m22*=b,d.m33*=b,d.offsetX*=b,d.offsetY*=b,v=g/b,it=tt.clone(),it.m11*=v,it.m22*=v,it.m33*=i/b,it.offsetX*=-1,it.offsetY*=-1):(d=e.multiply(ot,e.scaling(b)),it=d.invert()),gt=rt.toLocation(nt),wt=f.widthToMercatorZoom(g,rt,nt),at=rt.unitsToMeters(nt,g)/t.zoomOriginWidth,pt=!ft||Math.abs(et+90)>vt||rt!==s,ni=!0}}var ti=this;var rt=n,nt=u,g=o,yt=h||0,et=l===c?-90:l,ct=a||0,st=v||0,dt=y||0,bt=p||new r(0,0,0),ut,ft,lt,tt,ot,ht,d,it,gt,wt,at,pt,b=w||t.zoomOriginWidth,ni=!1;this.getCrs=function(){return rt},this.getLookAt=function(){return nt},this.getWidth=function(){return g},this.getHeading=function(){return yt},this.getPitch=function(){return et},this.getRoll=function(){return ct},this.getDistanceInverse=function(){return st},this.getZoomDelta=function(){return dt},this.getPerspectiveOrigin=function(){return bt},this.getZoomOriginWidth=function(){return b},this.getGroundPlane=function(){return k(),this.getGroundPlane=function(){return lt},lt},this.getWorldToViewport=function(){return k(),this.getWorldToViewport=function(){return d},d},this.getViewportToWorld=function(){return k(),this.getViewportToWorld=function(){return it},it},this.getWorldToFrustum=function(){return k(),this.getWorldToFrustum=function(){return ot},ot},this.getFrustumToWorld=function(){return k(),this.getFrustumToWorld=function(){return ht},ht},this.getCenter=function(){return k(),this.getCenter=function(){return gt},gt},this.getMercatorZoom=function(){return k(),this.getMercatorZoom=function(){return wt},wt},this.getMetersPerPixel=function(){return k(),this.getMetersPerPixel=function(){return at},at},this.getNeedsElevation=function(){return k(),this.getNeedsElevation=function(){return pt},pt},this.getAlignedCamera=function(n,t,r,u){var s,h;k();var v=g/Math.pow(2,n),o,l=null,c=0,a=null;return t?(o=t,ft||(a=e.multiply(tt,e.translation(bt)),l=a.transform(o),c=n+dt)):o=nt,s=yt,u&&(s=s+u),c=0,h=new f(rt,o,v,s,et,ct,st,c,l,b),r&&(o=h.getViewportToWorld().transform(new i(-r.x,-r.y)),ft||(l=a.transform(o)),h=new f(rt,o,v,s,et,ct,st,c,l,b)),h}}function li(n){var u=this,e=n,f=2,i=bt+"count",t=[{}],r;t[0][i]=0,this.get=function(n,i){var r,e=t.length,f=!0;while(e--){r=t[e][n];if(r!==c)return i&&!f&&u.insert(n,r),r;f=!1}},this.insert=function(n,o){var v,s,l,h,a;v=!1,s=t[t.length-1];if(s[n]===c)if(s[i]<e)s[i]++;else{s={},s[i]=0,t.push(s);if(t.length>f){l=t.shift();if(r)for(h in l)h!==i&&l.hasOwnProperty(h)&&(a=l[h],a!==u.get(h)&&r(a))}}else v=!0;return s[n]=o,v},this.useDisposer=function(n){r=n}}function at(n,t,i,r,u){this.nativeCamera=n,this.maxLocalZoom=i,this.minLocalZoom=0,this.tilePyramid=t,this.imageryId=r,this.copyrightProvider=u,this.needsElevation=n.getNeedsElevation()||t&&t.projectingCamera&&t.projectingCamera.getNeedsElevation()}function yt(){function hr(){n.invoke(v,"copyrightchanged")}function ci(n,i){var s;if(i&&f.areEqual(e,n))return;ni&&(n=ft.adjustCameraElevation(n)),e=n,et=n,s=!1,di<1/t.maxFPS&&(i=!1);if(i){et=f.snapSmallDifferences(ft.adjustCameraElevation(h),e),f.areEqual(et,e)&&(i=!1);if(i){var r=new ot(l.width*1.2,l.height*1.2),o=ht.union(p.getMercatorFootprint(et,r)),u=ht.union(p.getMercatorFootprint(e,r));ht.intersect(o,u)||(i=!1)}}i?(ct=new Date(new Date-ou),rt(),i!=!0&&(bt=i)):(ct=new Date(0),ri())}function wi(t,i,u,s,h,c,l){var y,k,it=f.widthToMercatorZoom(s,t,i),b,g=i,et=2,a,d,ut,p,nt,tt;ni=!1;while(et--){k=t.toLocation(g),a=null,d=lt.length;while(d--){a=lt[d].getScene(w,k.latitude,k.longitude,it,h,ur),a&&a.needsElevation&&(ut=ft.isElevationAvailableAtLatLon(k.latitude,k.longitude,it),ni=!0,ut||(a=null));if(a)break}a=a||yr,a=fi?w:a;if(b&&y===a)break;y=a,p=o.log2(y.nativeCamera.getWidth()/s),pr&&(p=l?Math.floor(p):Math.round(p)),p=Math.min(p,y.maxLocalZoom),p=Math.max(p,y.minLocalZoom),b=y.nativeCamera.getAlignedCamera(p,i,u);if(r.areAlmostEqual(g,b.getLookAt()))break;g=b.getLookAt()}ai(ni);if(c&&f.areEqual(e,b)&&y===w)return;nt=y.imageryId!==w.imageryId,tt=y!==w,w=y,ci(b,c),rt(),tt&&(n.invoke(v,"scenechanged"),hr()),nt&&n.invoke(v,"imagerychanged")}function wt(){var n=ft.adjustCameraElevation(e);wi(n.getCrs(),n.getLookAt(),null,n.getWidth(),kt!=null?kt:n.getHeading(),!0)}function ri(){var g,u,t,b;y.cancelDispatch(ri);if(!tr||ui)return;ui=!0;var o=!1,p=!0,s=!0,i,a;st.processPendingUserInput(),ot.areEqual(br,l)||(i=!0,a=!0),br=l,gi&&(i=!0,a=!0,s=!1,gi=!1),ct&&(g=h,u=hu(),e.getMercatorZoom()>et.getMercatorZoom()?u<fu&&(p=!1):u<eu&&(p=!1),u>1?(t=e.getLookAt(),gt&&(t=e.getCrs().wrap(t)),t.y<0?t.y=0:t.y>1&&(t.y=1),r.areAlmostEqual(e.getLookAt(),t)||(s=!1,e=e.getAlignedCamera(0,t)),h=e,v.cameraUpdated(),et=e,ct=null):(h=su(u),v.cameraUpdated(),o=!0),f.areAligned(g,h)||(s=!1),i=!0),d.allowTileGridSwitch=p;var nt=!ir&&i,c=ir&&!i,k=new Date;c&&k-gr<=nu&&(c=!1,o=!0),ir=i||o,i&&(gr=k,o=!0),f.areEqual(wr,e)||(a=!0),wr=e,d.render(l,h,w.tilePyramid,e),b=nt?0:c?2:1,hi.update(l,h,s,b),a&&n.invoke(v,"targetviewchanged"),nt&&n.invoke(v,"viewchangestart"),i&&n.invoke(v,"viewchange",{linear:s}),c&&(n.invoke(v,"viewchangeend"),hr()),ui=!1,o&&rt()}function hu(){var n=0,t=new Date;return n=bt>0?Math.min(1,(t-ct)/bt):(t-ct)/1e3/di}function su(n){var i=h,t=0;return bt>0?(n<1||(bt=0),t=1-Math.pow(1-n,4)):t=n<=.5?Math.pow(n*2,2)*.5:Math.pow((1-n)*2,2)*-.5+1,t<0||t>1||(i=f.lerp(et,e,t)),i}function ar(){if(g){var t=g.getWidth(),n=g.getHeight();(l.width!==t||l.height!==n)&&(l=new ot(g.getWidth(),g.getHeight()),rt())}}function rt(){y.dispatch(ri)}function er(n){n&&d.suspendGettingNewTiles(),fi=!0}function fr(){d.allowGettingNewTiles(),fi&&(fi=!1,wt(),rt())}function sr(n){var u=n.getViewportToWorld(),r=n.getCrs(),t=it.fromLocations(r.toLocation(u.transform(new i(-l.width/2,-l.height/2))),r.toLocation(u.transform(new i(l.width/2,-l.height/2))),r.toLocation(u.transform(new i(l.width/2,l.height/2))),r.toLocation(u.transform(new i(-l.width/2,l.height/2))));return t.center=new a(t.center.latitude,t.center.longitude),t}function uu(n){return f.areEqual(n.nativeCamera,at.nativeMercatorCamera)}function or(){var t,n;tt=g.getOptions(),st.enableOrDisableUserInput(!0,tt),t=.9,tt.inertiaIntensity!==c&&tt.inertiaIntensity!==-1&&(t=tt.inertiaIntensity),st.enableOrDisableInertialScrolling(tt.useInertia,t),n=tt.labelOverlay,n!==ur&&nt.isValid(n)&&(ur=n,wt()),tt.showBackground!==c&&d.showBackground(tt.showBackground),d.setBufferSize(tt.tileBuffer)}function ai(t){t?yt||(yt=n.addThrottledHandler(v,"targetviewchanged",dr,500),y.dispatch(dr)):(iu(),n.removeHandler(yt),yt=null)}function dr(){yt&&(iu(),ti=ft.downloadElevationData(e,l),ti&&(rr=n.addHandler(ti,"downloaded",ru)))}function iu(){n.removeHandler(rr),rr=null,ft.cancelDownload(ti)}function ru(n){gi=!n.cacheHit,wt(),rt()}var v=this,tr=!1,cu="cm"+yi.getNext(),g=null,dt=null,vi=null,si=null,st=null,yr=at.createMercatorScene(null,"Mercator",null),w=yr,h=w.nativeCamera,e=h,et,kt,fi,lu=b(null,u.safariRenderHack),lt=[],oi=[],ur=nt.visible,ct,bt=0,l=new ot(800,600),br,d=new cr,ui;n.addHandler(d,"tiledownloadcomplete",function(){n.invoke(v,"tiledownloadcomplete")});var kr,hi=new pi,ir=!1,wr,gi=!1,nr,tt,gt=!0,pr=!0,yt,ti,rr,ni,ii,tu={Grab:"url("+t.cursorPath+"grab.cur)"+u.cursorHotspot+", move",Grabbing:"url("+t.cursorPath+"grabbing.cur)"+u.cursorHotspot+", move",SEResize:"se-resize"},ou=1e3/30,di=.3,eu=.1,fu=.4,gr=new Date(0),nu=200,pt,ut,bi,li;this.activating=function(t){g=t,nr=n.addHandler(t,"resize",ar),ar()},this.activated=function(){dt=g.getModeLayer(),vi=g.getRootElement(),si=k(vi),dt.appendChild(d.getRootElement()),kr=b("div","position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack,dt),hi.activate(g,v,d,kr,cu+"_er"),st=new vr(v,g,new lr(v,g),si,hi,!0),or(),n.removeHandler(ii),ii=n.addHandler(g,"optionschanged",or),ai(w.needsElevation),si.set_style({cursor:tu.Grab}),tr=!0,rt()},this.deactivating=function(){n.removeHandler(ii),ii=null,ai(!1),n.removeHandler(nr),nr=null,st.enableOrDisableUserInput(!1,tt),ci(e,!1),hi.deactivate(),dt.removeChild(d.getRootElement()),d.disposeTiles(),st=null,si=null,vi=null,dt=null,g=null,tr=!1},this.getInternalMaxZoom=function(){return t.maxMercatorZoom},this.getInternalMinZoom=function(){return t.minMercatorZoom},this.setView=function(n){var y=e.getCrs(),v,t,nt=null,i=n.bounds,g=!1,k;if(i instanceof it){if(n.center){t=n.center;var h=i.getNorthwest(),ut=new a(t.latitude*2-h.latitude,t.longitude*2-h.longitude,h.altitude,h.altitudeReference),r=i.getSoutheast(),rt=new a(t.latitude*2-r.latitude,t.longitude*2-r.longitude,r.altitude,r.altitudeReference),et=i.getSoutheast().clone();i=it.fromLocations(h,r,ut,rt)}else t=y===s?p.getMercatorCenter(i):i.center.clone();k=ei(n.padding)?new ot(Math.max(1,l.width-n.padding),Math.max(1,l.height-n.padding)):l,v=p.locationRectToMercatorZoom(k,i),g=!0}else n.center&&(t=n.center,nt=n.centerOffset),ei(n.zoom)&&(v=n.zoom);var u=!1,b=e.getLookAt(),d=e.getWidth(),w=e.getHeading(),tt=!0;t&&(b=y.fromLocation(ft.toEllipsoid(t)),u=!0),ei(v)&&(d=f.mercatorZoomToWidth(v,y,b),u=!0),ei(n.heading)?(w=o.normalizeDegrees(n.heading),kt=w,u=!0):kt=null,n.animate===!1&&(tt=n.animate,u=!0),n.suspend!==c&&(n.suspend?er(!0):fr()),u&&wi(y,b,nt,d,w,tt,g)},this.setWrapping=function(n){gt=n},this.getCenter=function(){var n=h.getCenter();return new a(n.latitude,n.longitude)},this.getZoom=function(){return h.getMercatorZoom()},this.getHeading=function(){return h.getHeading()},this.getBounds=function(){return sr(h)},this.getMetersPerPixel=function(){return h.getMetersPerPixel()},this.getTargetCenter=function(){var n=e.getCenter();return new a(n.latitude,n.longitude)},this.getTargetZoom=function(){return e.getMercatorZoom()},this.getTargetHeading=function(){return e.getHeading()},this.getTargetBounds=function(){return sr(e)},this.getTargetMetersPerPixel=function(){return e.getMetersPerPixel()},this.cameraUpdated=function(){pt=h.getCrs(),ut=h.getWorldToViewport(),bi=h.getDistanceInverse()<vt,li=!h.getNeedsElevation()},this.tryLocationToViewport=function(n){return this.internalTryLocationToViewport(h,n)},this.tryViewportToLocation=function(n){return this.internalTryViewportToLocation(h,n,!0)},this.internalTryLocationToViewport=function(n,t){var i,v,o=n.getLookAt(),u,f,s;if(t.latitude!==c)return i=pt.fromLocation(ft.toEllipsoid(t,li)),gt&&(i=pt.wrap(i,o)),viewportPoint=ut.transform(i),bi||viewportPoint.z>=-1&&viewportPoint.z<=1?viewportPoint:null;u=t.length,f=new Array(u);if(!n.getPerspectiveOrigin().isZero()){var a=n.getViewportToWorld(),l=new r(0,n.getZoomOriginWidth()*6,0),e=a.transform(l),h=e.x*ut.m14+e.y*ut.m24+e.z*ut.m34+ut.m44;s=h}while(u--)i=pt.fromLocation(ft.toEllipsoid(t[u],li)),gt&&(i=pt.wrap(i,o)),o=i,viewportPoint=ut.transform(i,s),f[u]=bi||viewportPoint.z>=-1&&viewportPoint.z<=1?viewportPoint.toPoint():null;return f},this.internalTryViewportToLocation=function(n,t,i){var h=n.getCrs(),o=n.getViewportToWorld(),u,f,e,s;if(ki(t)){e=t.length,s=new Array(e);while(e--)u=o.transform(t[e]),i&&(u=ft.rayToGround(n.getCrs(),u,o.transform(new r(t[e].x,t[e].y,1)))),f=h.toLocation(u),f=new a(f.latitude,a.normalizeLongitude(f.longitude)),s[e]=h.toLocation(u);return s}return u=o.transform(t),i&&(u=ft.rayToGround(n.getCrs(),u,o.transform(new r(t.x,t.y,1)))),f=h.toLocation(u),f=new a(f.latitude,a.normalizeLongitude(f.longitude))},this.isDownloadingTiles=function(){return d.isDownloadingTiles()},this.getImageryId=function(){return w.imageryId?w.imageryId:""},this.isRotationEnabled=function(){return w.imageryId==="EnhancedBirdseye"||w.imageryId==="NativeBirdseye"},this.isMercator=function(){return uu(w)},this.getCopyrights=function(n){return n&&w.copyrightProvider?w.copyrightProvider.getCopyrights(v.getBounds(),h.getMercatorZoom(),h.getHeading(),n):n&&n([]),[]},this.setSceneContributors=function(t){var i=oi.length;while(i--)n.removeHandler(oi[i]);oi.length=0,i=t.length,lt.length=i;while(i--)lt[i]=t[i],oi.push(n.addHandler(lt[i],"newsceneavailable",wt));lt.sort(function(n,t){return n.priority-t.priority}),rt(),wt()},ui=!1,this.ensureUpdateDispatched=function(n){n?ri():rt()},this.getTargetCamera=function(){return e},this.getCurrentCamera=function(){return h},this.getCameraAnimationDuration=function(){return di},this.setAlignedCamera=function(n,t,i,r,u,f,e){kt=null,wi(n,t,i,r,u,f,e)},this.setCamera=function(n,t){ci(n,t)},this.allowSceneChanges=function(){fr()},this.suspendSceneChanges=function(n){er(n)},this.getCursors=function(){return tu},this.getPublicApi=function(){return{tryPixelToMercatorPoint:function(n){return v.getTargetCamera().getViewportToWorld().transform(n)},setViewChangeEndDelay:function(n){var n=parseInt(n);n<0||(nu=n)},canReprojectTileLayers:function(){return u.animateOverlayLayers},enableOrDisableZoomLevelSnap:function(n){pr=n===!0,st.setTouchZoomThreshold(n===!0?.1:0)},setPartialZoomBias:function(n){d&&d.setPartialZoomBias(Math.min(.5,Math.max(-.5,n)))}}}}function ou(n){this.url=n}function gt(n,t,i,r,u,f,e,s,h){var c=o.ceilLog2(Math.max(n,t));this.getWidth=function(){return n},this.getHeight=function(){return t},this.getTileWidth=function(){return i},this.getTileHeight=function(){return r},this.getTileOverlap=function(){return u},this.getTileBorder=function(){return f},this.getOffsetX=function(){return e},this.getOffsetY=function(){return s},this.getMaxLevelOfDetail=function(){return c},this.getUrl=h}function ir(r,o,s){function li(){var ci,tr,li=Math.round((h.x+v.x)/2),nr=Math.round((h.y+v.y)/2),o,w,hi,i,pt,y,ht,oi,et,ot,ei,f,gi,r,bi,e,ti,s,ii,wi,vi;for(wt&&(n.removeHandler(wt),wt=null),o=[],w=b(),ft=0,ni=0,d=[],ct=[],et=0,ot=0,f=h.y;f<=v.y;f++){for(et=0,ei=!1,gi=at&&at.y<=f&&lt&&lt.y>=f,r=h.x;r<=v.x;r++)hi=new g(h.levelOfDetail,r,f),i=null,bi=at&&at.x<=r&&lt&&lt.x>=r,y=a.getUrl(hi,ri),y&&(ht=fr.getState(y),ht!=ut.failed?(e=ai,ti=0,r===0&&(e-=rt,e+=it,ti=-it),r===pi&&(e-=rt,e+=it),s=ki,ii=0,f===0&&(s-=rt,s+=it,ii=-it),f===yi&&(s-=rt,s+=it),pt="width:"+e+"px;height:"+s+"px;border:0px;"+u.safariRenderHack,dt.requireFlowLayout?(et&&(pt+="margin-left:"+et*k+"px;"),ot&&(pt+="margin-top:"+ot*p+"px;")):pt+="position:absolute;left:"+((r-h.x)*k+ti)+"px;top:"+((f-h.y)*p+ii)+"px",i=b("img",pt),i[bt+"tileId"]=hi,i[bt+"tileUrl"]=y,i.width=e,i.height=s,i.border=0,ht===ut.ready||ht===ut.cacheExpired&&bi&&gi?(wi=r<tt.x||f<tt.y||r>st.x||f>st.y,wi?(i.style.visibility="hidden",ct.push(i)):i.src=y):(i.style.visibility="hidden",d.push(i)),ht!=ut.ready&&(oi=new ou(y),oi.priority=(li-r)*(li-r)+(nr-f)*(nr-f),o.push(oi)),fi.push(i)):c.isOverlay||ni++,ft++),i?(et=0,ei=!0,w.appendChild(i)):et++;ei?(ot=0,dt.requireFlowLayout&&b("br",null,w)):ot++}if(u.useImageDisposer){ci=vt.length;while(ci--)vt[ci].src=t.spacerImageUrl}vt.length=0,vi=vt,vt=fi,fi=vi,(u.useTransform3d||u.useTransform2d)&&(kt=this.hideWhileAnimating?dt.setExactTransformOrHide(nt,yt,c.opacity):dt.setTransformAndOpacity(nt,yt,c.opacity,{explicitOpacity:!0})),w.style.cssText=kt,l.parentNode&&l.parentNode.replaceChild(w,l),l=w,gt(),ui&&o.length&&(o.basketId=c,o.sort(hu),wt=n.addHandler(o,"hasnewtiles",di),fr.setDownloadBasket(o,ri)),si()}function si(){ct.length&&y.dispatch(tr),n.invoke(c,"tilesrendered")}function tr(){var t,n;if(c.allowTileRender){t=Math.min(ct.length,nr);while(t--)n=ct.shift(),n.style.visibility="visible",n.src=n[bt+"tileUrl"]}si()}function di(){var t,n;if(ui){t=d.length,n=!0;while(t--&&n){var r=!0,i=d[t],f=i[bt+"tileUrl"],u=fr.getState(f);switch(u){case ut.ready:ct.push(i);break;case ut.failed:dt.requireFlowLayout?n=!1:(l.removeChild(i),ni++);break;default:r=!1}r&&d.splice(t,1)}n?si():li()}}var c=this,pt,gt;var l=b(),h,v,tt,st,at,lt,ii=0,ci,yt,kt="",ft=0,ni=0,ui=!0,gi=!1,a=r,k,p,rt,it,ai,ki,et,ei,oi,vi,pi,yi,hi,ti,nt=e.identity,wi,bi,vt=[],fi=[],d=[],ct=[],wt,nr=3,ri;this.levelOfDetail=o,this.opacity=1,this.isOverlay=!1,this.hideWhileAnimating=!1,this.allowTileRender=!0,k=a.getTileWidth(),p=a.getTileHeight(),rt=a.getTileOverlap(),it=a.getTileBorder(),ai=k+2*rt,ki=p+2*rt,pt=Math.pow(2,a.getMaxLevelOfDetail()-o),et=Math.ceil(a.getWidth()/pt),ei=Math.ceil(a.getHeight()/pt),et=Math.ceil(et),pi=Math.ceil(et/k)-1,yi=Math.ceil(ei/p)-1,oi=e.multiply(a.projectingCamera.getWorldToFrustum(),e.scaling(et),e.translation(et/2+a.getOffsetX()/pt,ei/2+a.getOffsetY()/pt,0)),vi=oi.invert(),s&&(ri=!0),this.populate=function(n,t,r){var c,u,b,w;if(f.areEqual(n,wi)&&ot.areEqual(t,bi)&&ii==r)return;wi=n,bi=t;var l=e.multiply(n.getViewportToWorld(),oi),a=Math.ceil(t.width/2),y=Math.ceil(t.height/2),s=ht.union(l.transform(new i(-a,-y)),l.transform(new i(a,-y)),l.transform(new i(a,y)),l.transform(new i(-a,y)));c=new g(o,Math.floor(s.x/k),Math.floor(s.y/p)),u=new g(o,Math.floor(s.getRight()/k),Math.floor(s.getBottom()/p)),(!tt||!st||r>ii||tt.x>c.x||tt.y>c.y||st.x<u.x||st.y<u.y)&&(hi=null,ii=r,tt=c,st=u,at=h,lt=v,h=tt.clone(),h.x-=r,h.y-=r,v=u.clone(),v.x+=r,v.y+=r,ci=e.multiply(e.translation(h.x*k,h.y*p,0),vi),b=v.x-h.x+1,w=v.y-h.y+1,yt=new ot(b*k,w*p),li())},this.render=function(n,t){var i,r,o;f.areEqual(n,hi)&&ti===c.opacity||(nt=e.multiply(ci.projectOnPlane(n.getGroundPlane()),n.getWorldToViewport()),t&&(nt.offsetX+=t,nt.offsetY+=t),i={explicitOpacity:!this.hideWhiteAnimating},r=this.hideWhileAnimating?dt.setExactTransformOrHide:dt.setTransformAndOpacity,u.useTransform3d||u.useTransform2d?(i.includeCommonCss=!1,i.returnStyleObject=!0,o=r(nt,yt,c.opacity,i),l.style[w.Properties.transform]=o[w.Properties.transform],c.opacity!=ti&&(l.style.opacity=c.opacity)):(kt=r(nt,yt,c.opacity,i),l.style.cssText=kt),gt()),ti=c.opacity,hi=n},this.getRootElement=function(){return l},this.getTilePyramid=function(){return a},this.getDownloadProgress=function(){return ft>0&&d?1-d.length/ft:1},this.getNoImageTileRatio=function(){return ft>0?ni/ft:0},this.stopDownloading=function(){ui=!1,fr.removeDownloadBasket(c)},this.dispose=function(){gi=!0,c.stopDownloading(),l&&l.parentNode&&l.parentNode.removeChild(l)},gt=function(){},u.useFilterReflowWorkaround&&dt.usingIEFilters&&(gt=function(){l.offsetWidth})}function cr(){function rt(n,t,i){return n&&n.getTilePyramid()===t&&n.levelOfDetail===i}function s(t){t&&(n.removeHandler(t.rendererHandler),t.dispose())}function d(){var rt,t,r,ut,ot,v;y.cancelDispatch(d);var f,at=!1,lt=!1,b=!1,vt=!1,o=k;p?_allowNewTiles&&(tt||(rt=ti(),at=rt.keepGoing,b=rt.gridsAdded,vt=rt.shouldSwapTileGrids),yt&&gt()):(s(i),i=null,s(h),h=null,s(w),w=null,s(a),a=null,s(l),l=null),i&&(i.getDownloadProgress()<1&&(lt=!0),i.render(o)),h&&h.render(o),w&&w.render(o),a&&a.render(o,1),l&&l.render(o,1),f=e.length;while(f--)t=e[f],t.havePendingDownloads=!1,r=t.tileGrid,ut=ir.getBestLevelOfDetail(c,t.tilePyramid,it),v=t.tilePyramid.projectingCamera,ot=c.getHeading()!==v.getHeading()||c.getPitch()!==v.getPitch()||c.getRoll()!==v.getRoll()||c.getDistanceInverse()!==v.getDistanceInverse(),r&&(r.levelOfDetail!==ut||ot&&!u.animateOverlayLayers)&&(!t.tempDisplayGrid&&u.animateOverlayLayers?(t.tempDisplayGrid=r,t.swapping=null):r.dispose(),r=null),_allowNewTiles&&(!ot||u.animateOverlayLayers)&&(r||(r=ht(t.tilePyramid,ut),r.isOverlay=!0,r.hideWhileAnimating=t.animation==="s"?!1:t.animation==="h"?!0:u.animateOverlayLayers?!1:!0,r.opacity=t.opacity,b=!0),r.populate(c,g,nt)),(r||t.tempDisplayGrid)&&(t.tempDisplayGrid?t.swapping&&r?((t.swapping!=r||b||ft)&&et(r,f),r.render(k),t.tempDisplayGrid.dispose(),t.tempDisplayGrid=null,t.swapping=null):(t.tempDisplayGrid.render(k),ct(r,t.tempDisplayGrid,.85)&&(et(r,f),r.render(k),t.swapping=r,at=!0)):((b||ft)&&et(r,f),r.render(k)),r&&r.getDownloadProgress()<1&&(t.havePendingDownloads=!0)),t.tileGrid=r;ft=!1,!lt&&st&&n.invoke(pt,"tiledownloadcomplete"),st=lt,f=e.length;while(f--)t=e[f],!t.havePendingDownloads&&t.hadPendingDownloadsLastUpdate&&t.tileLayer&&n.invoke(t.tileLayer,"tiledownloadcomplete"),t.hadPendingDownloadsLastUpdate=t.havePendingDownloads;at&&y.dispatch(d,10),w&&c.getWidth()/k.getWidth()>.95&&(s(w),w=null)}function ti(){var n=!1,e=!1,l=!1,a=f.areAligned(c,k)&&c.getWidth()===k.getWidth(),u=ir.getBestLevelOfDetail(c,p,it);return rt(i,p,u)?(s(r),r=null,i.populate(a?k:c,g,nt),h&&(e=dt())):(rt(r,p,u)||(s(r),r=ht(p,u),r.mercatorZoom=p.projectingCamera.getMercatorZoom()+o.log2(p.projectingCamera.getWidth()/c.getWidth())),r.populate(c,g,nt),i==null?(i=r,r=null,v.appendChild(i.getRootElement()),n=!0):(s(h),h=null,i.opacity=1,s(w),w=null,pt.allowTileGridSwitch&&(!ut||r.getDownloadProgress()>.7)&&(r.getNoImageTileRatio()>.5?(s(r),r=null,tt=!0):ut&&at>1/t.maxFPS?(wt(),ni(),n=!0):(v.insertBefore(r.getRootElement(),i.getRootElement()),s(i),i=r,r=null,n=!0),h&&h.stopDownloading(),_lastTileGridBlendOn=new Date))),{keepGoing:e,gridsAdded:n,shouldSwapTileGrids:l}}function gt(){var n=kt[ir.getBestLevelOfDetail(c,p,it)],t=new ot(g.width*vt,g.height*vt);rt(a,p,n)?a.populate(c,t,0):(l||(l=ht(p,n,!0),l.populate(c,t,0),v.childNodes[0]?v.insertBefore(l.getRootElement(),v.childNodes[0]):v.appendChild(l.getRootElement())),a?ct(l,a,.9)&&(s(a),a=l,l=null,rt(a,p,n)||y.dispatch(d)):(a=l,l=null))}function dt(){var t=!1,r=(_lastTileGridBlendOn?new Date-_lastTileGridBlendOn:0)/1e3,n=r/at;return i.mercatorZoom>h.mercatorZoom?(i.opacity+=n,h.opacity=1,i.opacity<1&&n<.5?t=!0:(i.opacity=1,s(h),h=null)):(h.opacity-=n,i.opacity=1,h.opacity>0&&n<.5?t=!0:(s(h),h=null)),_lastTileGridBlendOn=new Date,t}function wt(){if(!r||!i)return;r.mercatorZoom>i.mercatorZoom?(i.getRootElement().nextSibling==null?v.appendChild(r.getRootElement()):v.insertBefore(r.getRootElement(),i.getRootElement().nextSibling),r.opacity=0):(v.insertBefore(r.getRootElement(),i.getRootElement()),r.opacity=1)}function ni(){h=i,i=r,r=null}function ht(t,i,r){var u=new ir(t,i,r);return u.rendererHandler=n.addHandler(u,"tilesrendered",bt),u}function bt(){y.dispatch(d,10)}function et(n,t){if(e[t].tempDisplayGrid){v.insertBefore(n.getRootElement(),e[t].tempDisplayGrid.getRootElement());return}var i=t+1;while(i<e.length){if(e[i].tempDisplayGrid){v.insertBefore(n.getRootElement(),e[i].tempDisplayGrid.getRootElement());break}else if(e[i].tileGrid){v.insertBefore(n.getRootElement(),e[i].tileGrid.getRootElement());break}i++}i<e.length||v.appendChild(n.getRootElement())}function lt(){ft=!0,e.sort(function(n,t){return n.zIndex-t.zIndex})}function ct(n,t,i){return n&&n.getDownloadProgress()>i&&(n.mercatorZoom<=t.mercatorZoom||c.getWidth()/k.getWidth()>.9)}var pt=this,at=.5,ut=!0,i=null,h=null,r=null,a=null,l=null,kt=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,14,14,14,17,17,17,20,20,20,23,23,23,23],yt=u.animateOverlayLayers,vt=u.isIOSBrowser?2:4,ii,v=b();v.style.cssText="position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack;var p,c,k,g,e=[],ft=!0,st=!1;_allowNewTiles=!0;var nt=0,tt=!1,w,it=-.25;this.allowTileGridSwitch=!0,this.render=function(n,t,i,r,u){r!=c&&(tt=!1),i!==p&&(st=!0,tt=!1),ut=u!=null?u:ut,g=n,k=t,p=i,c=r,d()},this.getBaseTilePyramid=function(){return p},this.addOverlay=function(n,t){var i=yi.getNext();return e.push({id:i,tilePyramid:n,zIndex:t.getZIndex(),opacity:t.getOpacity(),animation:t.getAnimation(),tileLayer:t,havePendingDownloads:!1,hadPendingDownloadsLastUpdate:!0}),lt(),y.dispatch(d,10),i},this.removeOverlay=function(n){var i,t=e.length;while(t--)if(e[t].id===n){i=e[t].tileGrid,i&&i.dispose(),e[t].tempDisplayGrid&&(e[t].tempDisplayGrid.dispose(),e[t].tempDisplayGrid=null),e.splice(t,1),y.dispatch(d,10);break}},this.updateOverlay=function(n,t,i){var r,u;_overlaysUpdated=!0,r=e.length;while(r--)if(e[r].id===n){u=e[r],u.opacity=i,u.zIndex!==t&&(u.zIndex=t,lt()),e[r].tempDisplayGrid&&(e[r].tempDisplayGrid.dispose(),e[r].tempDisplayGrid=null),y.dispatch(d,10);break}},this.suspendGettingNewTiles=function(){_allowNewTiles=!1,s(r),r=null,s(h),h=null,s(w),w=null,i&&(i.opacity=1,i.allowTileRender=!1)},this.allowGettingNewTiles=function(){i&&(i.allowTileRender=!0),_allowNewTiles||(_allowNewTiles=!0,y.dispatch(d,10))},this.disposeTiles=function(){y.cancelDispatch(d),s(r),r=null,s(h),h=null,s(w),w=null,s(i),i=null,s(a),a=null,s(l),l=null;var t,n,u=e.length;while(u--)t=e[u],n=t.tileGrid,n&&(n.dispose(),t.tileGrid=null)},this.showBackground=function(n){n!==null&&(yt=n,n||(s(a),a=null,s(l),l=null))},this.setBufferSize=function(n){n=Math.max(0,Math.min(4,n)),n!=nt&&(nt=n,y.dispatch(d))},this.getRootElement=function(){return v},this.setPartialZoomBias=function(n){it=n},this.isDownloadingTiles=function(){return r&&r.getDownloadProgress()<1||i&&i.getDownloadProgress()<1}}function pi(){function ni(n){nt(n.collection,n.entity,!0,!1,c.last)}function kt(n){d(n.entity,!0,!1),et(n.entity)}function ii(n){nt(n.collection,n.entity,!0,!1,c.last)}function ui(){nt(null,v,!1,!0,c.last)}function r(t,r,u,e){var s,o,h;t||(t=wt.getEntityForTarget(u.target)),t&&n.hasHandler(t.entity,r)&&(s=t.entity,e&&u.touches&&u.touches[0]&&(o=new i(u.touches[0].pageX,u.touches[0].pageY)),o||(o=k.Screen.get_mouse_pos(u)),h=new hi(f,t.type,s,r,o.x,o.y,0,e,u),n.invoke(s,r,h))}function nt(n,i,r,h,l){var fi,ct,y,bt,ni,et,ui,ei,st,at,si,oi,v,ci,it,tt,k,lt,wt,ii,pt;if(o){fi=!1;if(i instanceof ai){v=i[t],v?(ct=v.root,y=v.shape):(ct=b(null,u.safariRenderHack),y=b(null,u.safariRenderHack+";position:absolute;"),ct.appendChild(y),v={root:ct,shape:y,offsetTop:0,offsetLeft:0},i[t]=v,fi=!0,r=!0),r&&(bt="position:absolute;pointer-events:none;",i.getVisible()||(bt+="display:none;"),ni=i.getZIndex(),typeof ni=="number"&&(bt+="z-index:"+ni+";"),ct.style.cssText=bt+u.safariRenderHack);var st,hi=v.lookAt,ti=!1,kt=!1;for(h&&hi?(et=ut.getWorldToViewport().transform(hi),!ht&&(Math.abs(et.x)>1e4||Math.abs(et.y)>1e4)?(ti=!0,kt=!0,h=!1):(ui=e.translation(et.x,et.y,0),u.useTransform3d&&!u.isIOS3?(ei=dt.setTransformAndOpacity(ui,null,1,{excludeCommonCss:!0,returnStyleObject:!0}),y.style[w.Properties.transform]=ei[w.Properties.transform]):(st=dt.setTransformAndOpacity(ui,null,1,{excludeCommonCss:!u.isIOS3}),u.isIOS3||(st="position:absolute;"+st),y.style.cssText=st),v.offsetLeft=et.x,v.offsetTop=et.y)):ti=!0,ti&&(st="position:absolute;",v.lookAt=ut.getLookAt(),v.offsetLeft=0,v.offsetTop=0,y.style.cssText=st),y.harmony&&!ot.areEqual(v.previousSize,o)&&(at=y.harmony,at.style.width=o.width+"px",at.style.height=o.height+"px",at.style.left=-(o.width/2)+"px",at.style.top=-(o.height/2)+"px",v.previousSize=o),fi&&n[t].root.appendChild(ct),kt&&y.harmony&&y.harmony.style&&(y.harmony.style.display="none"),si=i.getLength(),it=0;it<si;it++)nt(i,i.get(it),r,h&&!kt,l);kt&&setTimeout(function(){y&&y.harmony&&y.harmony.style&&(y.harmony.style.display="block")},1)}else if(i instanceof nr)oi=i.getVisible()&&(s||g.contains(i.getLocation())||i[t]&&i[t].dragging),oi?ri(n,i,r,h):d(i,!0,r);else if(i instanceof ur)if(n.getVisible()){v=i[t],v||(v={},i[t]=v);if(r||!v.added||a.getBaseTilePyramid()!==ft){v.added=!1,ft=a.getBaseTilePyramid(),ci=ft?ft.projectingCamera:rt.mercator,it=p.length;while(it--)tt=p[it][0],v[tt]&&(a.removeOverlay(v[tt]),v[tt]=null),i.getVisible()&&rt[tt]===ci&&(k=i.getTileSource(tt),k&&(lt=gt.createQuadKeyTilePyramid(k.getWidth(),k.getHeight(),k.getUriConstructor(),p[it][1]),lt.projectingCamera=rt[tt],v[tt]=a.addOverlay(lt,i),v.added=!0));!v.added&&i.getVisible()&&i.getReproject()&&(k=i.getTileSource("mercator"),k&&(lt=gt.createQuadKeyTilePyramid(k.getWidth(),k.getHeight(),k.getUriConstructor(),p[0][1]),lt.projectingCamera=rt.mercator,v[tt]=a.addOverlay(lt,i)),v.added=!0)}}else d(i,!0,r);else wt=yt.getEntityRenderer(f,i),wt&&(ii={entityCollection:n,parentDom:n[t].shape,parentOffsetLeft:n[t].offsetLeft,parentOffsetTop:n[t].offsetTop,parentRemoved:!1,update:r,linear:h,animationStart:l===c.first,animationEnd:l===c.last,currentBounds:g,viewportSize:o,customRenderer:s},wt.shouldDraw(i,ii)?(pt=wt.update(i,ii),pt&&vt(pt,{entity:i,type:pt.type})):d(i,!0,r))}}function ri(n,i,r,f){var h,o,v,ot,c,w,a,p,ht,y,rt,g,d,nt,it,tt;if(!n[t])return;o=i[t],o?(r=o.updateEntity||r,o.updateEntity=!1):(h=b(null,u.safariRenderHack),h[l]={entity:i,type:ti.pushpin},o={dom:h,dragAttached:!1,offsetTop:0,offsetLeft:0},i[t]=o,r=!0),h=o.dom,r&&(v=o.icon,ot=i.getIcon(),!v&&ot&&(v=b("img",u.safariRenderHack,h),o.icon=v,v[l]={entity:i,type:ti.pushpin}),v&&(v.src=ot||""),c=o.text,w=i.getText(),!c&&w&&(c=b(null,u.safariRenderHack,h),c.appendChild(document.createTextNode("")),o.text=c,c[l]={entity:i,type:ti.pushpin}),c&&(w?(c.style.cssText="position:absolute;text-align:center;width:100%;font:bold 10pt Arial,Helvetica,Sans-Serif;color:#fff;left:"+i.getTextOffset().x+"px;top:"+i.getTextOffset().y+"px;",c.replaceChild(document.createTextNode(w),c.firstChild)):(h.removeChild(c),o.text=null))),a="";if(!s){a="position:absolute;overflow:hidden;pointer-events:all;"+u.safariRenderHack;if(!f||!o.isDrawn){p=pt.internalTryLocationToViewport(ut,i.getLocation());if(p){var ct=i.getAnchor(),et=p.x-ct.x-n[t].offsetLeft,ft=p.y-ct.y-n[t].offsetTop;u.useTransform3d&&i.getUseTransform3d()?(ht=e.translation(et,ft,0),y={excludeCommonCss:!0},r?a+=dt.setTransformAndOpacity(ht,null,1,y):(y.returnStyleObject=!0,rt=dt.setTransformAndOpacity(ht,null,1,y),o.displayHidden&&(rt.display=""),k(h).set_style(rt))):r?(a+="left:"+et+"px;",a+="top:"+ft+"px;"):(h.style.left=et+"px",h.style.top=ft+"px",o.displayHidden&&(h.style.display="")),o.displayHidden=!1}else r?a+="display:none;":h.style.display="none",o.displayHidden=!0;o.displayHidden=!0}}r&&(h.id=i.getId(),g=i.getTypeName()||"",h.className!=g&&(h.className=g),d=i.getZIndex(),typeof d=="number"&&(a+="z-index:"+d+";"),nt=i.getWidth(),a+="width:"+(nt?nt+"px;":"auto;"),it=i.getHeight(),a+="height:"+(it?it+"px;":"auto;"),a+="line-height:0px;",h.style.cssText=a),(r||!o.isDrawn)&&(tt=i.getDraggable(),tt!=o.dragAttached&&st(i,tt)),s?o.isDrawn?r&&s.updateEntity(i):(s.addEntity(i,h),o.isDrawn=!0):o.isDrawn||(n[t].shape.appendChild(h),o.isDrawn=!0)}function d(n,i,r){var e,y,u,o,v,c,b,w;if(n&&n[t]){e=n[t];if(n instanceof ai){u=e.root,y=!1,i&&u&&u.parentNode&&(h?(h.push(h),y=!0):u.parentNode.removeChild(u)),o=n.getLength();while(o--)d(n.get(o),y,r)}else if(n instanceof nr)st(n,!1),lt(n),u=e.dom,u&&(u[l]=null,i&&u.parentNode&&u.parentNode.removeChild(u)),e.updateEntity=e.updateEntity||r,e.isDrawn=!1,s&&s.removeEntity(n);else if(n instanceof ur){e.added=!1,o=p.length;while(o--)v=p[o][0],e[v]&&a.removeOverlay(e[v])}}else c=yt.getEntityRenderer(f,n),c&&(b={parentRemoved:!i,update:r,customRenderer:s},w=c.remove(n,b),vt(w,null))}function vt(n,t){if(n&&n.doms){var r=n.doms,i=r.length;while(i--)r[i][l]=t}}function et(n){var r,i;if(n instanceof ai){r=n.getLength();while(r--)et(n.get(r))}else n instanceof nr?(st(n,!1),lt(n)):(i=yt.getEntityRenderer(f,n),i&&i.dispose(n));delete n[t]}function st(i,r){var u=i[t];u&&(u.dragAttached=r,r?u.dragStartHandler=n.addHandler(i,"mousedown",bt):u.dragStartHandler&&(n.removeHandler(u.dragStartHandler),delete u.dragStartHandler))}function bt(r){var u=r.target,e=u[t],o,h,s;if(e&&(r.isTouchEvent||r.originalEvent.which===1)){e.dragging=!0,o=f.tryLocationToPixel(u.getLocation());if(o){h=o.x-r.getX(),s=o.y-r.getY(),n.invoke(u,"dragstart",{entity:u});function l(t){t.handled=!0;var r=f.tryPixelToLocation(new i(t.getX()+h,t.getY()+s));r&&u.setLocation(r),n.invoke(u,"drag",{entity:u})}function c(){lt(u),n.invoke(u,"dragend",{entity:u})}e.dragAttached&&!e.dragEndHandler&&(e.dragMoveHandler=n.addHandler(f,"mousemove",l),e.dragEndHandler=n.addHandler(f,"mouseup",c))}}}function lt(i){var r=i[t];r&&(r.dragging=!1,r.dragMoveHandler&&(n.removeHandler(r.dragMoveHandler),delete r.dragMoveHandler),r.dragEndHandler&&(n.removeHandler(r.dragEndHandler),delete r.dragEndHandler))}pi.ensureVmlNamespace();var wt=this,f,pt,s,v,a,at,l,t,o,ut,g,ht,it,h,ft,c={first:0,middle:1,last:2},y=[["entityadded",ni],["entityremoved",kt],["entitychanged",ii]],ct,p=[["mercator",tt.horizontal],["enhancedBirdseyeNorthUp",tt.horizontal],["enhancedBirdseyeEastUp",tt.vertical],["enhancedBirdseyeSouthUp",tt.horizontal],["enhancedBirdseyeWestUp",tt.vertical]];this.activate=function(i,r,e,o,h,c){f=i,pt=r,v=f.entities,a=e,s=c,ht=si.isClipped(),at=h,l=at+"_der",t=at+"_etr",v[t]={root:o,shape:b(null,u.safariRenderHack+";position:absolute;",o),offsetTop:0,offsetLeft:0};var p=y.length;while(p--)y[p][2]=n.addHandler(v,y[p][0],y[p][1]);ct=n.addHandler(yt,"newEntityRenderer",ui)},this.deactivate=function(){o=null;var t=y.length;while(t--)n.removeHandler(y[t][2]),y[t][2]=null;n.removeHandler(ct),ct=null,d(v,!0,!1),et(v),f=null,v=null,a=null},this.onMouseDown=function(n){r(null,"mousedown",n)},this.onTouchStart=function(n){h||(h=[]),r(null,"mousedown",n,!0)},this.onMouseUp=function(n){r(this.getEntityForTarget(n.captureTarget),"mouseup",n)},this.onTouchEnd=function(n){var i,u,t;r(this.getEntityForTarget(n.captureTarget),"mouseup",n,!0);if(h){i=h,h=null,u=i.length;while(u--)t=i[u],t&&t.parentNode&&t.parentNode.removeChild(t)}},this.onMouseOver=function(n){r(null,"mouseover",n)},this.onMouseOut=function(n){r(null,"mouseout",n)},this.onMouseClick=function(n){r(null,"click",n)},this.onMouseRightClick=function(n){r(null,"rightclick",n)},this.onMouseDoubleClick=function(n){r(null,"dblclick",n)},this.onTap=function(n){r(null,"click",n,!0)},this.onDoubleTap=function(n){r(null,"dblclick",n,!0)},this.onTapAndHold=function(n){r(null,"rightclick",n,!0)},this.getEntityForTarget=function(n){return n&&n.nodeType===3&&(n=n.parentNode),n&&n[l]?n[l]:null},this.update=function(n,t,i,r){o=n,ut=t,r!=c.last&&g||(g=f.getBounds(),g.width*=3,g.height*=3),it=r==c.last&&ht?!1:it&&i,nt(null,v,!1,it,r),r==c.last&&(it=!0)}}function cu(n){function s(n,i){var f=null,r=n[t],e,u;return r&&(e=r.harmony,e&&(u=r.path,u&&(f=u.nativeShape,e.removePath(u),r.path=null)),r.updateEntity=r.updateEntity||i.update,r.isDrawn=!1),si.isEventsSupported()&&f?{doms:[f]}:null}function i(n){var i=n[t];return i||(i={},n[t]=i),i}function e(n,t){for(var h=n.x,s=n.x+n.width,a=n.y,l=n.y+n.height,o=[],i=[],v=t.length,e,r,c,u=0;u<v;u++)r=t[u],r?(c=r.x>=h&&r.y>=a&&r.x<=s&&r.y<=l,c?(!i.length&&u&&t[u-1]&&i.push(t[u-1]),i.push(r),e=null):(i.length&&(i.push(r),o.push(i),i=[]),e&&f(h,s,a,l,e,r)&&(i.push(e),i.push(r),o.push(i),i=[]),e=r)):(o.push(i),i=[]);return i.length&&o.push(i),o}function f(n,t,i,r,u,f){if(f.x-u.x==0)return u.x>=n&&u.x<=t;if(f.y-u.y==0)return u.y>=i&&u.y<=r;var o=(f.y-u.y)/(f.x-u.x),s=u.y-o*u.x,e=o*n+s;if(e>=i&&e<=r)return!0;e=o*t+s;if(e>=i&&e<=r)return!0;return o=(f.x-u.x)/(f.y-u.y),s=u.x-o*u.y,e=o*i+s,e>=n&&e<=t?!0:!1}var o=n,r="cm"+yi.getNext(),t=r+"_etr";this.shouldDraw=function(n,t){var f=n.getVisible()&&(t.linear||t.animationEnd||u.animateShapes),r,e;return f&&(r=i(n),(t.update||!r.boundingRect)&&(e=n.getLocations(),e?(r.boundingRect=it.fromLocations(n.getLocations()),t.currentBounds.intersects(r.boundingRect)||(f=!1)):f=!1)),f},this.update=function(n,t){var h=t.viewportSize,st=t.currentBounds,f=i(n),a,v,w,s,d,et,tt,l,ut,rt,c,k,ft,nt,g,it,p,y;t.update=f.updateEntity||t.update,f.updateEntity=!1,a=f.harmony,!a&&t.parentDom&&(v=t.parentDom.harmony,v||(v=b("div","position:absolute;width:"+h.width+"px;height:"+h.height+"px;left:"+-(h.width/2)+"px;top:"+-(h.height/2)+"px;"+u.safariRenderHack),t.parentDom.harmony=v,w=t.parentDom,w.firstChild?w.insertBefore(v,w.firstChild):w.appendChild(v)),a=si.getContext(v),f.harmony=a),s=f.path,d=!1,s&&ot.areEqual(f.previousSize,h)||(a.setSize(h.width,h.height),f.previousSize=h,d=!0),s||(s=a.createPath(),s.id=r+"path"+yi.getNext(),f.path=s,addToDiv=!0,t.update=!0),t.update&&(et=n.getStrokeColor(),s.strokeStyle=et.toHex(),s.strokeOpacity=et.getOpacity(),s.lineWidth=n.getStrokeThickness(),s.dashArray=n.getStrokeDashArray(),n instanceof tr?(tt=n.getFillColor(),s.fillStyle=tt.toHex(),s.fillOpacity=tt.getOpacity()):s.fillStyle="none");if(!t.linear||!f.points||d){f.points=o.tryLocationToPixel(n.getLocations()),f.offsetLeft=t.parentOffsetLeft,f.offsetTop=t.parentOffsetTop,ut=n instanceof wi&&(f.boundingRect.width>st.width||f.boundingRect.height>st.height),f.doClipping=ut;if(!ut){c=f.points,rt=c.length,l=c.length;while(l--)c[l]||(rt=!1,l=0);rt||(f.points=[])}}if(!t.linear||t.animationEnd||t.update||d){c=f.points,f.doClipping?(ft=h.width*3,nt=h.height*3,k=e(new ht(-t.parentOffsetLeft-ft/2,-t.parentOffsetTop-nt/2,ft,nt),c)):k=[c],s.beginPath(),g=f.offsetLeft-h.width/2,it=f.offsetTop-h.height/2,l=k.length;while(l--){p=k[l];if(p&&p.length)for(y=p[0],s.moveTo(y.x-g,y.y-it),j=1;j<p.length;j++)y=p[j],s.lineTo(y.x-g,y.y-it)}s.data||s.moveTo(0,0),s.stroke(),f.isDrawn||(a.renderPath(s),f.isDrawn=!0)}return si.isEventsSupported()?{doms:[s.nativeShape],type:n instanceof wi?ti.polyline:ti.polygon}:null},this.remove=s,this.dispose=function(n){delete n[t]}}function ar(n,t,i,r,u){function e(n){var u=[],i=n?n.split(";"):[],r=i.length,t;while(r--)t=it.fromString(i[r]),t&&u.push(t);return u}this.priority=u;var f=e(r);this.getScene=function(r,u,e,o){if(o>=t&&o<i){if(!f||!f.length)return n;var c=new a(u,e),h=f.length;while(h--)if(f[h].contains(c))return n}return null}}function ri(n,t){var r=n,i=wr.replace(/{year}/,(new Date).getFullYear());this.getCopyrights=function(n,u,f,e){t(function(t){t?yr.getCopyrights(r,n,u,f,t,e):e([i])})}}function vr(t,r,e,o,s,h,c){function et(n){n.stopPropagation(),n.preventDefault()}function ii(n,t){var r,i;r=n.length;if(t)while(r--)i=n[r],o.add_event(i[0],i[1],!1);else while(r--)i=n[r],o.remove_event(i[0],i[1],!1)}function ni(){return v!=null&&(v.x!=0||v.y!=0)}function vr(){yt&&ni()&&(v.x*=yt,v.y*=yt,Math.abs(v.x)<5&&Math.abs(v.y)<5&&(v.x=0,v.y=0))}function wi(n,t,i){if(n&&t&&i){var u=i.x-t.x,r=i.y-t.y;u!=0||r!=0?(ot+=n,v?(v.x=.3*v.x+.7*u*1e3/ot,v.y=.3*v.y+.7*r*1e3/ot):v=new wt(u*1e3/ot,r*1e3/ot),ot=0):ot+=n}}function bi(n){var t=k.Screen.get_mouse_pos(n);return new i(t.x-r.getViewportX(),t.y-r.getViewportY())}function st(){return new i(0,0)}function w(u,f,e,o){var y=!1,c,p,h,a,v;return n.hasHandler(t,f)&&(o||(e.touches&&e.touches[0]?c=new i(e.touches[0].pageX,e.touches[0].pageY):l&&l[0]&&(c=l[0])),c||(c=k.Screen.get_mouse_pos(e)),p=e.wheelDelta?e.wheelDelta:0,s&&(u&&(h=s.getEntityForTarget(u)),h||(h=s.getEntityForTarget(e.target)),h&&(a=h.type,h=h.entity)),a||(h=r,a=ti.map),v=new hi(r,a,h,f,c.x,c.y,p,!o,e),f==="click"&&(v.mouseMoved=ui&&d&&i.distance(ui,d)>5),n.invoke(t,f,v),y=v.handled),y}function yr(n){if(!n.handled){var i=!1;if(n.ctrlKey)switch(n.keyCode){case 37:e.rotate(90);break;case 39:e.rotate(-90)}else switch(n.keyCode){case 37:a.x>-1&&(a.x=-1),i=!0;break;case 39:a.x<1&&(a.x=1),i=!0;break;case 38:a.y>-1&&(a.y=-1),i=!0;break;case 40:a.y<1&&(a.y=1),i=!0;break;case 109:case 189:lt=-1;break;case 107:case 187:case 61:lt=1}t.ensureUpdateDispatched(),i&&(n.handled=!0,et(n.originalEvent))}}function br(n){if(!n.handled){switch(n.keyCode){case 37:case 39:a.x=0;break;case 38:case 40:a.y=0;break;case 109:case 189:case 107:case 187:case 61:lt=0}t.ensureUpdateDispatched()}}function ei(){a.x=0,a.y=0,lt=0}function ai(n){if(!w(null,"dblclick",n,!0)&&!ft){if(s)s.onMouseDoubleClick(n);var t=rt?st():bi(n);e.zoomCenter(.5,t)}et(n)}function gr(n){if(!w(null,"click",n,!0)&&s){s.onMouseClick(n);if(u.emulateDblClick){var t=k.Screen.get_mouse_pos(n);new Date-ci<pi&&t.x===bt.x&&t.y===bt.y?(bt={x:0,y:0},ci=new Date(0),ai(n)):(bt=t,ci=new Date)}}}function nu(n){if(!w(null,"rightclick",n,!0)&&s)s.onMouseRightClick(n)}function kr(n){if(!w(null,"mousewheel",n,!0)&&!ft){nt.clearInertialScrolling();if(n.wheelDelta){var t=rt?st():bi(n);e.zoomPoint(n.wheelDelta,t)}et(n)}}function dr(n){if(!w(null,"mousedown",n,!0)){ei(),t.suspendSceneChanges(!1),e.startUserInput();if(s)s.onMouseDown(n);dt=h&&(n.shiftKey===!0||n.which===2),d=k.Screen.get_mouse_pos(n),nt.clearInertialScrolling(),ui=g=d,k.Events.capture_mouse(this),ri=!0,dt?o.set_style({cursor:t.getCursors().SEResize}):o.set_style({cursor:t.getCursors().Grabbing})}et(n)}function ar(n){w(null,"mousemove",n,!0)||g&&(d=k.Screen.get_mouse_pos(n),t.ensureUpdateDispatched(),rr=new Date,et(n))}function fr(n){ri&&vi(n)}function vi(n){var l,a;if(!w(n.captureTarget,"mouseup",n,!0)){t.allowSceneChanges(),at===!0&&(l=new Date,a=l-rr,a<gi?ut=d:nt.clearInertialScrolling()),t.ensureUpdateDispatched();if(s)s.onMouseUp(n);if(dt&&g)if(i.distance(g,d)>10){var c=r.getViewportX(),f=r.getViewportY(),u=ht.union(new i(g.x-c,g.y-f),new i(d.x-c,d.y-f)),y=Math.max(u.width/r.getWidth(),u.height/r.getHeight()),v=rt?st():u.getCenter();e.zoomCenter(y,v)}}h&&(tt.style.display="none",tt.parentNode&&tt.parentNode.removeChild(tt)),o.set_style({cursor:t.getCursors().Grab}),g=null,ri=!1,k.Events.release_mouse()}function ur(n){if(!w(null,"mouseover",n,!0)&&s)s.onMouseOver(n)}function er(n){if(!w(null,"mouseout",n,!0)&&s)s.onMouseOut(n)}function oi(n){var u=r.getViewportX(),t=r.getViewportY();return n.length>1?new i((n[0].x+n[1].x)/2-u,(n[0].y+n[1].y)/2-t):n.length?new i(n[0].x-u,n[0].y-t):new i(0,0)}function lr(n){n.preventManipulation&&n.preventManipulation(),n.currentTarget&&n.currentTarget.msSetPointerCapture&&n.currentTarget.msSetPointerCapture(n.pointerId),n.preventMouseEvent&&n.preventMouseEvent(),ei(),fi();if(!w(null,"mousedown",n,!1)){t.suspendSceneChanges(!0),e.startUserInput();if(s)s.onTouchStart(n);nt.clearInertialScrolling();var r=Math.min(2,n.touches.length);ct===0&&r===2&&(ct=t.getCurrentCamera().getMercatorZoom()),p.length===0&&r===1&&(y=new i(n.touches[0].pageX,n.touches[0].pageY),y.target=n.target,y.start=new Date,gt=setTimeout(cr,wr));while(r--)l[r]=new i(n.touches[r].pageX,n.touches[r].pageY),p[r]=l[r],it[r]=l[r];ir=t.getCurrentCamera().getHeading()}et(n)}function sr(n){(n.touches.length>1||y&&(Math.abs(n.touches[0].pageX-y.x)>20||Math.abs(n.touches[0].pageY-y.y)>20))&&(li(),fi());if(n.touches.length>1||!w(null,"mousemove",n,!1)){var r=p.length;if(r){r=n.touches.length;while(r--)l[r]=new i(n.touches[r].pageX,n.touches[r].pageY)}}t.ensureUpdateDispatched(),ki=new Date,et(n)}function tr(n){var a,g,d,k,o,h,c,u,v,b;n.currentTarget.msReleasePointerCapture&&n.currentTarget.msReleasePointerCapture(n.pointerId),fi();if(!w(null,"mouseup",n,!1)){if(s)s.onTouchEnd(n);y&&(or(),kt&&new Date-kt.start<pi?(a=new i(y.x-r.getViewportX(),y.y-r.getViewportY()),hr(),li()):kt=y),p.length===1&&at===!0&&(g=new Date,d=g-ki,d<gi?ut=l[0]:nt.clearInertialScrolling()),p.length=0,n.touches.length&&(nt.clearInertialScrolling(),l[0]=p[0]=new i(n.touches[0].pageX,n.touches[0].pageY)),t.allowSceneChanges();if(a&&!ft)o=rt?st():a,e.zoomCenter(.5,o);else{if(it.length>1&&t.isRotationEnabled()){var tt=new wt(it[1].x-it[0].x,it[1].y-it[0].y),et=new wt(l[1].x-l[0].x,l[1].y-l[0].y),ot=Math.atan2(et.y,et.x)-Math.atan2(tt.y,tt.x);Math.abs(ot)>.7&&(ct=0),it.length=0}ct!==0&&si>0&&(o=rt?st():oi(l),h=t.getCurrentCamera().getMercatorZoom(),c=h-ct,ct=0,u=Math.abs(c),u-=Math.floor(u),u>=si&&u<.5&&(v=c>0?Math.ceil(h):Math.floor(h),b=f.mercatorZoomToWidth(v,t.getCurrentCamera().getCrs(),k)/f.mercatorZoomToWidth(h,t.getCurrentCamera().getCrs(),k),e.zoomCenter(b,o,o)))}ni()||e.endUserInput()}}function fi(){gt&&(clearInterval(gt),gt=null)}function li(){kt=null,y=null}function or(){if(!w(null,"click",y,!1)&&s)s.onTap(y)}function hr(){if(!w(null,"dblclick",y,!1)&&s)s.onDoubleTap(y)}function cr(){if(y){if(!w(null,"rightclick",y,!1)&&s)s.onTapAndHold(y);li()}}var nt=this,tt;c=c||{},h&&(tt=b("div","display:none;z-index:0;position:absolute;border:1px dashed #000;background:#ccc"),k(tt).set_style({opacity:".5"}));var yi=.15,pi=500,wr=1e3,kt,y,gt,si=c.touchZoomThreshold!=null?c.touchZoomThreshold:.1,iu=[],ri=!1,at=!0,yt=.9,v=null,vt=null,ut=null,bt={x:0,y:0},ci=new Date(0),rr=new Date(0),ki=new Date(0),gi=100,ot=0,rt=!1,ft=!1,pr=[["dblclick",ai],["click",gr],["mousewheel",kr],["mousedown",dr],["mousemove",ar],["mouseup",vi],["losecapture",fr],["contextmenu",nu],["mouseover",ur],["mouseout",er]],nr=[["touchstart",lr],["touchmove",sr],["touchend",tr],["touchcancel",tr]],pt=[["keydown",yr,null],["keyup",br,null],["blur",ei,null]],tu=null,uu=.003*u.scrollAdjustment,ru=0,a=new i(0,0),lt=0,di=new Date(0),d,g,ui,dt,l=[],it=[],ir,p=[],ct=0;nt.enableOrDisableInertialScrolling=function(n,t){n?(at=!0,typeof t=="number"&&(yt=Math.min(Math.max(t,.01),.99))):at=!1},nt.enableOrDisableUserInput=function(t,i){if(i){t=t&&!i.disableUserInput,ii(pr,t&&!i.disableMouseInput),t&&!i.disableTouchInput?(o.set_style({"-ms-touch-action":"none"}),ii(nr,!0)):(o.set_style({"-ms-touch-action":""}),ii(nr,!1)),t=t&&!i.disableKeyboardInput;var u,f;u=pt.length;if(t)while(u--)f=pt[u],f[2]||(f[2]=n.addHandler(r,f[0],f[1]));else while(u--)n.removeHandler(pt[u][2]),pt[u][2]=null;rt=i.disablePanning?!0:!1,ft=i.disableZooming?!0:!1}},nt.setTouchZoomThreshold=function(n){si=Math.min(n,.49)},nt.clearInertialScrolling=function(){ut=null,v=null},nt.processPendingUserInput=function(){var h=new Date,c=vt?h-vt:null,y,kt,ti,s,u,n,ot,b,w,k;vt=h,kt=t.getCurrentCamera().getWidth(),ti=t.getCurrentCamera().getLookAt(),lt&&!ft&&(nt.clearInertialScrolling(),y=lt<0?2:.5),(a.x||a.y)&&!rt&&(nt.clearInertialScrolling(),s=a.x*yi*r.getWidth(),u=a.y*yi*r.getHeight(),Math.abs(a.x)>.9&&Math.abs(a.x)<3&&(a.x=a.x*1.01),Math.abs(a.y)>.9&&Math.abs(a.y)<3&&(a.y=a.y*1.01)),(y||s||u)&&(h=new Date,(vt-di)/1e3>t.getCameraAnimationDuration()/3&&(y&&e.zoom(y),(s||u)&&e.doDragXY(s,u),di=h));if(g)if(dt&&!ft){var pt=r.getPageX(),bt=r.getPageY(),f=ht.union(new i(g.x-pt,g.y-bt),new i(d.x-pt,d.y-bt));tt.style.left=f.x+"px",tt.style.top=f.y+"px",tt.style.width=f.width+"px",tt.style.height=f.height+"px",tt.style.display="block",o.element().appendChild(tt)}else rt||(e.doDrag(g,d),at===!0&&wi(c,g,d),g=d);else if(p.length>0){n=p.length;if(l.length>=n){switch(n){case 1:rt||(e.doDrag(p[0],l[0]),at===!0&&wi(c,p[0],l[0]));break;case 2:ot=rt?st():oi(p),b=rt?st():oi(l);if(!l[0]||!l[1]||!p[0]||!p[1])return;w=1,ft||(w=i.distance(p[0],p[1])/i.distance(l[0],l[1])),k=0;if(it.length>1&&t.isRotationEnabled()){var ct=new wt(it[1].x-it[0].x,it[1].y-it[0].y),yt=new wt(l[1].x-l[0].x,l[1].y-l[0].y),gt=Math.atan2(yt.y,yt.x)-Math.atan2(ct.y,ct.x);k=ir-t.getCurrentCamera().getHeading()-gt*180/Math.PI}e.setCamera(w,ot,b,k)}while(n--)p[n]=l[n]}}else if(ni()){if(ut){var et=new i(ut.x+v.x*c/1e3,ut.y+v.y*c/1e3),ot=new i(Math.round(ut.x),Math.round(ut.y)),b=new i(Math.round(et.x),Math.round(et.y));e.doDrag(ot,b),ut=et}vr(),ni()?t.ensureUpdateDispatched():e.endUserInput()}else e.endUserInput()}}function lr(n,t){var e=null,s=.003*u.scrollAdjustment,r=0;this.doDrag=function(r,u){if(r&&u&&!i.areEqual(r,u)){var e=t.getViewportX(),f=t.getViewportY(),h=new i(r.x-e,r.y-f),s=new i(u.x-e,u.y-f),o=n.getCurrentCamera().getViewportToWorld().transform(h);n.setAlignedCamera(n.getCurrentCamera().getCrs(),o,s,n.getCurrentCamera().getWidth(),n.getCurrentCamera().getHeading(),!1)}},this.doDragXY=function(t,r){var f=n.getCurrentCamera().getWidth(),u=n.getCurrentCamera().getViewportToWorld().transform(new i(t,r));n.setAlignedCamera(n.getCurrentCamera().getCrs(),u,null,f,n.getCurrentCamera().getHeading(),!0)},this.zoom=function(t){var i=n.getCurrentCamera().getWidth()*t,r=n.getCurrentCamera().getLookAt();i!==n.getTargetCamera().getWidth()&&n.setAlignedCamera(n.getCurrentCamera().getCrs(),r,null,i,n.getCurrentCamera().getHeading(),!0)},this.zoomCenter=function(t,i,r){var u=n.getTargetCamera(),e=u.getWidth()*t,f=u.getViewportToWorld().transform(i);n.setAlignedCamera(u.getCrs(),f,r,e,u.getHeading(),!0)},this.zoomPoint=function(t,i){var y=new Date,h=y-e,l,o,c,u,v,a;e=y,l=n.getCurrentCamera().getViewportToWorld().transform(i),o=s*t*(t>0?1:.75),h>200?(h=200,r=o/h):r=(r+o/h)/2,r=Math.min(.009,r),r=Math.max(-.006,r),c=n.getCurrentCamera().getMercatorZoom(),u=c+r*(r>0?400:250),u=o>0?Math.min(n.getInternalMaxZoom(),Math.ceil(u)):Math.max(n.getInternalMinZoom(),Math.floor(u)),v=f.mercatorZoomToWidth(u,n.getCurrentCamera().getCrs(),l),a=(u-c)/r*1.5,n.setAlignedCamera(n.getCurrentCamera().getCrs(),l,i,v,n.getCurrentCamera().getHeading(),a)},this.rotate=function(t){n.setAlignedCamera(n.getTargetCamera().getCrs(),n.getTargetCamera().getLookAt(),null,n.getTargetCamera().getWidth(),n.getTargetCamera().getHeading()+t,!0)},this.setCamera=function(t,i,r,u){var e=n.getCurrentCamera().getViewportToWorld().transform(i),f=o.log2(1/t);n.setCamera(n.getCurrentCamera().getAlignedCamera(f,e,r,u),!1)},this.startUserInput=function(){},this.endUserInput=function(){}}function fu(i){function it(n,t,i,r,u,f){var ut,p,d,k,it;if(r>=g){ut=ft.toEllipsoid(new a(t,i)),p=s.wrap(s.fromLocation(ut));if(y(n,p,r,u,f))return n;var st=1<<b,ot=v.mercatorXYToTileId(p,b),w=v.tileIdToCacheKey(ot),et=Math.round(o.normalizeDegrees(u)/c)*c%360,l=e.get(w)||[],tt=l.length,nt;while(tt--){nt=l[tt];if(y(nt,p,r,u,f))return nt}d="h"+et.toFixed(),l[d]||(l[d]=!0,e.insert(w,l),k=v.tileIdToLocation(ot),it=h.replace("{centerpoint}",k.latitude.toFixed(6)+","+k.longitude.toFixed(6)).replace("{heading}",et.toFixed(0)),ii.getObjectAsync(it,rt,w))}return null}function rt(t,i){var f=i.userData,r,u;i.success&&t&&t.statusCode===200&&t.resourceSets&&t.resourceSets.length&&(r=t.resourceSets[0],r.resources&&r.resources.length&&(u=e.get(f)||[],tt(r.resources[0],u),e.insert(f,u),n.invoke(l,"newsceneavailable")))}function tt(n,e){var it;if(n.bes&&n.bes.bec&&n.bes.bei){var l=n.bes,bt=l.s.toString(),c=l.bei,h=l.bec,w=k.get(bt);if(!w){w=[];var ut=2*Math.ceil(c.piw/(2*u)),ot=2*Math.ceil(c.pih/(2*u)),et=ut*u,b=new r(h.qcx,h.qcy,h.qcz),yt=new r(h.qdx,h.qdy,h.qdz),ni=new r(h.qex,h.qey,h.qez),g=bi.toLocation(b),ti=ft.getAltitudeAtLatLon(g.latitude,g.longitude),wt=bi.fromLocation(new a(g.latitude,g.longitude,ti,pt.ellipsoid)),ii=kt.fromNormal(wt,bi.getUpVector(wt)),gt=ii.intersectWithLine(b,r.add(b,yt)),dt=r.subtract(gt,b).getLength(),vt=et/c.piw*(h.ox/(2*h.ol)),ei=2*Math.atan(vt),fi=2*dt*vt,ui=f.fromDirectionVector(bi,gt,fi,yt,ni,1/dt),tt=ui.convertCoordinateReferenceSystem(s),ct=(c.piw-d)/et,st=(c.pih-d)/et,lt=new ht(-ct/2-h.opx,-st/2-h.opy,ct,st),v,y,rt;y=p(t.nativeBirdseyeUriFormat.replace("{quadkey}",l.q).replace("{runtimeindex}",l.ri),ut,ot,l.l,h.opx*c.piw,h.opy*c.pih),y.projectingCamera=tt,rt=tt.getAlignedCamera(o.log2(y.getWidth()/t.zoomOriginWidth)-1),v=new at(rt,y,1,"NativeBirdseye",new ri("Birdseye",i)),v.nativeBirdseyeFrustumRect=lt,v.labelOverlay=nt.hidden,w.push(v),y=p(t.nativeBirdseyeWithLabelsUriFormat.replace("{quadkey}",l.q).replace("{runtimeindex}",l.ri),ut,ot,l.l,h.opx*c.piw,h.opy*c.pih),y.projectingCamera=tt,v=new at(rt,y,1,"NativeBirdseye",new ri("BirdseyeWithLabels",i)),v.nativeBirdseyeFrustumRect=lt,v.labelOverlay=nt.visible,w.push(v)}k.insert(bt,w),it=w.length;while(it--)e.push(w[it])}}function y(n,t,i,r,u){if(n&&n.nativeBirdseyeFrustumRect&&n.labelOverlay===u&&o.distanceDegrees(r,n.nativeCamera.getHeading())<c&&i>=n.nativeCamera.getMercatorZoom()-.5){var f=n.tilePyramid.projectingCamera.getWorldToFrustum().transform(t);if(n.nativeBirdseyeFrustumRect.contains(f))return!0}return!1}function p(n,t,i,r,f,e){var s=Math.ceil(t/2),h=Math.ceil(i/2),o=new gt(t*u,i*u,u,u,0,0,f,e,function(u){var e,f,c;switch(u.levelOfDetail){case o.getMaxLevelOfDetail()-1:f=s,c=h,e=r-1;break;case o.getMaxLevelOfDetail():f=t,c=i,e=r}if(e)if(u.x>=0&&u.x<f&&u.y>=0&&u.y<c)return n.replace("{subdomain}",(u.y&1)*2+(u.x&1)).replace("{level}",e).replace("{index}",f*u.y+u.x);return null});return o}var l=this,g=17.1,e=new li(100),b=19,k=new li(100),c=45,d=400,u=256,h=t.nativeBirdseyeMetadataUrl.replace("{zoom}","20"),w;this.priority=40,this.getScene=function(){return w||(w=!0,i(function(t){h=h.replace("{credentials}",t),l.getScene=it,n.invoke(l,"newsceneavailable")})),null}}var wr="© {year} Microsoft Corporation",au="A new version of Bing Maps SDK is available",h=window.Microsoft.Maps,k=h.Gimme,t=h.Globals,c,l={},bt,u,y,fi,pt,lt,nt,ui,n,er,vi,ci,ii,ti,di,or,tu,st,nu,o,p,s,bi,rt,v,ft,tt,si,uu,b,ru,yr,hr;h.InternalNamespaceForDelay=l,bt="mm$",typeof PRF=="undefined"&&(PRF={add:function(){},start:function(){},end:function(){}}),l.PRF=PRF,PRF.start("mapcore");var rr=new function(){function f(n,t){var i=!1;return o(n)&&(e(n,t),i=!0),i}function o(n){return localStorage&&localStorage.getItem(n+".keys")&&!localStorage.getItem(n+".invalid")?!0:!1}function i(n,t){var r,i,u;if(!localStorage.getItem(n+".keys")||typeof t!="function")return;for(r=localStorage.getItem(n+".keys").split(";"),i=0,i=r.length;i>0;i--)u=r[i-1],t(u)}function e(n,t){i(n,function(i){t[i]=u(n,i)})}function h(r){localStorage.setItem(r+".invalid","true"),i(r,function(i){localStorage.removeItem(n(r,i)),localStorage.removeItem(t(r,i))}),localStorage.removeItem(r+".keys"),localStorage.removeItem(r+".invalid")}function s(n,t){var u,i;h(),u="";for(i in t)r(n,i,t[i]),u+=i+";";localStorage.setItem(n+".keys",u.substring(0,u.length-1))}function r(i,r,u){var f=typeof u;localStorage.setItem(t(i,r),f),localStorage.setItem(n(i,r),u)}function u(i,r){var f=localStorage.getItem(t(i,r)),u=localStorage.getItem(n(i,r));switch(f){case"number":return Number(u);case"boolean":return Boolean(u);case"string":case null:return u}}function n(n,t){return n+"."+t}function t(n,t){return n+"."+t+".type"}this.GlobalsId="globals",this.tryLoadConfigIntoObject=function(n,t){return typeof n!="string"||n===""||!t||!localStorage?!1:f(n,t)},this.writeConfig=function(n,t){if(typeof n!="string"||n===""||!t)return;localStorage&&s(n,t)}},iu=new function(){function i(){r||(r=!0,PRF.end("Module initialized",t,{module:"Map Core"}),st.done(t))}var u=this,n=Microsoft.Maps.Globals,r=!1,t="Microsoft.Maps.Map";this.tryCachedGlobals=function(){var r=!1;return rr.tryLoadConfigIntoObject(rr.GlobalsId,n)&&(r=!0,ii.getObjectAsync(st.getRegistration(t).scriptUrl,u.parse),i()),r},this.parse=function(t){var u,r;if(!t||typeof t.ishttpsenabled=="undefined")return;if(t.jsonTimeStamp&&n.jsonTimeStamp&&t.jsonTimeStamp==n.jsonTimeStamp)return;u=!n.version,t.clientVersion="7.0.20120123200232.91",t.cssPath="///Bing.Maps.JavaScript/css/",t.imagePath="///Bing.Maps.JavaScript/images/",t.jsPath="///Bing.Maps.JavaScript/js/",t.pushpinImageUrl="///Bing.Maps.JavaScript/images/poi_search.png",t.cursorPath="///Bing.Maps.JavaScript/cursors/",t.ddCoreStyles="///Bing.Maps.JavaScript/css/wwamapcontrol.css",t.logServiceUrl&&(t.logServiceUriFormat=t.logServiceUriFormat.replace(t.version,t.clientVersion)),t.protocol=t.ishttpsenabled?"https://":"http://",t.jsonTimeStamp=(new Date).valueOf();for(r in t)typeof t[r]=="string"&&(t[r]=t[r].replace(/{urischeme}/g,t.protocol).replace(/{version}/g,t.version).replace(/{culture}/g,t.locale).replace(/{generation}/g,t.tilegeneration)),u&&(n[r]=t[r]);rr.writeConfig(rr.GlobalsId,t),u&&(n.protocol=t.protocol,i())}},yi=new function(){var n=1e3;this.getNext=function(){return n++}};l.IdGenerator=yi;var ni=new function(){this.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)},this.cloneObject=function(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},this.createElement=function(n,t,i){var r=document.createElement(n||"div");return t&&(r.style.cssText=t),i&&i.appendChild(r),r},this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=function(n){n.stopPropagation()},this.prioritySort=function(n,t){return n.priority-t.priority},this.isArray=function(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},this.extend=function(n,t){function i(){}i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n.baseConstructor=t,n.superClass=t.prototype}},vt=1e-11,ei=ni.isValidNumber,kr=ni.cloneObject,b=ni.createElement,lu=ni.ignoreEvent,uu=ni.stopPropagation,hu=ni.prioritySort,ki=ni.isArray,eu=ni.extend;l.Common=ni,u=new function(){var n=navigator.userAgent,u=n.indexOf("MSIE"),o=n.indexOf("Firefox"),y=n.indexOf("Chrome"),it=o!==-1,p=y!==-1,t=u!==-1,e=parseInt(n.substring(u+5)),tt=t&&e===6,nt=t&&e===9,b=t&&e===10,ft=p&&parseInt(n.substring(y+7))>=11,k=it&&parseInt(n.substring(o+8))>=4,ut=document.documentMode,rt=n.indexOf("Gecko"),s=rt!==-1,l=n.indexOf("Trident/"),h=parseInt(n.substring(l+8)),a=l>0,w=n.indexOf("BlackBerry")!==-1,f=n.indexOf("AppleWebKit")!==-1,i=navigator.vendor==="Apple Computer, Inc."&&!w,v=i&&n.indexOf("iPhone OS 3_")!==-1,d=f&&n.indexOf("Android")!==-1,g=typeof WinJS!==c&&b,r;this.isWebkit=f,this.cursorHotspot=f?" 10 9":"",this.useTransform2d=a&&h>=6,this.useTransform3d=i,this.useTransform3dForTranslate=i,this.useImageDisposer=i,this.isIOSBrowser=n.indexOf("iPhone")!==-1,this.safariRenderHack=i?"-webkit-transform:matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1);":"",this.isIE6=tt,this.isIE9=nt,this.isIE10=b,this.useXHR=g,this.isIOS3=v,r=a&&h>=5,this.isZoomFasterThanMatrixFilter=r,this.useFilterReflowWorkaround=r,this.cssZoomAffectsTopLeft=t&&ut===8,this.animateOverlayLayers=r||ft||k||i,this.animateShapes=this.animateOverlayLayers&&!v,this.canRenderOpacityAndRotationOnSemiTransparentPngs=!(t&&!r),this.scrollAdjustment=p?1.5:1,this.useOnResize=r,this.autoSizesElementsTooSmall=s||f,this.opacityGlitchAtBrowserEdges=s,this.isIE8OrEarlier=t&&parseInt(n.substring(u+5))<9,this.isIE7OrEarlier=t&&parseInt(n.substring(u+5))<8,this.emulateDblClick=w,this.isShapeEventsSupported=function(){return typeof si!="undefined"&&si.isEventsSupported?si.isEventsSupported():!0},this.allowFocus=!d},l.Quirks=u,y=new function(){function o(){r=null,n.length&&u();var i=n;n=t,t=i,t.sort(e);while(t.length)t.shift()()}function e(n,t){return n[i]-t[i]}function u(){r||(r=f(o))}var f=k.Effects.Animation.requestAnimationFrame,r,n=[],t=[],i=bt+"dispatchOrder";this.dispatch=function(t,r){t[i]=r||0;var f=n.length;while(f--)if(n[f]===t)return;n.push(t),u()},this.cancelDispatch=function(i){var r;r=n.length;while(r--)n[r]===i&&n.splice(r,1);r=t.length;while(r--)t[r]===i&&t.splice(r,1)}},l.Dispatcher=y,i.prototype={clone:function(){return new i(this.x,this.y)},toString:function(){return"[Point "+this.x+","+this.y+"]"}},i.clone=function(n){return new i(n.x,n.y)},i.add=function(n,t){return new i(n.x+t.x,n.y+t.y)},i.distance=function(n,t){var r=n.x-t.x,i=n.y-t.y;return Math.sqrt(r*r+i*i)},i.subtract=function(n,t){return new i(n.x-t.x,n.y-t.y)},i.multiply=function(n,t){return new i(n.x*t,n.y*t)},i.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y},h.Point=i,fi={fromTileId:function(n,t){var e=1,i;t&&(e=0);var r="",f=n.x,u=n.y;for(i=0;i<n.levelOfDetail;i++)r=((f&1)+2*(u&1)).toString()+r,f>>=1,u>>=1;return r},toTileId:function(n){var i=0,t=0,u=0,r;if(n!=null&&n.length>0)for(u=n.length,r=0;r<n.length;r++)switch(n.charAt(r)){case"0":i=i*2+0,t=t*2+0;break;case"1":i=i*2+1,t=t*2+0;break;case"2":i=i*2+0,t=t*2+1;break;case"3":i=i*2+1,t=t*2+1}return new g(u,i,t)},wrapX:function(n){var t=1<<n.levelOfDetail;return new g(n.levelOfDetail,(n.x%t+t)%t,n.y)},wrapY:function(n){var t=1<<n.levelOfDetail;return new g(n.levelOfDetail,n.x,(n.y%t+t)%t)},isInBounds:function(n){if(n.x<0||n.y<0)return!1;var t=1<<n.levelOfDetail;return n.x>=t||n.y>=t?!1:!0}},h.QuadKey=fi,pt={ground:0,ellipsoid:1,isValid:function(n){return n===pt.ground||n===pt.ellipsoid}},h.AltitudeReference=pt,a.prototype={clone:function(){return new a(this.latitude,this.longitude,this.altitude,this.altitudeReference)},toString:function(){return"[Location "+this.latitude+","+this.longitude+(this.altitude!==c&&this.altitudeReference!==c?","+this.altitude+","+this.altitudeReference:"")+"]"}},a.normalizeLongitude=function(n){return n<-180||n>180?n-Math.floor((n+180)/360)*360:n},a.areEqual=function(n,t){return n&&t&&n.latitude===t.latitude&&n.longitude===t.longitude&&n.altitude===t.altitude&&n.altitudeReference===t.altitudeReference},h.Location=a,it.prototype={getNorthwest:function(){return new a(this.getNorth(),this.getWest(),this.center.altitude,this.center.altitudeReference)},getSoutheast:function(){return new a(this.getSouth(),this.getEast(),this.center.altitude,this.center.altitudeReference)},getNorth:function(){return this.center.latitude+this.height/2},getSouth:function(){return this.center.latitude-this.height/2},getWest:function(){return this.width>=360?-180:a.normalizeLongitude(this.center.longitude-this.width/2)},getEast:function(){return this.width>=360?180:a.normalizeLongitude(this.center.longitude+this.width/2)},toString:function(){return"[LocationRect "+this.center.toString()+" "+this.width+","+this.height+"]"},clone:function(){return new it(this.center.clone(),this.width,this.height)},contains:function(n){var i=Math.abs(this.center.latitude-n.latitude),t=Math.abs(this.center.longitude-n.longitude);return t>180&&(t=360-t),i<=this.height/2&&t<=this.width/2},intersects:function(n){var i=Math.abs(this.center.latitude-n.center.latitude),t=Math.abs(this.center.longitude-n.center.longitude);return t>180&&(t=360-t),i<=this.height/2+n.height/2&&t<=this.width/2+n.width/2}},it.fromEdges=function(n,t,i,r,u,f){return Math.abs(r-t)>360&&(t=-180,r=180),t=a.normalizeLongitude(t),r=a.normalizeLongitude(r),t>r&&(r+=360),new it(new a((i+n)/2,(t+r)/2,u,f),r-t,n-i)},it.fromCorners=function(n,t){return it.fromEdges(n.latitude,n.longitude,t.latitude,t.longitude,n.altitude,n.altitudeReference)},it.fromLocations=function(){var o=ki(arguments[0])?arguments[0]:arguments,r,u,t,i,s,e,n,f=o.length;while(f--)n=o[f],isFinite(n.latitude)&&isFinite(n.longitude)&&(r=r===c?n.latitude:Math.max(r,n.latitude),u=u===c?n.latitude:Math.min(u,n.latitude),i=i===c?n.longitude:Math.max(i,n.longitude),t=t===c?n.longitude:Math.min(t,n.longitude),isFinite(n.altitude)&&pt.isValid(n.altitudeReference)&&(e=n.altitude,s=n.altitudeReference));return it.fromEdges(r,t,u,i,e,s)},it.fromString=function(n){var f=null,t=n.split(","),e,u,i,r;return t&&t.length==4&&(e=parseFloat(t[0]),u=parseFloat(t[1]),i=parseFloat(t[2]),r=parseFloat(t[3]),f=it.fromEdges(e,u,i,r)),f},h.LocationRect=it,lt={road:"r",aerial:"a",birdseye:"be"},h.MapTypeId=lt,nt={visible:0,hidden:1,isValid:function(n){return n===nt.hidden||n===nt.visible}},h.LabelOverlay=nt,ui={viewport:0,page:1,control:2,isValid:function(n){return n===ui.viewport||n===ui.page||n===ui.control}},h.PixelReference=ui,n=new function(){var t=this,n=bt+"events";this.addHandler=function(t,i,r){var f,u;if(t&&typeof i=="string"&&typeof r=="function")return t[n]=t[n]||{},f=t[n][i]||[],t[n][i]=f,u={target:t,eventName:i,handler:r},f.push(u),u},this.addThrottledHandler=function(n,i,r,u){var f=t.addHandler(n,i,r);return f.throttleInterval=u,f},this.removeHandler=function(i){var e,f,r,u;if(i){e=i.target,f=i.eventName;if(t.hasHandler(e,f)){r=e[n][f],u=r.length;while(u--)i===r[u]&&(i.willBeInvokedBy&&window.clearInterval(i.willBeInvokedBy),r.splice(u,1))}}},this.hasHandler=function(t,i){return t&&t[n]&&t[n][i]&&t[n][i].length},this.invoke=function(i,r,u){var e;if(t.hasHandler(i,r)){var o=new Date,s=i[n][r],h=s.length,f;while(h--)f=s[h],f.handler&&(f.throttleInterval?f.willBeInvokedBy?f.willBeInvokedWithArgs=u:(e=f.throttleInterval-(o-(f.lastInvokedAt||new Date(0))),e>0?(f.willBeInvokedWithArgs=u,f.willBeInvokedBy=window.setTimeout(function(){var n=f;return function(){var t=n.willBeInvokedWithArgs;delete n.willBeInvokedBy,delete n.willBeInvokedWithArgs,n.lastInvokedAt=new Date,n.handler&&n.handler(t)}}(),e)):(f.lastInvokedAt=o,f.handler(u))):f.handler(u))}}},h.Events=n,l.ElementSizeHelper=dr,er={singleByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},twoByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t},encodeUrl:function(n){var t,u,i,r;if(!n)return"";for(u=n.length,i=new Array(u),r=0;r<u;++r)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||t==46||t==45||t==95?i.push(String.fromCharCode(t)):t>127?(i.push("%u"),i.push(er.twoByteHex(t))):(i.push("%"),i.push(er.singleByteHex(t)));return i.join("")}},l.IOSec=er,vi=[],gi.getAllInstances=function(){return vi},gi.getVersion=function(){return t.version},h.Map=gi,l.MapType=oi,ii=new function(){function o(i,r,u){y.dispatch(function(){i&&!r&&(r=t);if(r){var e=n[r];e&&(delete n[r],e.timeoutId&&window.clearTimeout(e.timeoutId),e.callback(i,{requestId:r,success:u===200?!0:!1,userData:e.userData,httpStatus:u}),f(e.elScript))}})}function u(t){if(t){var i=n[t];i&&(delete n[t],i.callback(null,{requestId:t,success:!1,userData:i.userData}),f(i.elScript))}}function l(n,t){function i(n,i){o(n,t,i)}Microsoft.Maps.Gimme.Ajax.request_json(n,i)}function i(n,t){l(n,t)}function c(n,t,i){var u,r;return u=s(),u?(r=document.createElement("link"),r.rel=t?"alternate stylesheet":"stylesheet",i&&(r.media=i),r.type="text/css",r.rev="stylesheet",r.href=n,u.appendChild(r),r):void 0}function s(){if(!r){var n=document.getElementsByTagName("head");n.length>0&&(r=n[0])}return r}function h(n,t,i){function r(n){t(n,i)}Microsoft.Maps.Gimme.Ajax.request_json(n,r)}function f(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))}var v=this,e=5e3,r,a=1,t,n={};window.microsoftMapsNetworkCallback=o,this.downloadScript=function(n){return i(n)},this.downloadStyles=function(n,t,i){c(n,t,i)},this.getObjectAsync=function(t,r,f,o,s){var h=s;return h||(h="r"+ ++a,t=t.replace("{jsono}",h)),typeof o=="number"&&o>0||(o=e),n[h]={callback:r,userData:f,elScript:i(t,h),timeoutId:window.setTimeout(function(){u(h)},o)},h},this.getObjectAsyncWithNoJsonso=function(r,f,o,s){t="_logCallbackRequest",typeof s=="number"&&s>0||(s=e),n[t]={callback:f,userData:o,elScript:i(r,t),timeoutId:window.setTimeout(function(){u(t)},s)}},this.isRequestCompleted=function(t){return n[t]?!1:!0},this.abortRequest=function(t){n[t]&&delete n[t]},this.getObjectAsyncCacheFriendly=function(n,t,i){h(n,t,i)}},l.Network=ii,ti={map:"map",pushpin:"pushpin",polyline:"polyline",polygon:"polygon",infobox:"infobox"},hi.prototype={handled:!1,toString:function(){return"[MouseEventArgs]"}},l.MouseEventArgs=hi,br.prototype={handled:!1,toString:function(){return"[KeyEventArgs]"}},et.prototype={clone:function(){return new et(this.a,this.r,this.g,this.b)},getOpacity:function(){return isFinite(this.a)?this.a/255:1},toHex:function(){var i=this.r,t=this.g,n=this.b;return"#"+(i<16?"0":"")+Number(i).toString(16)+(t<16?"0":"")+Number(t).toString(16)+(n<16?"0":"")+Number(n).toString(16)},toString:function(){return"[Color "+this.toHex()+"]"}},et.clone=function(n){return new et(n.a,n.r,n.g,n.b)},et.fromHex=function(n){var i=null,t=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return t&&t.length==4&&(i=new et(255,parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16))),i},h.Color=et,ai.prototype={_visible:!0,_zIndex:null,setOptions:function(t,i){var r=!1;return t&&(typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.zIndex!="undefined"&&(this._zIndex=t.zIndex,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[EntityCollection]"}},h.EntityCollection=ai,di={standard:"Infobox",mini:"MiniInfobox2",expanded:"Infobox2"},h.InfoboxType=di,pr.prototype={_width:256,_height:126,_showCloseButton:!0,_offset:new i(0,0),_htmlContent:null,_id:null,_typeName:di.standard,_visible:!0,_zIndex:null,_options:null,_calculatedSize:null,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setCalculatedSize:function(n){this._calculatedSize=n},measure:function(){return this._calculatedSize||{width:0,height:0}},setOptions:function(t,r){if(t){var u=!1;this._options=t,(t.width>0||t.width===null)&&(this._width=t.width,u=!0),(t.height>0||t.height===null)&&(this._height=t.height,u=!0),typeof t.showCloseButton=="boolean"&&(this._showCloseButton=t.showCloseButton,u=!0),t.offset&&(this._offset=i.clone(t.offset),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0)}return u&&(r===null||!r)&&n.invoke(this,"entitychanged",{entity:this}),u},getWidth:function(){return this._width},getHeight:function(){return this._height},getShowCloseButton:function(){return this._showCloseButton},getOffset:function(){return this._offset},getOptions:function(){return this._options},setHtmlContent:function(t){var i=this._htmlContent!=t;this._htmlContent=t,this._showPointer=!1,i&&n.invoke(this,"entitychanged",{entity:this})},getHtmlContent:function(){return this._htmlContent},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[InfoboxBase]"}},eu(d,pr),h.Infobox=d,d.prototype._title=null,d.prototype._titleAction=null,d.prototype._description=null,d.prototype._titleClickHandler=null,d.prototype._showPointer=!0,d.prototype._actions=[],d.prototype.setOptions=function(t,i){if(t){var r=d.superClass.setOptions.call(this,t,!1);typeof t.title=="string"&&(this._title=t.title,r=!0),typeof t.description=="string"&&(this._description=t.description,r=!0),typeof t.showPointer=="boolean"&&(this._showPointer=t.showPointer,r=!0),typeof t.actions=="object"&&(this._actions=t.actions,r=!0),typeof t.titleAction=="object"&&(this._titleAction=t.titleAction,r=!0),typeof t.titleClickHandler=="function"&&(this._titleClickHandler=t.titleClickHandler,r=!0),(this._typeName===di.mini||typeof this._htmlContent=="string")&&(this._showPointer=!1),r&&(i===null||!i)&&n.invoke(this,"entitychanged",{entity:this})}},d.prototype.getActions=function(){return this._actions},d.prototype.getTitle=function(){return this._title},d.prototype.getTitleAction=function(){return this._titleAction},d.prototype.getTitleClickHandler=function(){return this._titleClickHandler},d.prototype.getDescription=function(){return this._description},d.prototype.getShowPointer=function(){return this._showPointer},d.prototype.getAnchor=function(){var n,t=this._calculatedSize&&this._calculatedSize.height||0,r;return this._showPointer?this._typeName!==di.standard?(n=10,new i(20+n/2,t)):(n=28,r=38,new i(20+n/2,this.getHeight()+r)):t!==0?new i(0,t):new i(0,this.getHeight()||0)},d.prototype.getOptions=function(){return d.superClass.getOptions.call(this)},d.prototype.toString=function(){return"[Infobox]"},nr.prototype={_width:25,_height:39,_draggable:!1,_anchor:null,_calculatedAnchor:new i(13,39),_text:null,_textOffset:new i(0,5),_id:null,_typeName:null,_visible:!0,_zIndex:null,_useTransform3d:!0,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setOptions:function(t){if(t){var r=!1;typeof t.icon=="string"&&(this._icon=t.icon,r=!0),t.width!==c&&(this._width=t.width>0?t.width:0,r=!0),t.height!==c&&(this._height=t.height>0?t.height:0,r=!0),typeof t.draggable=="boolean"&&(this._draggable=t.draggable,r=!0),t.anchor&&(this._anchor=i.clone(t.anchor),r=!0),typeof t.text=="string"&&(this._text=t.text,r=!0),t.textOffset&&(this._textOffset=i.clone(t.textOffset),r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,r=!0),r&&(this._calculatedAnchor=this._anchor?this._anchor:new i(Math.ceil(this._width/2),this._height),n.invoke(this,"entitychanged",{entity:this}))}},getIcon:function(){return this._icon},getWidth:function(){return this._width},getHeight:function(){return this._height},getDraggable:function(){return this._draggable},getAnchor:function(){return this._calculatedAnchor},getText:function(){return this._text},getTextOffset:function(){return this._textOffset},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getUseTransform3d:function(){return this._useTransform3d},toString:function(){return"[Pushpin]"}},h.Pushpin=nr,wi.prototype={_strokeColor:new et(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_visible:!0,_id:null,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t){if(t){var i=!1;t.strokeColor&&(this._strokeColor=et.clone(t.strokeColor),i=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,i=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,i=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,i=!0),typeof t.id=="string"&&(this._id=t.id,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getVisible:function(){return this._visible},getId:function(){return this._id},toString:function(){return"[Polyline]"}},h.Polyline=wi,tr.prototype={_strokeColor:new et(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_fillColor:new et(255,0,0,255),_visible:!0,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t){if(t){var i=!1;t.strokeColor&&(this._strokeColor=et.clone(t.strokeColor),i=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,i=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,i=!0),t.fillColor&&(this._fillColor=et.clone(t.fillColor),i=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getFillColor:function(){return this._fillColor},getVisible:function(){return this._visible},toString:function(){return"[Polygon]"}},h.Polygon=tr,or={show:"s",hide:"h",auto:"a"},ur.prototype={toString:function(){return"[TileLayer]"}},h.AnimationVisibility=or,h.TileLayer=ur,sr.prototype={toString:function(){return"[TileSource]"}},h.TileSource=sr,h.Globals.disableGeoLocation||(tu=function(n){function b(n,i,r){if(t&&r===t&&n&&n.coords){var u=new a(n.coords.latitude,n.coords.longitude,n.coords.altitude);(!i||i&&i.showAccuracyCircle!=!1)&&f.addAccuracyCircle(u,n.coords.accuracy,v,{displayOnMap:!0}),(!i||i&&i.updateMapView!=!1)&&l(n),i&&i.successCallback&&i.successCallback({center:u,position:n})}t=0}function c(n,i,r){t&&r===t&&i.errorCallback&&i.errorCallback({internalError:n,errorCode:n.code}),t=0}function l(t){if(t)if(t.coords.accuracy<300)n.setView({center:new a(t.coords.latitude,t.coords.longitude,t.coords.altitude),zoom:16});else{var o=e(t.coords.latitude,t.coords.longitude,0,t.coords.accuracy),u=(o.latitude-t.coords.latitude)*2,i=n.getHeight(),r=n.getWidth(),f=i>r?i:r;n.setView({bounds:new it(new a(t.coords.latitude,t.coords.longitude,t.coords.altitude),u,u),padding:f/3})}}function e(n,t,u,f){var v=o,k=v.degreesToRadians(u),p=(1-r)*Math.tan(v.degreesToRadians(n)),it=Math.cos(k),et=Math.sin(k),y=1/Math.sqrt(1+p*p),rt=y*et,ht=rt*rt,tt=1-ht,ut=Math.atan2(p,Math.cos(k)),l=tt*((s*s-i*i)/(i*i)),st=1+l/16384*(4096+l*(-768+l*(320-175*l))),ft=l/1024*(256+l*(-128+l*(74-47*l))),e=f/(i*st),ct=2*Math.PI,h=Math.sin(e),nt=2*ut+e,c=Math.cos(nt),d;while(Math.abs(e-ct)>1e-12){nt=2*ut+e,c=Math.cos(nt),d=c*c,h=Math.sin(e);var wt=Math.cos(e)*(-1+2*d),pt=ft/6*c*(-3+4*h*h)*(-3+4*d),kt=ft*h*(c+ft/4*(wt-pt));ct=e,e=f/(i*st)+kt}c=Math.cos(2*ut+e),h=Math.sin(e);var w=Math.cos(e),b=p*y,ot=b*h-y*w*it,bt=Math.atan2(b*w+y*h*it,(1-r)*Math.sqrt(ht+ot*ot)),yt=Math.atan2(h*et,y*w-b*h*it),g=r/16*tt*(4+r*(4-3*tt)),vt=e+g*h*(c+g*w*(-1+2*c*c)),at=yt-(1-g)*r*rt*vt,lt=(v.degreesToRadians(t)+at+3*Math.PI)%(2*Math.PI)-Math.PI;return new a(v.radiansToDegrees(bt),v.radiansToDegrees(lt))}var u=null,v=128,w=new et(150,0,163,239),y=new et(25,0,163,239),t=0,h=navigator&&navigator.geolocation,f=this,s=p.earthRadiusInMeters,i=p.earthMinorAxisRadiusInMeters,r=p.flatteningOfEllipsoidWGS84;this.getCurrentPosition=function(n){f.removeAccuracyCircle();if(h&&t===0)t=Math.random(),navigator.geolocation.getCurrentPosition(function(i){b(i,n,t)},function(i){c(i,n,t)},n);else if(n&&n.errorCallback){var i=h?4:5;n.errorCallback({internalError:null,errorCode:i})}},this.cancelCurrentRequest=function(){t=0},this.addAccuracyCircle=function(t,i,r,o){var c=null,s,d,l,p,v;if(t&&r&&i&&t instanceof a&&ei(r)&&ei(i)){var h=[],b=t.latitude,k=t.longitude;for(s=0;s<r;s++)d=s/r*360,l=e(b,k,d,i),h.push(l);p=e(b,k,0,i),h.push(p),v=o.polygonOptions||{fillColor:y,strokeColor:w},c=new tr(h,v),o&&o.displayOnMap!=!1&&(f.removeAccuracyCircle(),u=c,n.entities.push(u))}return c},this.removeAccuracyCircle=function(){u&&(n.entities.remove(u),u=null)}},h.GeoLocationProvider=tu),l.DelayMap=gr,st=new function(){function i(i,r){var u=n[i],o,e,f;if(u){o=u.downloadScript,u.downloadScript=!1;if(u.loaded)t(i,r);else{r&&u.queue.push(r);if(o&&u.loadOverrideCallback(i)!==!0)for(h.InternalNamespaceForDelay=l,u.jsonDownloadCallback?ii.getObjectAsync(u.scriptUrl,u.jsonDownloadCallback):ii.downloadScript(u.scriptUrl),e=u.styleUrls,f=0;f<e.length;f++)e[f]&&ii.downloadStyles(e[f])}}}function t(n,t){typeof t.callback=="function"?t.callback(n):t.obj&&t.obj[t.name].apply(t.obj,t.args)}var n={};this.register=function(t,i,r){var u=r?r:{};n[t]={key:t,downloadScript:!0,loaded:!1,queue:[],scriptUrl:i,styleUrls:u.styleUrls?u.styleUrls:[],jsonDownloadCallback:typeof u.jsonDownloadCallback=="function"?u.jsonDownloadCallback:null,loadOverrideCallback:typeof u.loadOverrideCallback=="function"?u.loadOverrideCallback:function(){return!1}}},this.add=function(n,t,r,u){i(n,t?{obj:t,name:r,args:u}:null)},this.load=function(n,t){PRF.start(n),i(n,t&&typeof t.callback=="function"?{callback:t.callback}:null)},this.getRegistration=function(t){return n[t]},this.done=function(i){var f=n[i],e,r,s,u,o;if(f){for(f.loaded=!0,e=f.queue,r=0;r<e.length;r++)s=e[r],t(i,s);u=0;for(o in n)n.hasOwnProperty(o)&&++u;u===0&&delete h.InternalNamespaceForDelay}}},h.loadModule=st.load,h.registerModule=st.register,h.moduleLoaded=st.done,l.Dynamic=st,h.Globals.disableDirections===!1&&st.register("Microsoft.Maps.Directions",t.ddDirectionsJs,{styleUrls:[t.ddDirectionsCss]}),h.Globals.disableStreetside===!1&&st.register("Microsoft.Maps.Streetside",t.ddStreetsideControl,{styleUrls:[t.ddStreetsideStyles]}),h.Globals.disableVenueMaps===!1&&st.register("Microsoft.Maps.VenueMaps",t.ddVenueMaps),h.Globals.disableMicroPOI===!1&&st.register("Microsoft.Maps.MicroPOI",t.ddMicroPOI,{styleUrls:[t.ddMicroPOICss]}),h.Globals.disableAnalytics===!1&&st.register("Microsoft.Maps.Analytics",t.ddAnalyticsJs),h.Globals.disableSearch===!1&&st.register("Microsoft.Maps.Search",t.ddSearchJs,{styleUrls:[t.ddSearchCss]}),h.Globals.jsonTimeStamp&&(nu="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0wwa&type=json",st.register("Microsoft.Maps.Map",nu,{jsonDownloadCallback:iu.parse,loadOverrideCallback:iu.tryCachedGlobals})),o={LOGE2:Math.log(2),ILOGE2:1/Math.log(2),degreesPerRadian:180/Math.PI,radiansPerDegree:Math.PI/180,log2:function(n){return Math.log(n)/o.LOGE2},ceilLog2:function(n){return Math.ceil(Math.log(n)*o.ILOGE2)},lerpDouble:function(n,t,i){return n+i*(t-n)},normalizeDegrees:function(n){return(n%360+360)%360},distanceDegrees:function(n,t){var i=o.normalizeDegrees(n-t);return Math.min(i,360-i)},lerpAngle:function(n,t,i){var r=o.normalizeDegrees(n-t);return r>180&&(r=r-360),t+(1-i)*r},degreesToRadians:function(n){return n*o.radiansPerDegree},radiansToDegrees:function(n){return n*o.degreesPerRadian}},l.VectorMath=o,r.prototype={normalize:function(){var t=this.getLength(),n;return t===0?point:(n=1/t,new r(this.x*n,this.y*n,this.z*n))},isZero:function(){return this.x===0&&this.y===0&&this.z===0},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},toPoint:function(){return new i(this.x,this.y)},clone:function(){return new r(this.x,this.y,this.z)},toString:function(){return"[Point3D "+this.x+","+this.y+","+this.z+"]"}},r.add=function(n,t){return new r(n.x+t.x,n.y+t.y,n.z+t.z)},r.subtract=function(n,t){return new r(n.x-t.x,n.y-t.y,n.z-t.z)},r.multiply=function(n,t){return new r(t*n.x,t*n.y,t*n.z)},r.dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},r.cross=function(n,t){return new r(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z,n.x*t.y-n.y*t.x)},r.distanceSquared=function(n,t){var u=n.x-t.x,r=n.y-t.y,i=n.z-t.z;return u*u+r*r+i*i},r.lerp=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i,n.z+(t.z-n.z)*i)},r.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y&&n.z===t.z},r.areAlmostEqual=function(n,t){return n&&t&&Math.abs(n.x-t.x)<vt&&Math.abs(n.y-t.y)<vt&&Math.abs(n.z-t.z)<vt},l.Point3D=r,ot.prototype={clone:function(){return new ot(this.width,this.height)},toString:function(){return"[Size "+this.width+","+this.height+"]"}},ot.clone=function(n){return new ot(n.width,n.height)},ot.areEqual=function(n,t){return n&&t&&n.width===t.width&&n.height===t.height},l.Size=ot,ht.prototype={getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenter:function(){return new i(this.x+this.width/2,this.y+this.height/2)},contains:function(n){return n.x>=this.x&&n.y>=this.y&&n.x<=this.getRight()&&n.y<=this.getBottom()},clone:function(){return new ht(this.x,this.y,this.width,this.height)},toString:function(){return"[Rect "+this.x+","+this.y+" "+this.width+","+this.height+"]"}},ht.union=function(){var u=ki(arguments[0])?arguments[0]:arguments,t=u[0],r=t.x,i=t.y,e=t.x+(t.width?t.width:0),f=t.y+(t.height?t.height:0),o=u.length,n;while(o--)n=u[o],r=Math.min(r,n.x),i=Math.min(i,n.y),e=Math.max(e,n.x+(n.width?n.width:0)),f=Math.max(f,n.y+(n.height?n.height:0));return new ht(r,i,e-r,f-i)},ht.intersect=function(n,t){return!(n.getRight()<t.x||t.getRight()<n.x||n.getBottom()<t.y||t.getBottom()<n.y)},ht.areEqual=function(n,t){return},l.Rect=ht,ct.prototype={transform:function(n){return new i(n.x*this.m11+n.y*this.m21+this.offsetX,n.x*this.m12+n.y*this.m22+this.offsetY)},invert:function(){var n=this.m11*this.m22-this.m12*this.m21;if(n===0)throw"matrix cannot be inverted";return new ct(this.m22/n,-1*this.m12/n,-1*this.m21/n,this.m11/n,(this.offsetY*this.m21-this.offsetX*this.m22)/n,(this.offsetX*this.m12-this.offsetY*this.m11)/n)},clone:function(){return new ct(this.m11,this.m12,this.m21,this.m22,this.offsetX,this.offsetY)},toString:function(){return"[Matrix "+this.m11+", "+this.m12+", "+this.m21+", "+this.m22+", "+this.offsetX+", "+this.offsetY+"]"}},ct.multiply=function(n,t){return new ct(n.m11*t.m11+n.m12*t.m21,n.m11*t.m12+n.m12*t.m22,n.m21*t.m11+n.m22*t.m21,n.m21*t.m12+n.m22*t.m22,n.offsetX*t.m11+n.offsetY*t.m21+t.offsetX,n.offsetX*t.m12+n.offsetY*t.m22+t.offsetY)},ct.unitToPoints=function(n,t,i){return new ct(t.x-n.x,t.y-n.y,i.x-n.x,i.y-n.y,n.x,n.y)},ct.conversion=function(n,t,i,r,u,f){var o=ct.unitToPoints(n,t,i).invert(),e=ct.unitToPoints(r,u,f);return ct.multiply(o,e)},l.Matrix=ct,e.prototype={multiplyBy:function(n){var l=this.m11,a=this.m12,h=this.m13,c=this.m14,p=this.m21,w=this.m22,v=this.m23,y=this.m24,r=this.m31,u=this.m32,t=this.m33,i=this.m34,o=this.offsetX,s=this.offsetY,f=this.offsetZ,e=this.m44;this.m11=l*n.m11+a*n.m21+h*n.m31+c*n.offsetX,this.m12=l*n.m12+a*n.m22+h*n.m32+c*n.offsetY,this.m13=l*n.m13+a*n.m23+h*n.m33+c*n.offsetZ,this.m14=l*n.m14+a*n.m24+h*n.m34+c*n.m44,this.m21=p*n.m11+w*n.m21+v*n.m31+y*n.offsetX,this.m22=p*n.m12+w*n.m22+v*n.m32+y*n.offsetY,this.m23=p*n.m13+w*n.m23+v*n.m33+y*n.offsetZ,this.m24=p*n.m14+w*n.m24+v*n.m34+y*n.m44,this.m31=r*n.m11+u*n.m21+t*n.m31+i*n.offsetX,this.m32=r*n.m12+u*n.m22+t*n.m32+i*n.offsetY,this.m33=r*n.m13+u*n.m23+t*n.m33+i*n.offsetZ,this.m34=r*n.m14+u*n.m24+t*n.m34+i*n.m44,this.offsetX=o*n.m11+s*n.m21+f*n.m31+e*n.offsetX,this.offsetY=o*n.m12+s*n.m22+f*n.m32+e*n.offsetY,this.offsetZ=o*n.m13+s*n.m23+f*n.m33+e*n.offsetZ,this.m44=o*n.m14+s*n.m24+f*n.m34+e*n.m44},transform:function(n,t){var u=n.x*this.m11+n.y*this.m21+this.offsetX,e=n.x*this.m12+n.y*this.m22+this.offsetY,f=n.x*this.m13+n.y*this.m23+this.offsetZ,i;return n.z&&(u+=n.z*this.m31,e+=n.z*this.m32,f+=n.z*this.m33),(this.m14!==0||this.m24!==0||this.m34!==0||this.m44!==1)&&(i=n.x*this.m14+n.y*this.m24+(n.z?n.z:0)*this.m34+this.m44,t&&(i=Math.max(t,i)),u/=i,e/=i,f/=i),new r(u,e,f)},invert:function(){var c=this.m11,p=this.m12,w=this.m13,v=this.m14,h=this.m21,a=this.m22,b=this.m23,y=this.m24,l=this.m31,g=this.m32,d=this.m33,k=this.m34,s=this.offsetX,it=this.offsetY,tt=this.offsetZ,nt=this.m44,r=w*y-b*v,i=w*k-d*v,t=w*nt-tt*v,o=b*k-d*y,f=b*nt-tt*y,u=d*nt-tt*k,et=a*i-g*r-p*o,ut=p*f-a*t+it*r,ot=g*t-it*i-p*u,ft=a*u-g*f+it*o,rt=s*et+l*ut+h*ot+c*ft;if(rt===0||!isFinite(rt))throw"InvalidOperation: Matrix3D.invert";var wt=c*o-h*i+l*r,lt=h*t-s*r-c*f,pt=c*u-l*t+s*i,yt=l*f-s*o-h*u;r=c*a-h*p,i=c*g-l*p,t=c*it-s*p,o=h*g-l*a,f=h*it-s*a,u=l*it-s*g;var dt=w*o-b*i+d*r,kt=b*t-tt*r-w*f,bt=w*u-d*t+tt*i,ct=d*f-tt*o-b*u,ht=y*i-k*r-v*o,st=v*f-y*t+nt*r,vt=k*t-nt*i-v*u,at=y*u-k*f+nt*o,n=1/rt;return new e(ft*n,ot*n,ut*n,et*n,yt*n,pt*n,lt*n,wt*n,at*n,vt*n,st*n,ht*n,ct*n,bt*n,kt*n,dt*n)},projectOnPlane:function(n){var t=this,o=n.a*t.m11+n.b*t.m12+n.c*t.m13-n.d*t.m14,f=n.a*t.m21+n.b*t.m22+n.c*t.m23-n.d*t.m24,r=n.a*t.m31+n.b*t.m32+n.c*t.m33-n.d*t.m34,s=n.a*t.offsetX+n.b*t.offsetY+n.c*t.offsetZ-n.d*t.m44,i,u;if(r===0)throw"InvalidOperation: Matrix3D.projectOnPlane";return i=-1/r,u=new e(1,0,o*i,0,0,1,f*i,0,0,0,1,0,0,0,s*i,1),e.multiply(u,this)},clone:function(){return new e(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.offsetX,this.offsetY,this.offsetZ,this.m44)},toString:function(){return"[Matrix3D "+this.m11+","+this.m12+","+this.m13+","+this.m14+", "+this.m21+","+this.m22+","+this.m23+","+this.m24+", "+this.m31+","+this.m32+","+this.m33+","+this.m34+", "+this.offsetX+","+this.offsetY+","+this.offsetZ+","+this.m44+"]"}},e.multiply=function(){for(var u=arguments.length,r=arguments[0].clone(),i=1;i<u;i++)r.multiplyBy(arguments[i]);return r},e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.translation=function(n){var t=arguments.length==3;return new e(1,0,0,0,0,1,0,0,0,0,1,0,t?arguments[0]:n.x,t?arguments[1]:n.y,t?arguments[2]:n.z,1)},e.scaling=function(n,t,i){var r=new e(n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return arguments.length==3&&(r.m22=t,r.m33=i),r},e.rotationX=function(n){var r=n*o.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1)},e.rotationY=function(n){var r=n*o.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1)},e.rotationZ=function(n){var r=n*o.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1)},l.Matrix3D=e,kt.prototype={intersectWithLine:function(n,t){var i=r.subtract(t,n),f=this.d-this.a*n.x-this.b*n.y-this.c*n.z,u=this.a*i.x+this.b*i.y+this.c*i.z;if(u===0)throw"InvalidOperation: Plane3D.intersectWithLine";return r.add(n,r.multiply(i,f/u))},clone:function(){return new kt(this.a,this.b,this.c,this.d)},toString:function(){return"[Plane3D]"}},kt.fromPoints=function(n,t,i){var f=r.subtract(i,t),e=r.subtract(t,n),u=r.cross(f,e);return u=u.normalize(),kt.fromNormal(n,u)},kt.fromNormal=function(n,t){return new kt(t.x,t.y,t.z,r.dot(t,n))},kt.areEqual=function(n,t){return n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d},l.Plane3D=kt,wt.prototype={dot:function(n){return this.x*n.x+this.y*n.y},perp:function(){return new wt(this.y,-this.x)},normalize:function(){var t,n;return t=this.length(),t<MathHelper.zeroTolerance?new wt(0,0):(n=1/t,new wt(this.x*n,this.y*n))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},add:function(n){return new wt(this.x+n.x,this.y+n.y)},subtract:function(n){return new wt(this.x-n.x,this.y-n.y)},multiplyScalar:function(n){return new wt(this.x*n,this.y*n)},equals:function(n){return this.x===n.x&&this.y===n.y},toString:function(){return"["+this.x+", "+this.y+"]"}},l.Vector2=wt,p={earthRadiusInMeters:6378137,earthCircumferenceInMeters:12756274*Math.PI,northUpHeading:0,eastUpHeading:90,southUpHeading:180,westUpHeading:270,enhancedBirdseyePitch:-o.degreesPerRadian*Math.asin(180/256),earthMinorAxisRadiusInMeters:6356752.3142,flatteningOfEllipsoidWGS84:1/298.2572235631,snapToCardinalHeading:function(n){var t=Math.round(n/90);return t=(t%4+4)%4,t*90},locationRectToMercatorZoom:function(n,i){var f=Math.abs(i.getWest()-i.getEast())/360,u=Math.abs(s.latitudeToY(i.getNorth())-s.latitudeToY(i.getSouth())),r=Math.min(n.width/(t.zoomOriginWidth*f),n.height/(t.zoomOriginWidth*u));return o.log2(r)},getMercatorCenter:function(n){var t=n.center;return new a(s.yToLatitude((s.latitudeToY(n.getNorth())+s.latitudeToY(n.getSouth()))/2),t.longitude,t.altitude,t.altitudeReference)},getMercatorFootprint:function(n,t){var f=t.width/2,u=t.height/2,r=[new i(-f,-u),new i(f,-u),new i(f,u),new i(-f,u)],c=n.getViewportToWorld(),h=n.getCrs(),e,o=r.length;while(o--)e=c.transform(r[o]),r[o]=h===s?e:s.fromLocation(h.toLocation(e));return r}},l.MapMath=p,s={latitudeLimit:85.051128,invFourPi:1/(4*Math.PI),unitsPerMeterAtEquator:1/p.earthCircumferenceInMeters,toLocation:function(n){var t=s.yToLatitude(n.y);return new a(t,(n.x-.5)*360,n.z?s.unitsToMetersAtLatitude(t,n.z):0,pt.ellipsoid)},fromLocation:function(n){return new r(n.longitude/360+.5,s.latitudeToY(n.latitude),s.metersToUnitsAtLatitude(n.latitude,n.altitude))},wrap:function(n,t){var i=n.x,u=t?t.x:.5;return new r(i<u-.5||i>u+.5?i-Math.floor(i-u+.5):i,n.y,n.z)},getUpVector:function(){return new r(0,0,1)},getNadirMatrix:function(n){return new e(1,0,0,0,0,1,0,0,0,0,-1,0,-n.x,-n.y,n.z,1)},unitsToMeters:function(n,t){var i=s.yToLatitude(n.y);return s.unitsToMetersAtLatitude(i,t)},metersToUnits:function(n,t){var i=s.yToLatitude(n.y);return s.metersToUnitsAtLatitude(i,t)},changeAltitude:function(n,t){var u=s.yToLatitude(n.y),i=s.metersToUnitsAtLatitude(u,t);return new r(n.x,n.y,i)},unitsToMetersAtLatitude:function(n,t){return t===0?0:t*Math.cos(n*o.radiansPerDegree)/s.unitsPerMeterAtEquator},metersToUnitsAtLatitude:function(n,t){return t===0?0:t*s.unitsPerMeterAtEquator/Math.cos(n*o.radiansPerDegree)},yToLatitude:function(n){return 90-2*Math.atan(Math.exp((n*2-1)*Math.PI))*o.degreesPerRadian},latitudeToY:function(n){if(n>=s.latitudeLimit)return 0;if(n<=-s.latitudeLimit)return 1;var t=Math.sin(n*o.radiansPerDegree);return.5-Math.log((1+t)/(1-t))*this.invFourPi}},l.MercatorCube=s,bi=new function(){var t=1/298.257222101,i=t*(2-t),f=1/(1-i),n=p.earthRadiusInMeters,u=new r(0,0,-n);this.toLocation=function(r){var w=r.x,p=r.y,s=r.z,b,d,e,y,v,h,l=Math.sqrt(w*w+p*p),f=s,u,c,k;d=Math.atan2(p,w),u=l*(1-t),c=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),y=f*c,v=u*c,h=n,e=l>1?l/v-h:s>0?s-n*(1-t):-s-n*(1-t),k=3;while(k--)u=l*(1-i*h/(h+e)),c=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),y=f*c,v=u*c,h=n/Math.sqrt(1-i*y*y),e=l>1?l/v-h:s>0?s-n*(1-t):-s-n*(1-t);return new a(b*o.degreesPerRadian,d*o.degreesPerRadian,e,pt.ellipsoid)},this.fromLocation=function(t){var s=t.latitude*o.radiansPerDegree,c=t.longitude*o.radiansPerDegree,e=t.altitude,u=Math.sin(s),h=Math.cos(s),l=Math.sin(c),a=Math.cos(c),f=n/Math.sqrt(1-i*u*u);return new r((f+e)*h*a,(f+e)*h*l,(f*(1-i)+e)*u)},this.wrap=function(){return wrap.clone()},this.getUpVector=function(n){return new r(n.x,n.y,n.z*f).normalize()},this.getNadirMatrix=function(n){var t,f=this.getUpVector(n),o=r.multiply(f,-1),s=r.cross(f,r.subtract(u,n)),i;return t=s.isZero()?new r(1,0,0):r.cross(s,f).normalize(),i=r.cross(f,t),e.multiply(e.translation(-n.x,-n.y,-n.z),new e(i.x,t.x,o.x,0,i.y,t.y,o.y,0,i.z,t.z,o.z,0,0,0,0,1))},this.unitsToMeters=function(n,t){return t},this.metersToUnits=function(n,t){return t},this.changeAltitude=function(n,t){var i=self.toLocation(n);return i.altitude=t,self.fromLocation(i)}},g.prototype={getParent:function(){return new g(this.levelOfDetail-1,Math.floor(this.x/2),Math.floor(this.y/2))},clone:function(){return new g(this.levelOfDetail,this.x,this.y)},getSibling:function(n,t){var r=1<<this.levelOfDetail,u=this.x+n,i;return u<0?u+=r:u<r||(u-=r),i=this.y+t,i<0?i=0:i<r||(i=r-1),new g(this.levelOfDetail,u,i)},toString:function(){return"[TileId "+this.levelOfDetail+" "+this.x+","+this.y+"]"}},g.areEqual=function(n,t){return n&&t&&n.levelOfDetail===t.levelOfDetail&&n.x===t.x&&n.y===t.y},l.TileId=g,f.prototype={convertCoordinateReferenceSystem:function(n){if(n!==this.getCrs()){var t=n.fromLocation(this.getCrs().toLocation(this.getLookAt()));return new f(n,t,n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),this.getWidth())),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse()<vt?0:1/n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),1/this.getDistanceInverse())),c,c,this.getZoomOriginWidth())}return this.clone()},clone:function(){return new f(this.getCrs(),this.getLookAt().clone(),this.getWidth(),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse(),this.getZoomDelta(),this.getPerspectiveOrigin().clone(),this.getZoomOriginWidth())},toString:function(){return"[MapCamera]"}},f.smallWidthRatioDiff=.1,f.smallAngle=1,f.smallPixelDistance=2,f.simpleGround=new kt(0,0,1,0),f.simpleWorldToFrustumNoZ=e.identity(),f.fromDirectionVector=function(n,t,i,u,s,h){var y,a;var p=n.getNadirMatrix(t),l=p.transform(r.add(t,u)).normalize(),c=0;(l.x!==0||l.y!==0)&&(directionXY=new r(l.x,l.y,0).normalize(),c=Math.acos(r.dot(directionXY,new r(0,-1,0)))*o.degreesPerRadian,directionXY.x<0&&(c=360-c));var w=(Math.PI/2-Math.acos(r.dot(l,new r(0,0,-1))))*o.degreesPerRadian,a=0,b=e.multiply(p,e.rotationZ(-c),e.rotationX(-(w+90))),v=b.transform(r.add(t,s));return(v.x!=0||v.y!=0)&&(y=new r(v.x,v.y,0).normalize(),a=Math.acos(r.dot(y,new r(0,-1,0)))*o.degreesPerRadian,y.x<0&&(a=360-a)),new f(n,t,i,c,w,a,h)},f.mercatorZoomToWidth=function(n,t,i){var r=1/Math.pow(2,n);return t===s?r:t.metersToUnits(i,s.unitsToMeters(s.fromLocation(t.toLocation(i)),r))},f.widthToMercatorZoom=function(n,t,i){var r=t===s?n:s.metersToUnits(s.fromLocation(t.ToLocation(i)),t.unitsToMeters(i,n));return o.log2(1/r)},f.snapSmallDifferences=function(n,i){n.getCrs()!==i.getCrs()&&(n=i.convertCoordinateReferenceSystem(i.getCrs()));var s=Math.max(n.getWidth(),i.getWidth())/t.zoomOriginWidth,e=s*f.smallPixelDistance,u=e*e,o=new f(n.getCrs(),r.distanceSquared(i.getLookAt(),n.getLookAt())>u?n.getLookAt():i.getLookAt(),Math.abs(i.getWidth()/n.getWidth()-1)>f.smallWidthRatioDiff?n.getWidth():i.getWidth(),Math.abs(n.getHeading()-i.getHeading())>f.smallAngle?n.getHeading():i.getHeading(),Math.abs(n.getPitch()-i.getPitch())>f.smallAngle?n.getPitch():i.getPitch(),Math.abs(n.getRoll()-i.getRoll())>f.smallAngle?n.getRoll():i.getRoll(),Math.abs(n.getDistanceInverse()-i.getDistanceInverse())>vt?n.getDistanceInverse():i.getDistanceInverse(),Math.abs(n.getZoomDelta()-i.getZoomDelta())>f.smallWidthRatioDiff?n.getZoomDelta():i.getZoomDelta(),r.distanceSquared(i.getPerspectiveOrigin(),n.getPerspectiveOrigin())>u?n.getPerspectiveOrigin():i.getPerspectiveOrigin(),n.getZoomOriginWidth());return f.areEqual(o,n)?n:o},f.lerp=function(n,t,i){var u=i,e=t.getWidth()/n.getWidth();return Math.abs(e-1)>f.smallWidthRatioDiff&&(u=(Math.pow(e,i)-1)/(e-1)),new f(t.getCrs(),r.lerp(n.getLookAt(),t.getLookAt(),u),o.lerpDouble(n.getWidth(),t.getWidth(),u),o.lerpAngle(n.getHeading(),t.getHeading(),i),o.lerpAngle(n.getPitch(),t.getPitch(),i),o.lerpAngle(n.getRoll(),t.getRoll(),i),o.lerpDouble(n.getDistanceInverse(),t.getDistanceInverse(),i),o.lerpDouble(n.getZoomDelta(),t.getZoomDelta(),i),r.lerp(n.getPerspectiveOrigin(),t.getPerspectiveOrigin(),u),n.getZoomOriginWidth())},f.areAligned=function(n,t){return n&&t&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()},f.areEqual=function(n,t){return n&&t&&(n===t||r.areEqual(n.getLookAt(),t.getLookAt())&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()&&n.getZoomDelta()===t.getZoomDelta()&&r.areEqual(n.getPerspectiveOrigin(),t.getPerspectiveOrigin()))},l.MapCamera=f,rt={mercator:new f(s,new r(.5,.5,0),1),enhancedBirdseyeNorthUp:new f(s,new r(.5,.5,0),1,p.northUpHeading,p.enhancedBirdseyePitch),enhancedBirdseyeEastUp:new f(s,new r(.5,.5,0),1,p.eastUpHeading,p.enhancedBirdseyePitch),enhancedBirdseyeSouthUp:new f(s,new r(.5,.5,0),1,p.southUpHeading,p.enhancedBirdseyePitch),enhancedBirdseyeWestUp:new f(s,new r(.5,.5,0),1,p.westUpHeading,p.enhancedBirdseyePitch)},l.StandardMapCameras=rt,l.MemoryCache=li,v={tileIdToCacheKey:function(n){return n.levelOfDetail+"~"+n.x+"~"+n.y},latLonToMercatorXY:function(n,t){var r=t/360+.5;return r-=Math.floor(r),new i(r,s.latitudeToY(n))},mercatorXYToTileId:function(n,t){var i=1<<t;return new g(t,Math.floor(n.x*i),Math.floor(n.y*i))},mercatorXYToCacheKey:function(n,t){return v.tileIdToCacheKey(v.mercatorXYToTileId(n,t))},latLonToTileId:function(n,t,i){var r=v.latLonToMercatorXY(n,t);return v.mercatorXYToTileId(r,i)},latLonToCacheKey:function(n,t,i){return v.tileIdToCacheKey(v.latLonToTileId(n,t,i))},tileIdToMercatorXY:function(n){var t=1<<n.levelOfDetail;return new i((n.x+.5)/t,(n.y+.5)/t)},tileIdToLocation:function(n){var t=v.tileIdToMercatorXY(n);return s.toLocation(t)},normalizeMercatorBounds:function(n){n.width<1?n.x-=Math.floor(n.x):(n.x=0,n.width=1);var t=Math.min(n.getBottom(),1);n.y=Math.max(n.y,0),n.height=t-n.y}},l.SpatialCache=v,ft=new function(){function s(){var o,u,y;if(f.length&&w<1&&d){var s=f.shift(),t=s.topLeft,i=s.bottomRight,l=!0,nt=t.x,k=i.x,it=t.y,tt=i.y,r=new g(t.levelOfDetail,0,0);for(o=it;o<=tt;o++){for(u=nt;u<=k;u++){r.x=u,r.y=o,r=fi.wrapX(r);if(e.get(v.tileIdToCacheKey(r))===c){l=!1;break}}if(!l)break}if(l)n.invoke(s.requestHandle,"downloaded",{cacheHit:!0});else{y=1<<t.levelOfDetail,t.x-=h,t.y=Math.max(0,t.y-h),i.x+=h,i.y=Math.min(y-1,i.y+h);var p=v.tileIdToLocation(t),a=v.tileIdToLocation(i),b=d.replace("{north}",p.latitude.toFixed(6)).replace("{west}",p.longitude.toFixed(6)).replace("{south}",a.latitude.toFixed(6)).replace("{east}",a.longitude.toFixed(6)).replace("{cols}",i.x-t.x+1).replace("{rows}",i.y-t.y+1);w++,ii.getObjectAsync(b,et,{topLeft:t,bottomRight:i,requestHandle:s.requestHandle})}}}function et(t,i){var o,f;if(i.success){var h=i.userData.topLeft,p=i.userData.bottomRight,d=h.x,k=p.x,b=h.y,y=p.y,c=t.alt;if(c&&c.length===(y-b+1)*(k-d+1)){var u=new g(h.levelOfDetail,0,0),r,tt,nt=0,a=0;for(o=b;o<=y;o++)for(f=d;f<=k;f++){a+=c[nt++],u.x=f,u.y=o,u=fi.wrapX(u),r=u;while(r.levelOfDetail>=h.levelOfDetail-rt){if(e.insert(v.tileIdToCacheKey(r),a))break;r=r.getParent()}}l++,n.invoke(i.userData.requestHandle,"downloaded",{cacheHit:!1})}}w--,s()}function it(n){return Math.floor(Math.min(n+k,ut))}var u=this,d,ot=64,k=o.log2(t.zoomOriginWidth/ot),b=10+k,ut=20+k,rt=6,e=new li(5e3),f=[],w=0,l=0,h=4,ft=3,st=new r(0,0,1),nt=bt+"ellipsoid",tt;this.authenticate=function(n){tt||(tt=!0,n(function(n){n&&(d=t.elevationServiceUrl.replace("{credentials}",n),s())}))},this.getAltitudeAtLatLon=function(n,t){return u.getAltitudeAtMercatorXY(v.latLonToMercatorXY(n,t))},this.getAltitudeForTile=function(n){return e.get(v.tileIdToCacheKey(n))},this.getApproximateAltitudeForTile=function(n){var t=e.get(v.tileIdToCacheKey(n)),r,i;if(t!==c)return t;for(r=-1;r<2;r++)for(i=-1;i<2;i++){t=e.get(v.tileIdToCacheKey(n.getSibling(r,i)),!1);if(t!==c)return t}},this.getAltitudeAtMercatorXY=function(n){var e=v.mercatorXYToTileId(n,ut),f,t;while(e.levelOfDetail>=1){f=u.getApproximateAltitudeForTile(e);if(f!==c){var o=e.levelOfDetail,d=1<<o,r=n.x*d-.5,y=n.y*d-.5,a=Math.floor(r),l=Math.ceil(r),p=Math.floor(y),b=Math.ceil(y),k=u.getAltitudeForTile(new g(o,a,p)),h=u.getAltitudeForTile(new g(o,l,p)),w=u.getAltitudeForTile(new g(o,a,b)),s=u.getAltitudeForTile(new g(o,l,b)),i;return k!==c?i=h!==c?k*(l-r)+h*(r-a):k:h!==c&&(i=h),w!==c?t=s!==c?w*(l-r)+s*(r-a):w:s!==c&&(t=s),i!==c?f=t!==c?i*(b-y)+t*(y-p):i:t!==c&&(f=t),f}e=e.getParent()}return 0},this.rayToGround=function(n,t,i){if(Math.abs(t.x-i.x)<=vt&&Math.abs(t.y-i.y)<=vt)return n.changeAltitude(t,u.getAltitudeAtMercatorXY(t));var o,r,e,f=t,s=ft;while(s--){r=u.getAltitudeAtMercatorXY(f);if(Math.abs(o-r)<1)break;o=r,e=kt.fromNormal(n.changeAltitude(f,r),st),f=e.intersectWithLine(t,i)}return f},this.toEllipsoid=function(n,t){var i,f,r;if(n.altitudeReference===pt.ellipsoid)return n;if(t)return new a(n.latitude,n.longitude,0,pt.ellipsoid);return i=n[nt],i&&i.latitude===n.latitude&&i.longitude===n.longitude&&i.forAltitude===n.altitude&&i.forAltitudeReference===n.altitudeReference&&i.forGeneration===l?i:(f=u.getAltitudeAtLatLon(n.latitude,n.longitude),r=n.altitudeReference===pt.ground?n.altitude+f:f,i=new a(n.latitude,n.longitude,r,pt.ellipsoid),i.forAltitude=n.altitude,i.forAltitudeReference=n.altitudeReference,i.forGeneration=l,n[nt]=i,i)},this.isElevationAvailableAtLatLon=function(n,t,i){var e=it(i),r,f;if(e<b)return!0;r=v.latLonToTileId(n,t,e),f=rt;while(f--){if(u.getApproximateAltitudeForTile(r)!==c)return!0;r=r.getParent()}return!1},this.adjustCameraElevation=function(n){var i=n.getLookAt(),t=u.rayToGround(n.getCrs(),i,n.getViewportToWorld().transform(new r(0,0,1)));return r.areAlmostEqual(i,t)?n:n.getAlignedCamera(0,t)},this.downloadElevationData=function(n,t){var u,r;u=it(n.getMercatorZoom());if(u>=b){r=ht.union(p.getMercatorFootprint(n,t)),v.normalizeMercatorBounds(r);var o=v.mercatorXYToTileId(r,u),h=v.mercatorXYToTileId(new i(r.getRight(),r.getBottom()),u),e={};return f.push({topLeft:o,bottomRight:h,requestHandle:e}),y.dispatch(s),e}},this.downloadElevationDataForLocationRect=function(n,t){t=t||19;if(t>=b){var h=n.getNorth(),o=n.getWest(),e=n.getSouth(),c=n.getEast(),r=v.latLonToTileId(h,o,t),u=v.latLonToTileId(e,c,t),i={};return f.push({topLeft:r,bottomRight:u,requestHandle:i}),y.dispatch(s),i}},this.cancelDownload=function(n){if(n){var t=f.length;while(t--)f[t].requestHandle===n&&f.splice(t,1)}}},l.ElevationService=ft,at.nativeMercatorCamera=rt.mercator.getAlignedCamera(t.minMercatorZoom),at.createMercatorScene=function(n,i,r,u){var f=null;return n&&(f=gt.createQuadKeyTilePyramid(t.defaultTileSize,t.defaultTileSize,n,tt.horizontal,u),f.projectingCamera=rt.mercator),new at(at.nativeMercatorCamera,f,t.maxMercatorZoom-t.minMercatorZoom,i,r)},l.CompositeModeScene=at,yt.entityRenderers=[],yt.registerEntityRenderer=function(t,i){var r={getRenderer:t,priority:i?i.priority:null};yt.entityRenderers.push(r),i&&i.priority!==null&&yt.entityRenderers.sort(function(n,t){var r=0,i=n.priority,u=t.priority;return(i!==null||u!==null)&&(r=i!==null&&u!==null?i-bpriority:i!==null?-1:1),r}),n.invoke(yt,"newEntityRenderer")},yt.getEntityRenderer=function(n,t){var i=t._cmRd,u,r;if(!i){for(u=yt.entityRenderers,r=0;r<u.length&&!i;r++)i=u[r].getRenderer(n,t);t._cmRd=i}return i},l.CompositeMode=yt;var w=new function(){function r(){for(var c=b(),l=!1,e,u,s,a,f,o,h,r=0;r<t.length&&!l;r++){e=t[r];for(u in e)s=e[u][0],a=e[u][1],s in c.style&&(i.Properties[u]=s,i.Attributes[u]=a,l=!0)}for(r=0;r<n.length;r++){f=n[r];for(o in f)if(o in c.style)for(h in f[o])i.Events[h]=f[o][h]}}var i=this,t,n;this.Properties={},this.Attributes={},this.Events={},t=[{transform:["msTransform","-ms-transform"],transformOrigin:["msTransformOrigin","-ms-transform-origin"],transition:["msTransition","-ms-transition"],transitionDelay:["msTransitionDelay","-ms-transition-delay"],transitionProperty:["msTransitionProperty","-ms-transition-property"],transitionDuration:["msTransitionDuration","-ms-transition-duration"]},{transform:["webkitTransform","-webkit-transform"],transformOrigin:["webkitTransformOrigin","-webkit-transform-origin"],transition:["webkitTransition","-webkit-transition"],transitionDelay:["webkitTransitionDelay","-webkit-transition-delay"],transitionProperty:["webkitTransitionProperty","-webkit-transition-property"],transitionDuration:["webkitTransitionDuration","-webkit-transition-duration"]},{transform:["MozTransform","-moz-transform"],transformOrigin:["MozTransformOrigin","-moz-transform-origin"]},{transform:["OTransform","-o-transform"],transformOrigin:["OTransformOrigin","-o-transform-origin"]}],n=[{webkitTransition:{transitionEnd:"webkitTransitionEnd"}},{MozTransition:{transitionEnd:"MozTransitionEnd"}}],r()},dt=new function(){function g(){var n=null,i=b(),t=w.Properties.transform,r;if(t&&t in v){r=v[t];try{i.style[t]="matrix(1,0,0,1,0,0)",l=r.p,n=r.f}catch(f){}}"opacity"in i.style&&(y=!0),n==null&&"filter"in i.style&&(n=nt,c.requireFlowLayout=!0,a=!0,c.usingIEFilters=!0,"zoom"in i.style&&u.isZoomFasterThanMatrixFilter&&(p=!0)),n==null&&(n=k),c.setTransformAndOpacity=n}function h(n){if(n.offsetZ){var i=n.invert(),t=3;while(t--)e[t]=i.transform(o[t]);return ct.conversion(e[0],e[1],e[2],o[0],o[1],o[2])}return n.m44==1?n:new ct(n.m11/n.m44,n.m12/n.m44,n.m21/n.m44,n.m22/n.m44,n.offsetX/n.m44,n.offsetY/n.m44)}function f(n){var t={};return t.position="absolute",t["white-space"]="nowrap",t["line-height"]="0",n&&(t.width=n.width.toFixed(0)+"px",t.height=n.height.toFixed(0)+"px"),t}function r(n){var t=[];for(styleKey in n)t.push(styleKey,":",n[styleKey],";");return t.join("")}function nt(i,e,o,s){var d,g,a;s=s||{};var l=h(i),k=Math.round(l.m11*n)/n,it=Math.round(l.m22*n)/n,rt=Math.round(l.m12*n)/n,tt=Math.round(l.m21*n)/n,c=s.excludeCommonCss?{}:f(e),v=null,y,w;if(k==1&&rt==0&&tt==0&&it==1)y=l.offsetX.toFixed(0),w=l.offsetY.toFixed(0);else if(p&&k==it&&rt==0&&tt==0){var b=Math.abs(k-1)>.02?Math.round(k*1e4)/1e4:1,ft=l.invert(),ut=ft.offsetX,nt=ft.offsetY,y,w;u.cssZoomAffectsTopLeft?(y=-ut,w=-nt):(y=-ut*b,w=-nt*b),b!=1&&(c.zoom=b)}else d=Math.round(e.width/2),g=Math.round(e.height/2),y=-d,w=-g,a=ct.multiply(l,new ct(1,0,0,1,d,g)),v="progid:DXImageTransform.Microsoft.Matrix(FilterType=nearest,  M11="+a.m11.toFixed(t)+", M21="+a.m12.toFixed(t)+", M12="+a.m21.toFixed(t)+", M22="+a.m22.toFixed(t)+", dX="+a.offsetX.toFixed(0)+", dY="+a.offsetY.toFixed(0)+")";return c.left=y+"px",c.top=w+"px",o<.01?c.display="none":(c.display="block",o<.99&&(v=(v==null?"":v+", ")+"alpha(opacity = "+(o*100).toFixed(0)+")")),v&&(c.filter=v),s.returnStyleObject?c:r(c)}function s(t,i,e,o){var s,v;o=o||{};var k=h(t),a=Math.round(k.m11*n)/n,y=Math.round(k.m22*n)/n,g=Math.round(k.m12*n)/n,d=Math.round(k.m21*n)/n,b=Math.round(k.offsetX*n)/n,p=Math.round(k.offsetY*n)/n,c=o.excludeCommonCss?{}:f(i);return a===1&&g===0&&d===0&&y===1?u.useTransform2d?(c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+b+"px,"+p+"px)"):(c.left=b+"px",c.top=p+"px"):(i&&(u.isIE9||u.isIE10)&&a&&y&&d===0&&Math.abs(a-y)<.01&&(s=a-1,v=y-1,s>.0102||s<-.009998||(s>.0079||s<-.0075?s>.009175||s<-.009086?(b+=i.width*s*-.05,p+=i.height*v*-.05,a+=s*.1,y+=v*.1):(a+=s*.17,y+=v*.17,s>0&&a<1.0100995||s<0&&a>.99?(b+=i.width*s*.5,p+=i.height*v*.5):(b+=i.width*s*-.09,p+=i.height*v*-.09)):(b+=i.width*s*.5,p+=i.height*v*.5,a+=s*.2,y+=v*.2))),c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix("+a+","+g+","+d+","+y+","+b+l+","+p+l+")"),e<.01?c.display="none":(e>.99||(c.opacity=e.toFixed(2)),c.display="block"),o.returnStyleObject?c:r(c)}function d(t,i,u,e){e=e||{};var s=e.excludeCommonCss?{}:f(i),o=t.m44,b=Math.round(t.m11*n/o)/n,p=Math.round(t.m12*n/o)/n,k=Math.round(t.m14*n/o)/n,g=Math.round(t.m21*n/o)/n,d=Math.round(t.m22*n/o)/n,y=Math.round(t.m24*n/o)/n,c=Math.round(t.m31*n/o)/n,h=Math.round(t.m32*n/o)/n,l=Math.round(t.m34*n/o)/n,v=Math.round(t.offsetX/o),a=Math.round(t.offsetY/o);return b===1&&p===0&&k===0&&g===0&&d===1&&y===0&&c===0&&h===0&&l===0?(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+v+"px,"+a+"px,0px)"):(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix3d("+b+","+p+",0,"+k+","+g+","+d+",0,"+y+","+c+","+h+",1,"+l+","+v+","+a+",0,1)"),u>=.01||e.explicitOpacity?((u<=.99||e.explicitOpacity)&&(s.opacity=u.toFixed(2)),s.display="block"):s.display="none",e.returnStyleObject?s:r(s)}function k(n,t,i,u){u=u||{};var o=h(n).invert(),e=u.excludeCommonCss?{}:f(t);return e.left=(-o.offsetX).toFixed(0)+"px",e.top=(-o.offsetY).toFixed(0)+"px",e.display=i>.1?"block":"none",u.returnStyleObject?e:r(e)}var c=this,v={msTransform:{p:"",f:s},webkitTransform:{p:"",f:u.useTransform3d?d:s},MozTransform:{p:"px",f:s},OTransform:{p:"",f:s}},l,t=6,n=Math.pow(10,t),o=[new i(0,0),new i(128,128),new i(-128,128)],e=[],y=!1,a=!1,p=!1;this.setExactTransformOrHide=function(n,t,i,e){var o,s,l,c;return e=e||{},o=e.excludeCommonCss?{}:f(t),s=h(n).invert(),Math.abs(s.m11-1)<vt&&Math.abs(s.m12-0)<vt&&Math.abs(s.m21-0)<vt&&Math.abs(s.m22-1)<vt&&i>=.01?(l=-Math.round(s.offsetX)+"px",c=-Math.round(s.offsetY)+"px",o.display="block",u.useTransform3dForTranslate?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+l+","+c+",0px)":u.useTransform2d?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+l+","+c+")":(o.left=l,o.top=c),i>.99||(y?o.opacity=i.toFixed(2):a&&(o.filter="alpha(opacity = "+(i*100).toFixed(0)+")"))):o.display="none",e.returnStyleObject?o:r(o)},g()},fr=new function(){function v(){for(var e,h,u,c=0;c<i.length;c++){for(e=i[c],h=0;h<e.length;h++){var l=e[h],s=l.url,v=a.getState(s);switch(v){case ut.none:case ut.timedout:case ut.cacheExpired:o<t.maxConcurrentTileDownloads&&(l.basket=e[h],r[s]||(o++,u=b("img"),r[s]=u,u[f]=l,u.onload=nt,u.onerror=p,u.onabort=p,u[k]=window.setTimeout(function(){var n=u;return function(){g.call(n)}}(),d),u.src=s));break;case ut.failed:delete r[s],o--;break;case ut.downloading:break;default:e.hasNewTiles=!0}}e.hasNewTiles&&(n.invoke(e,"hasnewtiles"),e.hasNewTiles=!1)}}function nt(){if(!this[e]){var n=this[f].url;s(this,n),w.insert(n,!0),l.insert(n,this)}}function p(){if(!this[e]){var n=this[f].url;s(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),h.insert(n,ut.failed)}}function g(){if(!this[e]){var n=this[f].url;s(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),h.insert(n,ut.timedout)}}function s(n,t){var s,i,u;n[e]=!0,n.onload=null,n.onerror=null,n.onabort=null,window.clearTimeout(n[k]),s=n[f],i=s.basket,i.hasNewTiles=!0,u=i.length;while(u--)i[u]===s&&i.splice(u,1);o--,delete r[t],y.dispatch(v,-10)}var a=this,d=5e3,i=[],o=0,r={},l=new li(50),h=new li(30),w=new li(200);u.useImageDisposer&&l.useDisposer(function(n){n&&n.src&&(n.src=t.spacerImageUrl)});var f=bt+"downloadRequest",k=bt+"timeoutid",e=bt+"processed";this.getState=function(n){if(l.get(n))return ut.ready;if(w.get(n))return ut.cacheExpired;var t=h.get(n);return t!==c?t:r[n]?ut.downloading:ut.none},this.setDownloadBasket=function(n,t){a.removeDownloadBasket(n.basketId),n.length>0&&(t?i.push(n):i.unshift(n),y.dispatch(v,-10))},this.removeDownloadBasket=function(n){for(var t=0;t<i.length;)i[t].basketId===n?i.splice(t,1):t++}},ut={none:0,downloading:1,ready:2,failed:3,timedout:4,cacheExpired:5};gt.createQuadKeyTilePyramid=function(n,i,r,u,f){var e=Math.pow(2,t.maxMercatorZoom);return new gt(n*e,i*e,n,i,0,0,0,0,gt.createMercatorQuadKeyUrlRetriever(r,n,u,f))},gt.createMercatorQuadKeyUrlRetriever=function(n,i,r,u){return gt.createQuadKeyUrlRetriever(n,u,i,r,t.minMercatorZoom,t.maxMercatorZoom)},gt.createQuadKeyUrlRetriever=function(n,t,i,r,u,f,e){var l=o.ceilLog2(i),c,s,h;return typeof n=="string"?(c=n,s=t?t:c):h=n,function(n,t){var v=n.levelOfDetail-l,i,o,a;if(v>=u&&v<=f){i=new g(v,n.x,n.y),r&tt.horizontal&&(i=fi.wrapX(i)),r&tt.vertical&&(i=fi.wrapY(i));if(fi.isInBounds(i)){if(h)return h(i);if(i.levelOfDetail===0)if(e)o=fi.fromTileId(i,!0),a=e;else return null;else o=fi.fromTileId(i,!1),a=o.charAt(o.length-1);return t?s.replace("{quadkey}",o).replace("{subdomain}",a):c.replace("{quadkey}",o).replace("{subdomain}",a)}}return null}},tt={none:0,horizontal:1,vertical:2},l.TilePyramid=gt,l.TilePyramidWrapMethod=tt,ir.getBestLevelOfDetail=function(n,t,i){var r,f,u;return r=t.getMaxLevelOfDetail()-o.log2(t.getWidth()/t.projectingCamera.getWidth()/(n.getZoomOriginWidth()/n.getWidth())),f=Math.ceil(r),u=Math.floor(r),f!=u&&(i&&(r=r+i),r=Math.round(r),r=Math.min(f,Math.max(u,r))),r=Math.min(r,t.getMaxLevelOfDetail())},l.TileRenderer=cr,si=new function(){function n(){s()?(i=1,r=!0,f=!0):h()?(i=2,r=!1,f=!0):o()&&(i=3,r=!0,f=!1),n=function(){}}function s(){var n=!1,t;return document.implementation&&document.implementation.hasFeature?n=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):document.createElementNS&&(t=document.createElementNS(ns,"svg"),n=typeof t.createSVGRect!="undefined"),s=function(){return n},n}function h(){var t=document.createElement("v:shape"),n;return t.style.behavior="url(#default#VML)",n=typeof t.strokecolor!="undefined",h=function(){return n},n}function o(){var t=document.createElement("canvas"),n=t.getContext&&t.getContext("2d")!==null;return o=function(){return n},n}function e(n){function t(n){this._surface=n,this._paths=[]}return t.prototype={setSize:function(n,t){this._width=n,this._height=t},createPath:function(){},renderPath:function(){},removePath:function(n){var t=this._paths.length;while(t--)if(this._paths[t]===n){this._surface.removeChild(n.nativeShape),this._paths.splice(t,1);break}},clear:function(){var n=this._paths.length;while(n--)this._surface.removeChild(this._paths[n].nativeShape);this._paths=[]}},new t(n)}function a(n){function i(){}function r(){function n(){var r=this,n=document.createElement("v:shape"),t,i;n.style.position="absolute",t=document.createElement("v:stroke"),n.appendChild(t),i=document.createElement("v:fill"),n.appendChild(i),this._stroke=t,this._fill=i,this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){this.data==null||this.data.length&&this.data.charAt(this.data.length-1)==="E"||(this.data+="E");var n=this.nativeShape;n.strokecolor=this.strokeStyle,n.strokeweight=this.lineWidth+"pt",this.lineCap&&(this._stroke.endcap=this.lineCap.toLowerCase()==="butt"?"flat":path.lineCap,this._stroke.dashstyle=this.dashArray,this._stroke.opacity=this.strokeOpacity),this.fillStyle&&this.fillStyle!=="none"?(this._fill.color=this.fillStyle,this._fill.opacity=this.fillOpacity*100+"%"):n.filled=!1,n.path=this.data},new n}return i.prototype=new e(n),i.prototype.createPath=function(){return new r},i.prototype.renderPath=function(n){var i="url(#default#VML)",r=this._height!=null?this._height:this._surface.offsetHeight,u=this._width!=null?this._width:this._surface.offsetWidth,t=n.nativeShape;this._surface.appendChild(t),t.style.height=r,t.style.width=u,t.style.behavior=i,t.coordsize=u+","+r,n._stroke.style.behavior=i,n._fill.style.behavior=i,this._paths.push(n)},new i}function l(n){function r(){}function o(){function n(){var t=this,n=document.createElementNS(f,"path");n.style.pointerEvents="visiblePainted",this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){var n=this.nativeShape;n.setAttribute("stroke",this.strokeStyle),n.setAttribute("stroke-width",this.lineWidth),n.setAttribute("stroke-linecap",this.lineCap),n.setAttribute("stroke-dasharray",this.dashArray),n.setAttribute("fill",this.fillStyle),n.setAttribute("fill-opacity",this.fillOpacity),n.setAttribute("stroke-opacity",this.strokeOpacity),n.setAttribute("d",this.data)},new n}var f="http://www.w3.org/2000/svg",i=document.createElementNS(f,"svg");return u.safariRenderHack&&(i.style.cssText=u.safariRenderHack),i.setAttribute("width","100%"),i.setAttribute("height","100%"),n.appendChild(i),r.prototype=new e(i),r.prototype.createPath=function(){return new o},r.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new r(n)}function c(n){function i(){}function r(i,r){function u(){var f=this,t=document.createElement("canvas"),u;t.style.cssText="position:absolute;",n.appendChild(t),u=t.getContext("2d"),u.beginPath(),this.context=u,this._initialize(t),this.setSize(i,r)}function o(n,t){if(n.length==7){var i=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}return""}var e,f;return u.prototype=t,u.prototype.setSize=function(n,t){e=n,f=t,this.nativeShape.setAttribute("width",e),this.nativeShape.setAttribute("height",f)},u.prototype.beginPath=function(){this.context.beginPath()},u.prototype.moveTo=function(n,t){this.context.moveTo(n,t)},u.prototype.lineTo=function(n,t){this.context.lineTo(n,t)},u.prototype.stroke=function(){var n=this.context;n.clearRect(0,0,e,f),this.fillStyle&&this.fillStyle!=="none"&&(n.fillStyle=o(this.fillStyle,this.fillOpacity),n.fill()),n.strokeStyle=o(this.strokeStyle,this.strokeOpacity),n.lineWidth=this.lineWidth,n.stroke(),this.drawn=!0},new u}return i.prototype=new e(n),i.prototype.setSize=function(n,t){if(this._width!==n||this._height!==t){this._width=n,this._height=t;var i=this._paths.length;while(i--)this._paths[i].setSize(n,t)}},i.prototype.createPath=function(){var t=this._height?this._height:this._surface.offsetHeight,n=this._width?this._width:this._surface.offsetWidth;return new r(n,t)},i.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new i(n)}var r,f,i,t;this.isClipped=function(){return n(),r},this.isEventsSupported=function(){return n(),f},this.getContext=function(t){if(!t.harmonyContext){n();var r;switch(i){case 1:r=new l(t);break;case 2:r=new a(t);break;case 3:r=new c(t)}t.harmonyContext=r}return t.harmonyContext},this.destroyContext=function(n){n.harmonyContext&&(n.harmonyContext.clear(),n.harmonyContext=null)},t={nativeShape:null,_events:null,id:null,data:"",strokeStyle:"#000",strokeOpacity:"1",dashArray:"solid",fillStyle:"#000",fillOpacity:"1",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"#000000ff",beginPath:function(){this.data=""},moveTo:function(n,t){this.data+="M"+Math.round(n)+","+Math.round(t)+" "},lineTo:function(n,t){this.data+="L"+Math.round(n)+","+Math.round(t)+" "},stroke:function(){},onMouseDown:function(n){this._events.mousedown.push(n)},onMouseUp:function(n){this._events.mouseup.push(n)},onClick:function(n){this._events.click.push(n)},onMouseMove:function(n){this._events.mousemove.push(n)},onMouseOver:function(n){this._events.mouseover.push(n)},onMouseOut:function(n){this._events.mouseout.push(n)},_dispatchEvent:function(n,t){var i=this._events[n].length;while(i--)this._events[n][i].call(this,t)},_initialize:function(n){function i(n){n=n||window.event,t._dispatchEvent(n.type,n)}var t=this;t._events={mousedown:[],mouseup:[],mousemove:[],mouseover:[],mouseout:[],click:[]},n.onmousedown=n.onmouseup=n.onclick=n.onmousemove=n.onmouseover=n.onmouseout=i,this.nativeShape=n}}},pi.ensureVmlNamespace=function(){pi.ensureVmlNamespace=function(){};try{document.namespaces&&document.namespaces.add&&document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(n){}},l.CompositeModeEntityRenderer=pi,uu=ni.stopPropagation,b=ni.createElement,new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof wi||r instanceof tr){f=n.length;while(f--)n[f]===i&&(u=t[f]);u||(u=new cu(i),n.push(i),t.push(u))}return u};yt.registerEntityRenderer(i)},ru=new function(){function r(t,r){var c=r.userData,o=null,l,e,f,s,u,a;if(r&&r.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders){o=[],l=t.resourceSets[0].resources[0].imageryProviders,u=l.length;while(u--){var v=l[u],h=v.coverageAreas,p={attribution:v.attribution,coverageAreas:[]},y=h?h.length:0;while(y--)e=h[y],f=e.bbox,p.coverageAreas.push({zoomMax:e.zoomMax,zoomMin:e.zoomMin,boundingBox:it.fromEdges(f[2],f[1],f[0],f[3])});o.push(p)}i[c]=o}s=n[c],delete n[c],u=s.length;while(u--)a=s[u],a.callback(o,a.userData)}var i={},n={};this.getCachedImageryProviders=function(n){return i[n]},this.getImageryProviders=function(u,f,e,o){if(i[u])e(i[u],o);else if(n[u])n[u].push({callback:e,userData:o});else if(t.imageryMetadataUrl){n[u]=[],n[u].push({callback:e,userData:o});var s=t.imageryMetadataUrl.replace(/{imagerySet}/,u).replace(/{credentials}/,f);ii.getObjectAsync(s,r,u)}else e(null,o)}},yr=new function(){function u(t,i){var u,e,f;i&&i.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders&&(u=i.userData,e=[r,t.resourceSets[0].resources[0].imageryProviders],n[u]&&(f=n[u].callback,delete n[u],n[u]=null,f&&f(e)))}var i=0,n=[],r=wr.replace(/{year}/,(new Date).getFullYear());this.getCopyrights=function(f,e,o,s,h,c){if(f&&e&&o&&h&&c){var l=t.imageryCopyrightUrl.replace(/{imagerySet}/,f).replace(/{zoom}/,parseInt(o)).replace(/{minLat}/,e.getSouth()).replace(/{minLon}/,e.getWest()).replace(/{maxLat}/,e.getNorth()).replace(/{maxLon}/,e.getEast()).replace(/{heading}/,parseInt(s)).replace(/{credentials}/,h);n[i]={callback:c},ii.getObjectAsync(l,u,i),i=++i%10}else c([r])}},l.ModeEventHandler=vr,l.ModeEventHandlerComposite=lr,hr=new function(){function n(n,u,f,e,o,s){var h=gt.createQuadKeyTilePyramid(r,i,u,f,s);return h.projectingCamera=n,new at(n.getAlignedCamera(t.minMercatorZoom),h,t.maxMercatorZoom-t.minMercatorZoom,"EnhancedBirdseye",e)}var u=this,r=256,i=180;this.createContributor=function(i){var u=t.enhancedBirdseyeUriFormat,o=t.enhancedBirdseyeWithLabelsUriFormat,e=new ri("Synth",i),s=new ri("SynthWithLabels",i),f={},r;return r={},f[p.northUpHeading]=r,r[nt.hidden]=n(rt.enhancedBirdseyeNorthUp,u.replace("{dir}","dir_n"),tt.horizontal,e),r[nt.visible]=n(rt.enhancedBirdseyeNorthUp,o.replace("{dir}","dir_n"),tt.horizontal,s,u.replace("{dir}","dir_n")),r={},f[p.westUpHeading]=r,r[nt.hidden]=n(rt.enhancedBirdseyeWestUp,u.replace("{dir}","dir_w"),tt.vertical,e),r[nt.visible]=n(rt.enhancedBirdseyeWestUp,o.replace("{dir}","dir_w"),tt.vertical,s,u.replace("{dir}","dir_w")),r={},f[p.southUpHeading]=r,r[nt.hidden]=n(rt.enhancedBirdseyeSouthUp,u.replace("{dir}","dir_s"),tt.horizontal,e),r[nt.visible]=n(rt.enhancedBirdseyeSouthUp,o.replace("{dir}","dir_s"),tt.horizontal,s,u.replace("{dir}","dir_s")),r={},f[p.eastUpHeading]=r,r[nt.hidden]=n(rt.enhancedBirdseyeEastUp,u.replace("{dir}","dir_e"),tt.vertical,e),r[nt.visible]=n(rt.enhancedBirdseyeEastUp,o.replace("{dir}","dir_e"),tt.vertical,s,u.replace("{dir}","dir_e")),{priority:30,minZoomLevel:0,getScene:function(n,t,i,r,u,e){return r>this.minZoomLevel?f[p.snapToCardinalHeading(u)][e]:null}}}},lt.mercator="m",lt.auto="auto",t.allowOrdnanceSurvey&&(lt.ordnanceSurvey="os"),t.allowCollinsBart&&(lt.collinsBart="cb"),n.addHandler(gi,"mapcreationstart",function(n){var u=n.map,w=n.options,f=u.getCredentials,i=new yt,g=at.createMercatorScene(t.roadUriFormat,"Road",new ri("Road",f),t.roadUnlabeledUriFormat),e={priority:10,getScene:function(){return g}},h={},y,l,k,c,b,v,o,a;h[nt.hidden]=at.createMercatorScene(t.aerialUriFormat,"Aerial",new ri("Aerial",f)),h[nt.visible]=at.createMercatorScene(t.aerialWithLabelsUriFormat,"Aerial",new ri("AerialWithLabels",f),t.aerialUriFormat);var r={priority:20,maxZoomLevel:4.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevel?h[f]:null}},s=hr.createContributor(f),p=new fu(f),d=new oi(lt.mercator,i);d.activated=function(){i.setSceneContributors([])},y=new oi(lt.road,i),y.activated=function(){i.setSceneContributors([e])},l=new oi(lt.aerial,i),l.activated=function(){r.maxZoomLevel=1e3,i.setSceneContributors([r])},t.allowCollinsBart&&(k=new ar(at.createMercatorScene(t.collinsBartUriFormat,"CollinsBart",new ri("CollinsBart",f)),t.collinsBartMinZoom-.5,t.collinsBartMaxZoom+.5,t.collinsBartBounds,15),c=new oi(lt.collinsBart,i),c.activated=function(){i.setSceneContributors([e,k])},u.registerMapType(c)),t.allowOrdnanceSurvey&&(b=new ar(at.createMercatorScene(t.ordnanceSurveyUriFormat,"OrdnanceSurvey",new ri("OrdnanceSurvey",f)),t.ordnanceSurveyMinZoom-.5,t.ordnanceSurveyMaxZoom+.5,t.ordnanceSurveyBounds,15),v=new oi(lt.ordnanceSurvey,i),v.activated=function(){i.setSceneContributors([e,b])},u.registerMapType(v)),o=new oi(lt.auto,i),o.activated=w.disableBirdseye!==!0&&t.defaultAerialTiltOn===!0?function(){r.maxZoomLevel=4.5,s.minZoomLevel=16.5,i.setSceneContributors([e,r,s,p])}:function(){var n={priority:20,maxZoomLevelBand1:4.5,minZoomLevelBand2:16.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevelBand1||r>this.minZoomLevelBand2?h[f]:null}};i.setSceneContributors([n,e])},a=new oi(lt.birdseye,i),a.activated=function(){w.disableBirdseye!==!0?(r.maxZoomLevel=1e3,s.minZoomLevel=12.5,i.setSceneContributors([r,s,p])):(r.maxZoomLevel=1e3,i.setSceneContributors([r]))},u.registerMapType(d),u.registerMapType(o),u.registerMapType(y),u.registerMapType(l),u.registerMapType(a)}),delete window.Microsoft.Maps.initMapCode,PRF.end("Map core initialized","mapcore")},Microsoft.Maps.Globals&&Microsoft.Maps.initMapCode&&window.Microsoft.Maps.initMapCode(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.initMapDelayCode=function(){function ef(f,e,s){function bt(){d&&(n.removeHandler(d),n.removeHandler(pt),n.removeHandler(kt),d=null,y.remove_event("mousedown",k).remove_event("dblclick",i).remove_event("touchstart",k),t(v).remove_event("click",st),t(a).remove_event("click",ct),e.removeChild(l),l=null,v=null,c=null,a=null)}function wt(n){var n=f.isRotationEnabled();n!==w&&(w=n,at.set_style(w?{visibility:"visible"}:{visibility:"hidden"}),n||(c.className="NavBar_compass NavBar_compassFlat",rt=null),ft())}function ft(){var t,n;if(w){t=f.getTargetHeading();if(t!==rt){n="";switch(ht.snapToCardinalHeading(t)){case ht.northUpHeading:n="NavBar_compassN";break;case ht.eastUpHeading:n="NavBar_compassE";break;case ht.southUpHeading:n="NavBar_compassS";break;case ht.westUpHeading:n="NavBar_compassW"}c.className="NavBar_compass "+n,rt=t}}}function ot(n){var i=t.Screen.get_mouse_pos(n),r;isNaN(i.x)&&(i=new u(n.touches[0].pageX,n.touches[0].pageY)),h=new u(i.x-it.x-p.x,i.y-it.y-p.y),r=Math.sqrt(h.x*h.x+h.y*h.y),r<g&&(h.x=h.x/g*vt,h.y=h.y/g*vt)}function lt(){Math.abs(h.x)>1||(h.x=0),Math.abs(h.y)>1||(h.y=0);if(h.x||h.y){var n=f.tryPixelToLocation(h);n&&f.setView({center:n,animate:!1})}}function k(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),o(f,n),t(document).add_event("mousemove",nt,!0).add_event("mouseup",b,!0).add_event("touchmove",nt,!0).add_event("touchend",b,!0).add_event("contextmenu",i,!0),y.add_event("selectstart",i,!0),p=new u(c.offsetWidth/2,c.offsetHeight/2),g=Math.min(p.x,p.y),it=y.get_absolute_pos(),ot(n),lt(),yt=window.setInterval(lt,100))}function nt(n){n.preventMouseEvent&&n.preventMouseEvent(),i(n),ot(n)}function b(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),t(document).remove_event("mousemove",nt,!0).remove_event("mouseup",b,!0).remove_event("touchmove",nt,!0).remove_event("touchend",b,!0).remove_event("contextmenu",i,!0),y.remove_event("selectstart",i,!0),window.clearInterval(yt))}function st(n){i(n),o(f,n),ut(90)}function ct(n){i(n),o(f,n),ut(-90)}function ut(n){f.setView({heading:f.getTargetHeading()+n})}var gt=this,l,c,y,it,p,g,yt,h,vt=15,w,dt,rt,v,a,at,pt,kt,d;l=r("div",s.getClassName()),tt(l),v=et("NavBar_rotateLeft",uf),t(v).add_event("click",st).set_attr("uici","NB.CS.RotateLeft"),c=r("a"),c.appendChild(document.createTextNode(tu)),y=t(c),c.title=nf,a=et("NavBar_rotateRight",ku),t(a).add_event("click",ct).set_attr("uici","NB.CS.RotateRight"),at=t([v,a]),y.add_event("mousedown",k).add_event("dblclick",i).add_event("touchstart",k).set_attr("uici","NB.CS.PanControl"),s.getRotateVisible()&&l.appendChild(v),s.getCompassVisible()&&l.appendChild(c),s.getRotateVisible()&&l.appendChild(a),e.appendChild(l),s.getDomElement=function(){return l},pt=n.addHandler(f,"imagerychanged",wt),kt=n.addHandler(f,"targetviewchanged",ft),wt(),d=n.addHandler(f,"ondispose",bt),this.dispose=bt}function oi(i,u,f){function g(){y(),nt=new Date,c||(e(o,"show"),c=!0,rt.appendChild(w));if(s.style.visibility==="hidden"){var r=t(h).get_absolute_pos(),u=i.getRootElement(),a=t(u).get_absolute_pos(),l=u.offsetWidth,v=s.offsetWidth,f=r.y+h.offsetHeight,n=r.x;n=Math.min(n,a.x+l-v),s.style.top=f+"px",s.style.left=n+"px",s.style.visibility="visible"}}function p(){y(),c&&(e(o,"hide"),c=!1,rt.removeChild(w),s.style.visibility="hidden")}function y(){d&&(window.clearTimeout(d),d=null),k&&(window.clearTimeout(k),k=null)}var o=this,rt=document.body,a,c=!1,it=[],nt=new Date(0),ut=300,d,k,h=r("span","NavBar_button NavBar_typeButton"+(f?" "+f:"")),tt=t(h),v,b,w,s;tt.add_event("mouseenter",function(n){e(o,"mouseenter",n)}).add_event("mouseleave",function(n){e(o,"mouseleave",n)}).add_event("touchstart",function(n){e(o,"touchstart",n)}),v=r("a","NavBar_dropIconContainer",h),v.href="#",t(v).add_event("click",function(n){e(o,"clickicon",n)}).add_event("mouseenter",function(n){e(o,"mouseentericon",n)}).add_event("mouseleave",function(n){e(o,"mouseleaveicon",n)});var ft=r("span","NavBar_dropIcon",v),et=r("span","separator",h),l=r("a","NavBar_typeButtonLabel",h);l.href="#",l.appendChild(document.createTextNode("")),b=t(l),b.add_event("click",function(n){e(o,"clicklabel",n)}).add_event("mouseenter",function(n){e(o,"mouseenterlabel",n)}).add_event("mouseleave",function(n){e(o,"mouseleavelabel",n)}),u.appendChild(h),w=r("div","NavBar_ModeSelectorControl"),s=r("ul","MicrosoftMap_NavBar_typeMenu",w),s.style.cssText="position:absolute;visibility:hidden",t(s).add_event("mouseenter",function(n){e(o,"mouseenter",n)}).add_event("mouseleave",function(n){e(o,"mouseleave",n)}),this.dispose=function(){h&&(p(),u.removeChild(h),h=null)},this.isShown=function(){return c},this.addMenuItem=function(t,i){t&&(it.push(t),n.addHandler(t,"click",function(t){n.invoke(o,"clickitem",t)})),s.appendChild(i)},this.getItems=function(){return it},this.setMapType=function(n){a&&b.remove_class("NavBar_MapType_"+a),a=n,n&&b.add_class("NavBar_MapType_"+a)},this.getMapType=function(){return a},this.updateLabel=function(n){l.replaceChild(document.createTextNode(n),l.firstChild)},this.setSelected=function(n){n?tt.add_class("NavBar_buttonSel"):tt.remove_class("NavBar_buttonSel")},this.toggleMenu=function(){c?new Date-nt>ut&&p():(g(),nt=new Date(0))},this.showMenu=function(){g()},this.showMenuDelay=function(n){y(),c||(d=window.setTimeout(g,n))},this.hideMenu=function(){p()},this.hideMenuDelay=function(n){y(),k=window.setTimeout(p,n)}}function ui(i,u,f){var a=this,c=it[i],s=r("li","NavBar_menuitem"+(u?" NavBar_menuItemSel":"")),e=r("div","NavBar_itemContainer NavBar_itemContainer_"+i,s),h;t(e).add_event("click",function(t){t.stopPropagation(),n.invoke(a,"click",t),f(i)});var v=r("div","NavBar_typePreview NavBar_typePreview_"+i,e),o=r("div","NavBar_typeContent",e),l=r("div","NavBar_typeTitle",o);l.appendChild(document.createTextNode(c.title)),h=r("div","NavBar_typeDesc",o),h.appendChild(document.createTextNode(c.description)),this.getTypeId=function(){return i},this.getElement=function(){return s},this.getContent=function(){return o},this.setSelected=function(n){s.className="NavBar_menuitem"+(n?" NavBar_menuItemSel":"")}}function lf(i,u,f,s){function tt(){var e=i.getOptions(),u,r,t,n,f;h=i.getMapTypeId(),h===b?(c=!1,w.disableBirdseye!==!0&&(h=l)):h===l&&(w.disableBirdseye===!0?h=b:c=!0);if(it.hasOwnProperty(h)){u=a.getItems(),r=u.length;while(r--)t=u[r],n=t.getTypeId(),t.setSelected(n==h||g(h)&&g(n));f=it[h],a.updateLabel(f.title),a.setMapType(i.getMapTypeId())}v=e.labelOverlay!==d.hidden,nt&&(nt.checked=v),k&&(k.checked=c)}function rt(n){n===l&&(n=w.disableBirdseye!==!0&&c?l:b),i.setView({mapTypeId:n,labelOverlay:v||n===ot?d.visible:d.hidden});var t=i.getComponent("analyticsProxy");t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function g(n){return n===b||n===l}function ft(n){v=!v,ut(n,nt,v)}function et(n){c=!c,ut(n,k,c)}function ut(n,t,r){n.stopPropagation(),o(i,n),n.currentTarget.tagName==="SPAN"&&t&&(t.checked=r),g(h)&&rt(l),ct&&a.hideMenuDelay(1e3)}function ht(t){var r=new oi(i,u),v,s,c,a,f;for(r.mapTypes=t,r.updateLabel(it[t[0]].title),r.setMapType(t[0]),v=[],r.events=v,f=0;f<t.length;f++)s=t[f],s&&(c=new ui(s,h===s,rt),r.addMenuItem(c,c.getElement()),(s===l||s===b&&w.disableBirdseye===!0)&&lt(c.getContent()));a=[["clicklabel",function(n){o(i,n),r.toggleMenu()}],["clickicon",function(n){o(i,n),r.toggleMenu()}],["clickitem",function(n){o(i,n),r.hideMenu()}],["mouseenter",function(){r.showMenu()}],["mouseleave",function(){r.hideMenuDelay(1e3)}],["show",function(){e(st,"showmaptypemenu",{menuPosition:0})}],["hide",function(){e(st,"hidemaptypemenu",{menuPosition:0})}]],f=a.length;while(f--)v.push(n.addHandler(r,a[f][0],a[f][1]));return r}function lt(n){var e=r("div","NavBar_checkControls"),f=r("div","NavBar_checkControl",e),i=r("input"),u;i.id="LabelCB_"+ti.getNext(),i.setAttribute("type","checkbox"),t(i).add_event("click",ft),nt=i,f.appendChild(i),i.checked=!0,u=r("span","",f),u.appendChild(document.createTextNode(li)),t(u).add_event("click",ft),w.disableBirdseye!==!0&&(f=r("div","NavBar_checkControl",e),i=r("input"),i.id="TiltCB_"+ti.getNext(),i.setAttribute("type","checkbox"),t(i).add_event("click",et),k=i,f.appendChild(i),i.checked=!0,u=r("span","",f),u.appendChild(document.createTextNode(vu)),t(u).add_event("click",et)),n.appendChild(e)}var st=this,ot=y.auto,l=y.birdseye,b=y.aerial,h=i.getMapTypeId(),w=s,v=!0,c=p.defaultAerialTiltOn===!0,nt=null,k=null,a=ht([y.road,p.allowCollinsBart?y.collinsBart:null,p.allowOrdnanceSurvey?y.ordnanceSurvey:null,ot,w.disableBirdseye!==!0?l:b]),at=n.addHandler(i,"maptypechanged",tt),vt=n.addHandler(i,"optionschanged",tt),yt=!1;tt(),this.dispose=function(){var i=a.events,t=i.length;while(t--)n.removeHandler(i[t]);a.dispose(),n.removeHandler(at),n.removeHandler(vt)},this.showMenu=function(){a.showMenu()},this.hideMenu=function(){a.hideMenu()},this.getAerialViewSettings=function(){return{showLabels:v,enableTilt:c}},this.setAerialViewSettings=function(n,t){v=n,c=t,g(h)&&rt(l)}}function hf(i,u,f,s){function b(){var a=i.getOptions(),u,r,n,s;c=i.getMapTypeId();if(it.hasOwnProperty(c)){u=h.length;while(u--){var t=h[u],o=!1,e=t.getItems(),f=e.length;while(f--)r=e[f],n=r.getTypeId(),r.setSelected(n==c),n==c&&(o=!0,s=it[n],t.updateLabel(s.title),t.setMapType(n));t.setSelected(o)}}!w&&g(c)&&(l=a.labelOverlay!==d.hidden,et.checked=l),w=!1}function a(n){var u=i.getOptions(),r=n==ut||l,t;w=u.labelOverlay!==d.hidden!==r,i.setView({mapTypeId:n,labelOverlay:r?d.visible:d.hidden}),t=i.getComponent("analyticsProxy"),t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function g(n){return n===v||n===k}function nt(){var n=h.length;while(n--)h[n].hideMenu()}function tt(n){n.stopPropagation(),o(i,n),l=!l,et.checked=l,g(c)&&a(c),ct&&h[1].hideMenuDelay(1e3)}function ft(t,r){var b=h.length,f=new oi(i,u,r),w,s,l,p;for(f.mapTypes=t,f.updateLabel(it[t[0]].title),f.setMapType(t[0]),w=[],f.events=w,s=0;s<t.length;s++)l=t[s],l&&(p=new ui(l,c===l,a),f.addMenuItem(p,p.getElement()));var y=!1,v=[["clicklabel",function(n){o(i,n),nt(),a(f.getMapType())}],["clickicon",function(n){o(i,n),f.toggleMenu()}],["clickitem",function(n){o(i,n),nt()}],["mouseentericon",function(){f.showMenu()}],["mouseleaveicon",function(){f.hideMenuDelay(1)}],["mouseenterlabel",function(){y=!0}],["mouseleavelabel",function(){y=!1}],["mouseenter",function(){f.isShown()&&!y&&f.showMenu()}],["mouseleave",function(){f.hideMenuDelay(1e3)}],["show",function(){var t=h.length;while(t--)f!=h[t]&&h[t].hideMenu();e(rt,"showmaptypemenu",{menuPosition:b})}],["hide",function(){e(rt,"hidemaptypemenu",{menuPosition:b})}]],s=v.length;while(s--)w.push(n.addHandler(f,v[s][0],v[s][1]));return f}function ot(n){var f=r("div","NavBar_checkControl"),i=r("input"),u;return i.setAttribute("type","checkbox"),t(i).add_event("click",tt),f.appendChild(i),i.checked=!0,u=r("span","",f),u.appendChild(document.createTextNode(li)),t(u).add_event("click",tt),n.addMenuItem(null,f),i}var rt=this,ut=y.auto,k=y.birdseye,v=y.aerial,c=i.getMapTypeId(),st=s,h=[];h.push(ft([y.road,p.allowCollinsBart?y.collinsBart:null,p.allowOrdnanceSurvey?y.ordnanceSurvey:null,ut],"NavBar_DropDownMenu_0")),h.push(ft(st.disableBirdseye!==!0?[k,v]:[v],"NavBar_DropDownMenu_1"));var l=!0,et=ot(h[1]),ht=n.addHandler(i,"maptypechanged",b),lt=n.addHandler(i,"optionschanged",b),w=!1;b(),this.dispose=function(){var r=h.length;while(r--){var u=h[r],t=u.events,i=t.length;while(i--)n.removeHandler(t[i]);u.dispose()}n.removeHandler(ht),n.removeHandler(lt)},this.showMenu=function(n){h[n].showMenu()},this.hideMenu=function(n){h[n].hideMenu()},this.getAerialViewSettings=function(){return{showLabels:l}},this.setAerialViewSettings=function(n,t){l=n,g(c)&&(t?a(k):a(v))}}function cf(f,e,s){function ct(n){i(n),t.Events.capture_mouse(h),v=!0}function d(n){b();var t=Math.min(1,n.touches.length);lt||n.touches.length!==1||(y=new u(n.touches[0].pageX,n.touches[0].pageY),y.target=n.target,y.start=new Date),k=new u(n.touches[0].pageX,n.touches[0].pageY),lt=k,v=!0,i(n)}function ht(n){i(n);if(v){var r=w(t.Screen.get_mouse_pos(n).y);h.style.top=r+"px",p(r,!0)}}function nt(n){b(),et(),k=new u(n.touches[0].pageX,n.touches[0].pageY);if(v){var t=w(k.y);h.style.top=t+"px",p(t,!0)}i(n)}function yt(n){i(n),v&&(t.Events.release_mouse(),v=!1,p(w(t.Screen.get_mouse_pos(n).y),!1),ut(),o(f,n))}function g(n){b(),y?(wt(n),o(f,n)):v&&(v=!1,p(w(k.y),!1),ut(),o(f,n)),et()}function ft(n){i(n),p(w(t.Screen.get_mouse_pos(n).y)),o(f,n)}function wt(n){n.target===c&&p(w(y.y))}function et(){y=null}function rt(){var n=f.getZoomRange();l&&l.min==n.min&&l.max==n.max||(l=n),ut()}function w(n){var i=c.offsetHeight-h.offsetHeight;return n-=t(c).get_absolute_pos().y+h.offsetHeight/2,n=Math.max(n,0),n=Math.min(n,i)}function p(n,t){var i=h.offsetHeight/2,e=c.offsetHeight-i,u=n+i,r=Math.round(l.max+(u-i)*-(l.max-l.min)/(e-i));f.setView({zoom:r,suspend:t})}function kt(n,t){if(l){var i=h.offsetHeight/2,u=c.offsetHeight-i,r=Math.round(i+(u-i)*(t-l.max)/-(l.max-l.min));n.style.top=r-n.offsetHeight/2+"px"}}function ut(){kt(h,f.getTargetZoom())}function ot(){it&&(window.clearTimeout(it),it=null)}function b(){ot(),st&&(it=window.setTimeout(pt,5e3))}function pt(){ot(),e.style.display="none"}var dt=this,a,c,bt,h,st=s,vt,at,v,l,y,k,lt,it;a=r("div","NavBar_zoom"),tt(a),c=r("div","NavBar_zoomBar",a),c.style.cssText="position:absolute;overflow:hidden",t(c).add_event("click",ft).add_event("touchstart",d).add_event("touchmove",nt).add_event("touchend",g),bt=r("div","NavBar_zoomBarBg",c),h=r("div","NavBar_zoomSlider",c),h.title=yu,t(h).add_event("mousedown",ct).add_event("mouseup",yt).add_event("mousemove",ht).add_event("click",i).add_event("touchstart",d).add_event("touchmove",nt).add_event("touchend",g),t(a).add_event("mousedown",i).add_event("mouseup",i).add_event("mousemove",i).add_event("click",i).add_event("touchstart",i).add_event("touchmove",i).add_event("touchend",i),e.appendChild(a),vt=n.addHandler(f,"targetviewchanged",rt),at=n.addHandler(f,"imagerychanged",rt),st&&b(),this.getDomElement=function(){return a},this.dispose=function(){a&&(t(c).remove_event("click",ft).remove_event("touchstart",d).remove_event("touchmove",nt).remove_event("touchend",g),t(h).remove_event("mousedown",ct).remove_event("mouseup",yt).remove_event("mousemove",ht).remove_event("click",i).remove_event("touchstart",d).remove_event("touchmove",nt).remove_event("touchend",g),t(a).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousemove",i).remove_event("click",i).remove_event("touchstart",i).remove_event("touchmove",i).remove_event("touchend",i),n.removeHandler(vt),n.removeHandler(at),e.removeChild(a),c=null,h=null,a=null)},this.show=function(){rt()},this.resetZoomBarTimer=b}function du(u,f,e){function y(){h&&(n.removeHandler(h),h=null,c.removeNavigationBar(u))}function a(n){var t,u,i;t=l[n];if(!t){t=r("div","NavBar_clientRegion NavBar_clientRegion_"+v.getName(n)),u=f.getDomElement();switch(n){case v.left:i=l[v.middle],u.insertBefore(t,i?i.nextSibling:e.getDomElement().nextSibling);break;case v.middle:t=e.getDomElement();break;case v.right:u.appendChild(t)}l[n]=t}return t}var l={},s={},h;c.registerNavigationBar(u,this),h=n.addHandler(u,"ondispose",y),this.addClientButton=function(n,r,f,e,h){var l=a(n),c=typeof f=="string"?et(e,f):f;return l.appendChild(c),s[r]=c,t(c).add_event("click",function(n){typeof f=="string"&&i(n),o(u,n),h&&h(r)}).set_attr("uici","NB.TB."+f),c},this.updateClientButton=function(n,i,r){var u=s[n];u&&(u.className="NavBar_button NavBar_toolButton "+(r||""),u.title=i||"",t(u).set_attr("uici","NB.TB."+i))},this.removeClientButton=function(n,t){var r=a(n),i=s[t];i&&(delete s[t],r.removeChild(i))}}function bu(u,e,o){function lr(){n.removeHandler(ct),ct=null,or=u.getTargetCenter(),hr=u.getTargetZoom()}function yt(){gt&&(u.entities.remove(gt),gt=null),h.current.style.display!=="none"&&(h.current.style.display="none",h.currentDelim.style.display="none",d=p[k],v())}function sr(){h.current.style.display==="none"&&(c.currentZoom=u.getTargetZoom(),c.currentCenter=u.getTargetCenter(),h.current.style.display="inline-block",h.currentDelim.style.display="inline",v())}function nf(n){ni=n,v()}function ur(){ft=ni!==null?ni:ff()}function ff(){var r=h.breadcrumbContainer,u=h.breadcrumb,n,i;return u&&r?(n=t(u),i=r.offsetWidth-parseInt(n.get_style("paddingLeft"))-parseInt(n.get_style("paddingRight")),i>0?i:0):0}function pu(){v()}function vu(){var t,n,i;ur();if(ft>0)h.breadcrumb.style.display="block";else{h.breadcrumb.style.display="none";return}t=h.breadcrumbBar.offsetWidth;if(t>=ft)for(n=0,i=p.length-1;n<i;n++){h[p[n]].firstChild.nodeValue="...",h[p[n]].setAttribute("title",c[p[n]]),t=h.breadcrumbBar.offsetWidth;if(t<ft)break}gr()}function gr(){var t,n,i;ur();if(ft>0)h.breadcrumb.style.display="block";else{h.breadcrumb.style.display="none";return}t=h.breadcrumbBar.offsetWidth;if(t>=ft)for(n=0,i=w.length;n<i;n++){l[w[n].name].firstChild.nodeValue="...",l[w[n].name].setAttribute("title",w[n].value),t=h.breadcrumbBar.offsetWidth;if(t<ft)break}gi(it)}function pr(){h.breadcrumb&&(fi(h.breadcrumbContainer),e.removeChild(h.breadcrumbContainer),h.breadcrumbContainer=null,h.breadcrumb=null)}function wu(t){var f=l[t+"Delim"],u,i,r;f&&(f.parentNode.removeChild(f),l[t+"Delim"]=null),u=st(t),u.type==="group"?(i=t+"Click",n.removeHandler(b[i]),b[i]=null,i=t+"MouseEnter",n.removeHandler(b[i]),b[i]=null,i=t+"MouseLeave",n.removeHandler(b[i]),b[i]=null,u===it&&rt(!0),r=l[t+"Container"],l[t+"Container"]=null,l[t]=null,l[t+"ListSign"]=null,r.parentNode.removeChild(r)):(i=t+"Click",n.removeHandler(b[i]),b[i]=null,r=l[t],l[t]=null,r.parentNode.removeChild(r))}function bu(t){var i,r,f;d=t,v();switch(t){case"world":case"country":case"state":case"county":case"city":case"neighborhood":sr();break;case"current":yt();break;default:n.invoke(a,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:st(t).value});return}i={animate:tu},u.isStreetside&&u.isStreetside()&&(i.mapTypeId=y.road),r=c[t+"Bounds"],r?(f=bt.fromEdges(r[2],r[1],r[0],r[3]),i.bounds=f):t==="current"?(i.center=c.currentCenter,i.zoom=c.currentZoom):(i.center=c.currentCenter,i.zoom=c[t+"Zoom"]),ef(i),n.invoke(a,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:c[t]})}function br(){bu(this.attributes.pathNodeLevel.value)}function pi(){var c,f,n,s;h.root||(h.root=u.getRootElement(),c=r("div","pathContainer"),h.breadcrumb=c,c.setAttribute("onselectstart","return false;"),f=r("div",o.getClassName(),e),o.getDomElement=function(){return f},tt(f),h.breadcrumbContainer=f,f.appendChild(h.breadcrumb),n=document.createElement("div"),n.className="unlockButton",s=t(n),s.add_event("click",li),s.add_event("touchstart",i),s.add_event("touchend",li),h.root.appendChild(n),h.breadcrumbUnlock=n,yu())}function yu(){var u,i,r,f,e,n;if(h.breadcrumb){u=document.createElement("span"),u.className="path";for(i in ut)r=document.createElement("span"),i!=="world"?(i==="current"&&(f=document.createElement("span"),u.appendChild(f),h.breadcrumbExtension=f),e="•",r.className="pathNodeDelim",r.style.display="none"):(e="",r.className="pathHeight",r.style.display="inline-block"),r.appendChild(document.createTextNode(e)),u.appendChild(r),h[i+"Delim"]=r,i==="current"?(n=document.createElement("a"),n.className="currentIcon",n.href="#"):(n=document.createElement("a"),n.href="#",n.className="pathNode",i!=="world"?n.appendChild(document.createTextNode("")):n.appendChild(document.createTextNode(c[i]))),i!=="world"&&(n.style.display="none"),t(n).add_event("click",br),n.setAttribute("pathNodeLevel",i),n.setAttribute("uici","BC.PN."+i),u.appendChild(n),h[i]=n;h.breadcrumbBar=u,h.breadcrumb.appendChild(u)}}function yi(){s.country=null,s.state=null,s.county=null,s.city=null,s.neighborhood=null,s.street=null,s.current=null,s.countryBounds=null,s.stateBounds=null,s.countyBounds=null,s.cityBounds=null,s.neighborhoodBounds=null,s.streetBounds=null,s.currentBounds=null,s.countryEntityId=null,s.stateEntityId=null,s.countyEntityId=null,s.cityEntityId=null,s.neighborhoodEntityId=null,s.streetEntityId=null,s.currentEntityId=null}function vi(){h.breadcrumbUnlock.style.display="block"}function wi(){h.breadcrumbUnlock.style.display="none"}function ku(n,t,i,r,u){var f={type:n,name:t,value:i,values:r,isVisible:u};w.push(f),gu(f)}function gu(n){var u=document.createElement("span"),e="•",r,f,i;u.className="pathNodeDelim",u.style.display="none",u.appendChild(document.createTextNode(e)),l[n.name+"Delim"]=u,h.breadcrumbExtension.appendChild(u),n.type==="group"?(r=document.createElement("span"),r.className="groupContainer",r.style.display="none",r.setAttribute("pathNodeLevel",n.name),b[n.name+"Click"]=t(r).add_event("click",tf),b[n.name+"MouseEnter"]=t(r).add_event("mouseenter",tr),b[n.name+"MouseLeave"]=t(r).add_event("mouseleave",nr),i=document.createElement("span"),i.className="group",i.appendChild(document.createTextNode("")),f=document.createElement("span"),f.className="groupListSign",l[n.name+"Container"]=r,l[n.name]=i,l[n.name+"ListSign"]=f,r.appendChild(i),r.appendChild(f),h.breadcrumbExtension.appendChild(r)):(i=document.createElement("span"),i.className="pathNode",i.appendChild(document.createTextNode("")),i.style.display="none",b[n.name+"Click"]=t(i).add_event("click",br),i.setAttribute("pathNodeLevel",n.name),i.setAttribute("uici","BC.PN."+n.name),l[n.name]=i,h.breadcrumbExtension.appendChild(i))}function du(n,t){var i=st(n);if(i.isVisible===t)return;i.type==="group"&&t===!1&&i===it&&rt(!0),i.isVisible=t,v()}function au(n){wu(n),w.splice(lu(n),1),v()}function st(n){var t=w.length;while(t--)if(w[t].name===n)return w[t]}function lu(n){var t=w.length;while(t--)if(w[t].name===n)return t}function ai(t,i){var r=st(t),u=r.value;r.value=i,l[t].firstChild.nodeValue=i,ei(t),v(),n.invoke(a,"groupselecteditemchanged",{groupName:t,newItem:i,oldItem:u})}function ci(t){ot=!0,ht=t,kt(!0),n.invoke(a,"locked")}function ef(t){ct||(ct=n.addHandler(u,"targetviewchanged",lr)),u.setView(t),window.setTimeout(function(){ct&&lr()},100)}function of(){ot=!1}function sf(){ot=!1,wi(),rt(!0),yt(),yi(),s.currentZoom=u.getTargetZoom(),ki(),d=p[k],v(),ht=u.getTargetCenter(),kt(!0),n.invoke(a,"unlocked")}function li(t){sf(),n.invoke(a,"closed"),t.stopPropagation()}function tf(){var i=this.attributes.pathNodeLevel.value,r=st(i);ei(i),v(),l.groupList?rt(!0):di(r),n.invoke(a,"pathnodeclicked",{pathNodeLevel:i,pathNodeValue:r.value})}function tr(){di(st(this.attributes.pathNodeLevel.value))}function nr(){l.groupList&&rt()}function vt(n){ai(it.name,this.firstChild.nodeValue),rt(!0),i(n)}function ir(){var u,f,r;nt=null;if(l.groupList){n.removeHandler(ri),n.removeHandler(ui),u=l.groupList.childNodes,f=u.length;while(f--)r=t(u[f]),r.remove_event("click",vt),r.remove_event("touchstart",i),r.remove_event("touchend",vt);ri=null,ui=null,l.groupList.parentNode.removeChild(l.groupList),l.groupList=null,it=null}}function rt(n){l.groupList&&(n?(nt&&(clearTimeout(nt),nt=null),ir()):nt||(nt=setTimeout(ir,1e3)))}function gi(n){var i=l.groupList;if(i){var u=t(e).get_absolute_pos(),r=h.breadcrumb,o=t(r).get_absolute_pos().y+r.offsetHeight-u.y,f=t(l[n.name+"Container"]).get_absolute_pos().x-u.x;i.style.top=o+"px",i.style.left=f+"px"}}function di(n){var r,e,u,f;if(it)if(it!==n)rt(!0);else{nt&&(clearTimeout(nt),nt=null);return}r=document.createElement("ul"),l.groupList=r,it=n,r.className="pathList",r.style.position="absolute",r.setAttribute("pathNodeLevel",n.name),h.root.appendChild(r),ri=t(r).add_event("mouseenter",tr),ui=t(r).add_event("mouseleave",nr);for(e in n.values)u=document.createElement("li"),u.appendChild(document.createTextNode(n.values[e])),r.appendChild(u),f=t(u),f.add_event("click",vt),f.add_event("touchstart",i),f.add_event("touchend",vt);gi(n)}function rf(){c.country=null,c.state=null,c.county=null,c.city=null,c.neighborhood=null,c.street=null,c.current=null,c.countryBounds=null,c.stateBounds=null,c.countyBounds=null,c.cityBounds=null,c.neighborhoodBounds=null,c.streetBounds=null,c.currentBounds=null,c.countryEntityId=null,c.stateEntityId=null,c.countyEntityId=null,c.cityEntityId=null,c.neighborhoodEntityId=null,c.streetEntityId=null,c.currentEntityId=null,k=ut.world,d="world"}function oi(){hi=fr,et++,u.getCredentials(function(n){if(n){var t=yr+"/"+ht.latitude.toFixed(10)+","+ht.longitude.toFixed(10)+"?include=EntityId&includeEntityTypes=Neighborhood,PopulatedPlace,AdminDivision1,AdminDivision2,CountryRegion&output=json&jsonp=microsoftMapsNetworkCallback&key="+n+"&jsonso={jsono}&culture="+ii;at.getObjectAsync(t,ou,et)}})}function kt(n,t){n?(clearTimeout(g),g=null,oi()):(hi===cr&&g&&(clearTimeout(g),g=null),et++,hi=cr,g=t?setTimeout(oi,t):setTimeout(oi,uf))}function si(n){var o="",e=ut[n]+1,t;while(e-->1){var r=p[e],f=nu[r],i=s[r];if(f&&i)o+="&"+f+"="+i;else{ti();return}}n!=="street"&&(t=ar.get(s[n+"EntityId"])),t?(s[n+"Bounds"]=t,ti()):u.getCredentials(function(n){if(n){var t=yr+"?key="+n+"&jsonso={jsono}&culture="+ii+"&output=json&jsonp=microsoftMapsNetworkCallback"+o;at.getObjectAsync(t,kr,et)}})}function v(){var f=ut,u,n,i,r;wt.selectedCrumb=d;for(n in f)i=h[n],n!=="current"&&(n==="street"?i.firstChild.nodeValue="Near "+c[n]:(u=c[n],u||(u=""),i.firstChild.nodeValue=u),i.removeAttribute("title"),r=h[n+"Delim"],(ut[n]<=k||ot)&&c[n]?(i&&(i.style.display="inline",n===d?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&n!=="world"&&(r.style.display="inline")):(i&&(i.style.display="none"),r&&n!=="world"&&(r.style.display="none")));su(),vu()}function su(){for(var n,i,r,u=0,f=w.length;u<f;u++)n=w[u],i=l[n.name],i.firstChild.nodeValue=n.value,i.removeAttribute("title"),r=l[n.name+"Delim"],n.isVisible?(i&&(n.type==="group"?l[n.name+"Container"].style.display="inline":i.style.display="inline",n.name===d?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&(r.style.display="inline")):(i&&(n.type==="group"?(l[n.name+"Container"].style.display="none",rt(!0)):i.style.display="none"),r&&(r.style.display="none"))}function ou(n,t){var c=t.userData,h,e,f,o,u,r,i;if(c===et&&t.success&&n.statusCode===200){h=n.resourceSets[0],e=!1;if(h.estimatedTotal>0){f=h.resources,yi(),u=f.length;while(u--){r=f[u],o=r.entityType;if(bi[o]&&o!=="Neighborhood"){i=r.address,s.country=i.countryRegion,s.state=i.adminDistrict,s.county=i.adminDistrict2,s.city=i.locality,s.street=i.addressLine,s.countryEntityId=i.countryRegionEntityId,s.stateEntityId=i.adminDistrictEntityId,s.countyEntityId=i.adminDistrict2EntityId,s.cityEntityId=i.localityEntityId,s.streetEntityId=i.addressLineEntityId;break}}u=f.length;while(u--){r=f[u];if(r.entityType==="Neighborhood"){i=r.address,s.country=i.countryRegion,s.state=i.adminDistrict,s.county=i.adminDistrict2,s.neighborhood=i.locality,s.countryEntityId=i.countryRegionEntityId,s.stateEntityId=i.adminDistrictEntityId,s.countyEntityId=i.adminDistrict2EntityId,s.neighborhoodEntityId=i.localityEntityId;break}}e=!0}else rf(),v();wt={currentCrumb:p[k],selectedCrumb:d,country:s.country,state:s.state,county:s.county,neighborhood:s.neighborhood,city:s.city,street:s.street,location:n},e&&hu()}}function cu(n,t){var i=bi[n];s[i+"Bounds"]=t,ar.add(s[i+"EntityId"],t)}function hu(){wr=3,si("city"),si("state"),si("country")}function kr(n,t){var r=t.userData,i;r===et&&t.success&&n&&n.statusCode===200&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0&&(i=n.resourceSets[0].resources[0],cu(i.entityType,i.bbox)),ti()}function ti(){--wr||(c=s,ki(),wt.currentCrumb=p[k],n.invoke(a,"breadcrumbschanged"),v())}function iu(n){var t=u.getBounds();return!(n.width>t.width||n.height>t.height)}function eu(n){var i=u.getBounds(),t=Math.min(i.width/4,i.height/4);return n.width>=t||n.height>=t}function ki(){var n,u,t,r,f,i;if(ot){k=ut.neighborhood;return}for(n=0,u=p.length-1;n<u;n++)if(c[p[n]]){t=c[p[n]+"Bounds"];if(t){r=bt.fromEdges(t[2],t[1],t[0],t[3]);if(iu(r)){f=r,eu(r)&&(k=n);break}else k=n}else{i=c[p[n]+"Zoom"];if(i)if(i<c.currentZoom)k=n;else if(i<c.currentZoom+2){k=n;break}}}d=p[k]}function uu(){pi(),ht=u.getTargetCenter(),s.currentZoom=u.getTargetZoom(),kt(!1,5e3),er=n.addHandler(u,"viewchangeend",ru)}function ru(){pt.areEqual(u.getTargetCenter(),or)&&u.getTargetZoom()===hr||(yt(),ot===!1?(ht=u.getCenter(),s.currentZoom=u.getZoom(),kt()):v())}function ei(n){d!==n&&(d=n,v())}function rr(){g&&(clearTimeout(g),g=null),n.removeHandler(er),pr()}function vr(){dt&&(n.removeHandler(dt),dt=null,rr(),u.addComponent("breadcrumb",a))}var yr=f.Globals.bingMapsRESTServicesUrl,ii="en-us",dr=["cs-cz","da-dk","nl-nl","en-ca","en-gb","en-us","fi-fi","fr-ca","fr-fr","de-de","it-it","ja-jp","nb-no","pt-br","pt-pt","es-es","es-us","sv-se"],wr=0,ft=0,ni=null,et=0,ht,it,ri=null,ui=null,b={},gt,tu=!0,a=this,ot=!1,er,hf,lf="navigationBar",wt={},d="world",cf=0,fr="ready",cr="wait",hi=fr,or,hr,ct,g,uf=1e3,nt,w=[],c={world:fu,worldBounds:[-75,-175,75,175],countryZoom:4,stateZoom:7,countyZoom:10,cityZoom:13,neighborhoodZoom:15,streetZoom:16,current:""},s=c,ut={world:0,country:1,state:2,county:3,city:4,neighborhood:5,street:6,current:7},p=["world","country","state","county","city","neighborhood","street","current"],k=ut.world,h={},l={},ar={_cacheSize:100,_history:[],_recentlyUsed:[],_cache:{},add:function(n,t){if(!n)return;this._cache[n]=t,this._history.push(n),this._history.length>this._cacheSize&&delete this._cache[this._history.shift()]},get:function(n){return n?this._cache[n]:null}},nu={street:"addressLine",city:"locality",county:"adminDistrict2",state:"adminDistrict",country:"countryRegion"},bi={Dependent:"country",Sovereign:"country",CountryRegion:"country",AdminDivision1:"state",AdminDivision2:"county",PopulatedPlace:"city",Neighborhood:"neighborhood",Address:"street"},lt=f.Globals.locale,dt;lt&&(lt=lt.toLowerCase(),t(dr).index_of(lt)!==-1&&(ii=lt)),n.addHandler(u,"resize",pu),u.addComponent("breadcrumb",a),dt=n.addHandler(u,"ondispose",vr),a.enable=uu,a.disable=rr,a.dispose=vr,a.setWidth=nf,a.lockToLocation=ci,a.unlockFromLocation=of,a.showCloseButton=vi,a.hideCloseButton=wi,a.addCrumb=ku,a.removeCrumb=au,a.setVisibility=du,a.selectGroupItem=ai,a.highlightCrumb=ei,a.showBookmark=sr,a.hideBookmark=yt,a.relocateCloseButton=function(n,t){h.breadcrumbUnlock.style.top=n,h.breadcrumbUnlock.style.right=t},a.getBreadcrumbs=function(){return wt},this.enable()}function pu(u,f,e){function it(){v&&(n.removeHandler(v),v=null,a&&a.dispose(),t(w).remove_event("click",g).remove_event("mouseenter",c).remove_event("mouseleave",l),t(p).remove_event("click",nt).remove_event("mouseenter",c).remove_event("mouseleave",l),f.removeChild(h))}function nt(n){i(n),o(u,n),ct()?c():k(),u.setView({zoom:u.getTargetZoom()+1})}function g(n){i(n),o(u,n),ct()?c():k(),u.setView({zoom:u.getTargetZoom()-1})}function c(){b(),e.getZoomBarVisible()&&(s||(s=r("div","NavBar_zoomDrop"),s.style.cssText="position:absolute;display:none;",a=new cf(u,s,e.getZoomBarToggle()),h.firstChild?h.insertBefore(s,h.firstChild):h.appendChild(s),e.getZoomBarToggle()&&t(s).add_event("mouseenter",c).add_event("mouseleave",l)),s.style.display==="none"&&(s.style.display="",a.show()),ct()&&a.resetZoomBarTimer())}function l(){b(),y=window.setTimeout(k,1e3)}function k(){b(),e.getZoomBarToggle()&&s&&(s.style.display="none")}function b(){y&&(window.clearTimeout(y),y=null),d&&(window.clearTimeout(d),d=null)}var rt=this,h,p,w,s,a,y,d,v;h=r("div",e.getClassName()),tt(h),w=et("NavBar_zoomOut",sf),t(w).add_event("click",g).add_event("mouseenter",c).add_event("mouseleave",l).set_attr("uici","NB.ZC.ZoomOut"),p=et("NavBar_zoomIn",ff),t(p).add_event("click",nt).add_event("mouseenter",c).add_event("mouseleave",l).set_attr("uici","NB.ZC.ZoomIn"),e.getZoomOutVisible()&&h.appendChild(w),e.getZoomInVisible()&&h.appendChild(p),f.appendChild(h),e.getZoomBarToggle()||c(),e.getDomElement=function(){return h},v=n.addHandler(u,"ondispose",it),this.dispose=it}function wu(t,i,u){function v(){if(l){n.removeHandler(l),l=null;var t=o.length;while(t--)n.removeHandler(o[t][2]);h.dispose(),i.removeChild(f)}}var o=[["showmaptypemenu",function(n){e(c.getNavBar(t),"showmaptypemenu",n)}],["hidemaptypemenu",function(n){e(c.getNavBar(t),"hidemaptypemenu",n)}]],h,f=r("div",u.getClassName()),y,a,s,l;tt(f),y=r("span","NavBar_separator",f),a={disableBirdseye:u.getDisableBirdseye()},h=u.getMapTypes()!==null?new hf(t,f,this,a):new lf(t,f,this,a),i.appendChild(f),u.getDomElement=function(){return f},s=o.length;while(s--)o[s][2]=n.addHandler(h,o[s][0],o[s][1]);l=n.addHandler(t,"ondispose",v),this.dispose=v}function rf(t,i,u){function l(){e&&(n.removeHandler(e),n.removeHandler(a),e=null,i.removeChild(f))}for(var f=r("div",u.getClassName()),v=u.getLength(),c,s,a,e,o=0;o<v;o++)c=u.get(o),s=h.getRenderer(c),typeof s=="function"&&new s(t,f,c);u.getStopPropagation()&&tt(f),i.appendChild(f),u.getDomElement=function(){return f},a=n.addHandler(u,"entitychanged",function(n){n&&n.entity==u&&(n.handled=!0,f.className=u.getClassName(),u.getStopPropagation()?tt(f):fi(f))}),e=n.addHandler(t,"ondispose",l),this.dispose=l}function st(n){var u=n,i,r;t(n).add_class("shadowtextDark"),i=document.createElement("div"),i.className="bg",u.appendChild(i),r=document.createElement("div"),r.className="fg",u.appendChild(r),this.setColorsForDarkBackground=function(){t(u).swap_class("shadowtextDark","shadowtextLight")},this.setColorsForLightBackground=function(){t(u).swap_class("shadowtextLight","shadowtextDark")},this.setHtmlContent=function(n){r.innerHTML=n,i.innerHTML=n},this.setTextContent=function(n){st._clearChildNodes(r),st._clearChildNodes(i),r.appendChild(document.createTextNode(n)),i.appendChild(document.createTextNode(n))}}function tf(t,i,u){function h(){y(),e=window.setTimeout(b,d)}function y(){e!=null&&window.clearTimeout(e)}function b(){e=null,f.getCopyrights(k)}function k(n){for(var e=[n,c],u=0,f=[],s=1,o,r,t,i=0;i<e.length;i++)if(e)for(o=e[i]||[],r=0;r<o.length;r++)t=o[r],u+t.length>tt?(f.push("<br />"),u=0,s++):(f.push(nt),u+=it),f.push(t),u+=t.length;v.setHtmlContent(f.join("")),a.style.height=rt*s+"ex"}function l(){g.getImageryBackground(t.getImageryId())===g.light?v.setColorsForLightBackground():v.setColorsForDarkBackground()}function w(){if(o){n.removeHandler(o),o=null;var t=s.length;while(t--)n.removeHandler(s[t]);s.length=0}}var a=r("div",u.getClassName(),i),s,o,p;u.getDomElement=function(){return a};var v=new st(a),rt=2.5,tt=80,nt="&nbsp;&nbsp;&nbsp;",it=3,f=t,c=[],e=null,d=1e3;h(),l(),s=[n.addThrottledHandler(f,"copyrightchanged",h,2e3),n.addHandler(f,"imagerychanged",l),n.addHandler(f,"modechanged",l),n.addHandler(f,"viewchangestart",y)],o=n.addHandler(t,"ondispose",w),p=new function(){this.get_customAttributions=function(){return c},this.set_customAttributions=function(n){c=n,h()}},t.addComponent("copyright",p)}function gu(i,u,f){function ti(){var p,b,u,y;g=n.addHandler(i,"ondispose",gt),dt=rt.isIE6,a=r("div",f.getClassName(),tt),f.getDomElement=function(){return a},(wt||ct)&&(c=t(a),c.add_event("mouseover",yt).add_event("mouseout",lt).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s).add_event("click",s));if(wt){o=document.createElement("a"),o.href="#",o.target="mc_bingMaps",o.title=lu,w=o,n.addHandler(i,"viewchangeend",ft);try{ft()}catch(k){}}else o=document.createElement("div");o.id="PoweredByLogo",d(o,st),a.appendChild(o),ct&&(p=document.createElement("div"),p.className="LogoSearchContainer",b=document.createElement("div"),b.className="LogoSearchGroup",p.appendChild(b),u=document.createElement("input"),u.id="LogoSearchInput",rt.useXHR||(u.type="text"),u.maxLength=60,u.className="watermark",u.value=gi,v=!0,b.appendChild(u),y=document.createElement("input"),y.id="LogoSearchGo",rt.useXHR||(y.type="button"),y.title=cu,b.appendChild(y),e=t(p),e.set_style({display:"none"}),l=!1,e.add_event("mouseover",bt).add_event("mouseout",at).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s),it=t(y),it.add_event("blur",ut).add_event("focus",ot).add_event("click",et),h=t(u),h.add_event("blur",ht).add_event("focus",pt).add_event("keydown",vt),tt.appendChild(p))}function gt(){g&&(n.removeHandler(g),g=null),w&&n.removeHandler(ft),c&&c.remove_event("mouseover",yt).remove_event("mouseout",lt).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s).remove_event("click",s),tt.removeChild(a),e&&(e.remove_event("mouseover",bt).remove_event("mouseout",at).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s),it.remove_event("blur",ut).remove_event("focus",ot).remove_event("click",et),h.remove_event("blur",ht).remove_event("focus",pt).remove_event("keydown",vt),tt.removeChild(e.element())),y(),w=null,o=null,a=null,it=null,h=null,e=null,c=null}function d(n,t){dt&&(n.style.background="",n.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+p.domain+"/i/"+t+'", sizingMethod="scale")')}function y(){e&&b&&(window.clearTimeout(b),b=null)}function nt(){e&&k&&(y(),b=window.setTimeout(ri,2e3))}function kt(){v||h.element().value||(h.element().value=gi,h.add_class("watermark"),v=!0)}function ui(){v&&(h.element().value="",h.remove_class("watermark"),v=!1)}function ri(){b=null,ii(),k=!1}function ii(){e.set_style({display:"none"}),c.remove_class("Active"),d(o,st),e.set_style("width",null)}function ft(){if(w){var t=i.getCenter();t&&(w.href=p.logoBingMapsLink.replace("{0}",t.latitude).replace("{1}",t.longitude).replace("{2}",i.getZoom()))}}function bt(){y()}function at(){l||nt()}function ut(){l=!1,nt()}function ot(){l=!0,y()}function ht(n){ut(n),kt()}function pt(n){ot(n),ui()}function et(){var t=h.element().value,i;!v&&typeof t=="string"&&t.length>0&&(h.element().value="",kt(),t=of.encodeUrl(t),i=p.logoBingSearchUrl.replace("{0}",t),window.open(i,"mc_bingSearch"),nt())}function vt(n){l&&n.keyCode===13&&et()}function yt(){y(),e&&!k&&(e.set_style({display:""}),k=!0,c.add_class("Active"),d(o,ni))}function lt(){e?k&&!l&&nt():(c.remove_class("Active"),d(o,st))}var tt=u,wt=f.getClickable(),ct=f.getEnableSearch(),fi=this,dt=!1,o=null,k=!1,l=!1,v=!1,b=null,c=null,e=null,h=null,it=null,a=null,w=null,g,st="logo2.png",ni="logo_no_shadow2.png";ti()}function ii(n,i){function p(n){for(var r=Math.floor(n),i,t=0;t<s.length;t++){i=s[t];if(r>i)return i}return 1}function y(n,t){for(var r,i=0;i<h.length;i++){r=h[i];if(n>r)return r*t}return t}function r(n){var u=Math.log(n)/v,r=Math.floor(u),t=Math.pow(10,r),i=n/t;return 1===t?p(i):y(i,t)}var v=2.3025850929940459,e=n,c=i,a=0,l=0,s=[5,2],h=[5,2.5,2],o,f,u;t(e).add_class("ScaleBar"),o=document.createElement("div"),e.appendChild(o),f=new st(o),u=document.createElement("div"),u.className="scalerect",e.appendChild(u),this.getMaxWidth=function(){return a},this.setMaxWidth=function(n){return a=n,n},this.getActualWidth=function(){return l},this.setActualWidth=function(n){return l=n,n},this.setColorsForBackground=function(n){n===g.light?f.setColorsForLightBackground():f.setColorsForDarkBackground()},this.setScale=function(n){var u,t,i,o,f,e;c===lt.kilometersMeters?(o=n*this.getMaxWidth(),o>w.metersPerKm?(t=r(o/w.metersPerKm),u=Math.floor(t*w.metersPerKm/n),i=hr):(t=r(o),u=Math.floor(t/n),i=wr)):(f=n*w.feetPerMeter,e=f*this.getMaxWidth(),e>w.feetPerMile?(t=r(e/w.feetPerMile),u=Math.floor(t*w.feetPerMile/f),i=br):c===lt.milesFeet?(t=r(e),u=Math.floor(t/f),i=or):(t=r(e/w.feetPerYard),u=Math.floor(t*w.feetPerYard/f),i=pr)),this.setControlScale(u,i.replace("{num}",t))},this.setControlScale=function(n,t){this.setActualWidth(n+2),e.style.width=this.getActualWidth().toFixed()+"px",f.setTextContent(t),u.style.width=n.toFixed()+"px"}}function rr(n){var e=200,r=n,f,u,i;t(r).add_class("DoubleScaleBar"),_scaleBarMiElement=document.createElement("div"),f=new ii(_scaleBarMiElement,lt.milesFeet),f.setMaxWidth(e/2),r.appendChild(_scaleBarMiElement),u=document.createElement("div"),i=new ii(u,lt.kilometersMeters),i.setMaxWidth(e/2),u.style.right="0",r.appendChild(u),this.setBottomOffset=function(n){r.style.display="block",r.style.bottom=n.toFixed()+"px"},this.setColorsForBackground=function(n){i.setColorsForBackground(n),f.setColorsForBackground(n)},this.setScale=function(n){i.setScale(n),f.setScale(n),_scaleBarMiElement.style.right=(i.getActualWidth()+2).toFixed()+"px"}}function er(t,i,u){function s(){o.setScale(t.getMetersPerPixel())}function l(){o.setColorsForBackground(g.getImageryBackground(t.getImageryId()))}function c(){if(e){n.removeHandler(e),e=null;var t=f.length;while(t--)n.removeHandler(f[t]);f.length=0}}var h=r("div",u.getClassName(),i),o,f,e;u.getDomElement=function(){return h},o=new rr(h),o.setScale(t.getMetersPerPixel()),f=[n.addHandler(t,"viewchangeend",s),n.addHandler(t,"imagerychanged",l),n.addHandler(t,"modechanged",s)],e=n.addHandler(t,"ondispose",c)}function fr(i,r){function wt(n){var r=Math.round(i.getTargetZoom()),t=1<<r,u=new vt(r,Math.floor(n.x*t),Math.floor(n.y*t));return gt.fromTileId(u,!1)}function yt(){var n=i.getOptions().labelOverlay;tt=n===d.hidden?!0:r}function kt(){var n=null,t=i.getImageryId();switch(t){case"Road":n=ti;break;case"Aerial":n=ii;break;case"EnhancedBirdseye":case"NativeBirdseye":o.removeLayer(a),a=null;break;default:h.removeLayer(a),a=null,ht()}n!==a&&(ut(),h.removeLayer(a),h.addLayer(n),a=n,it())}function ui(n){w=n}function ri(){s&&(n.removeHandler(s),s=null,c||(w=null,c=n.addHandler(i,"mousemove",ui)),e&&st())}function it(){c&&(n.removeHandler(c),c=null),s||(s=n.addHandler(i,"mousemove",et));var r=Math.round(i.getTargetZoom()),t=l.getMapTargetMercatorBounds(i);h.loadQuadkeysForMercatorBounds(t,r),w&&(et(w),w=null)}function oi(n){return y&&(window.clearTimeout(y),y=null),n.handled=!1,!1}function ei(n){if(n.targetType!=="map"&&n.target.pointerEvents!=="none"||n.mouseMoved)return n.handled=!1,!1;if(y)return n.handled=!0,!0;var i=new u(n.getX(),n.getY()),t=ct(i);return t?(y=window.setTimeout(function(){fi(t.hotRegion,i,t.worldPoint)},250),n.handled=!0,!0):(n.handled=!1,!1)}function fi(t,r,u){var l,f;y=null,l={hotRegion:t,cancelDefault:!1,clickLocation:i.tryPixelToLocation(r)},n.invoke(o,"click",l),f=t.bmv;if(!l.cancelDefault&&f){var c=f.tl,a=f.br,v=f.z,e=f.c,s=360*Math.floor(u.x),h=180*Math.floor(u.y);c&&a?i.setView({bounds:bt.fromEdges(c.y+h,c.x+s,a.y+h,a.x+s),animate:!0}):e&&v&&i.setView({center:new pt(e.y+h,e.x+s),zoom:v,animate:!0})}}function ct(n){var s=i.getMode().tryPixelToMercatorPoint,t,l,r,e,f,o;if(s){t=s(n),l=new u(t.x,t.y),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1;var v=wt(t),c=h.getTileHotRegionsForQuadkey(v),a=c.length;while(a--){r=c[a];if(tt&&r.type==="label")continue;if(r.getMercatorBounds().contains(t)){e=r.boundRegions,f=e.length;while(f--){o=e[f];if(o.getMercatorBounds().contains(t))if(o.isMercatorPointInBoundRegion(t))return{hotRegion:r,worldPoint:l}}}}}return null}function st(){var t={hotRegion:e,cancelDefault:!1};n.invoke(o,"leave",t),!t.cancelDefault&&v&&(ft.set_style({cursor:v}),v=null),e=null}function et(i){var s;if(i.targetType!=="map"&&i.target.pointerEvents!=="none")if(e)var c=!0,l=!1,f=null;else return;if(!c)var a=new u(i.getX(),i.getY()),h=ct(a),f=h&&h.hotRegion,c=e&&(!f||f.id!==e.id),l=f&&(!e||e.id!==f.id);c&&st(),e=f,l&&(s={hotRegion:f,cancelDefault:!1},n.invoke(o,"enter",s),!s.cancelDefault&&f&&f.bmv&&(!r||f.type!=="label")&&(v=ft.get_style("cursor"),rt.isWebkit&&v.toLowerCase().indexOf("/cursors/grab.cur")!==-1?v=lt.Grab:t.Browser.is_ie&&(v+=", "+lt.Grab),ft.set_style({cursor:"pointer"})))}function ut(){s||(s=n.addHandler(i,"mousemove",et)),b||(b=n.addHandler(i,"click",ei)),nt||(_mapMouseClickDoubleHandle=n.addHandler(i,"dblclick",oi)),g||(g=n.addHandler(i,"viewchangeend",it)),k||(k=n.addHandler(i,"viewchangestart",ri))}function ht(){c&&(n.removeHandler(c),c=null),s&&(n.removeHandler(s),s=null),b&&(n.removeHandler(b),b=null),nt&&(n.removeHandler(nt),nt=null),g&&(n.removeHandler(g),g=null),k&&(n.removeHandler(k),k=null),e&&st()}function at(){h.getLayerCount()>0?ut():ht()}var o=this,s,b,nt,dt,ni,g,k,tt=r,h=new ir,lt={Grab:"url("+p.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},ft=t(i.getRootElement()),v=null,e=null,ti=new ot(f.Globals.hotRegionsRoadUrl,null,i),ii=new ot(f.Globals.hotRegionsAerialWithLabelsUrl,null,i),a=null,w,c,y;o.enable=function(){ut(),dt=n.addHandler(i,"maptypechanged",yt),ni=n.addHandler(i,"imagerychanged",kt),yt(),kt()},o.disable=function(){ht(),n.removeHandler(ni),n.removeHandler(dt),e=null},o.createLayer=function(n,t,i){return new ot(n,t,i)},o.addLayer=function(n,t){h.addLayer(n,t),at(),it()},o.removeLayer=function(n){h.removeLayer(n),at()},i.addComponent("hotRegions",o),o.enable()}function yt(n,t){function a(n){var i=[],r=n.length,t;while(r--)t=n[r],i.push(new u(t.x,t.y));return i}var i,e,f,r,o,c,s;n.boundRegions=[];var v=n.boundRegions,l=n.brs,h=l.length;while(h--)i=l[h],tr(i)?(r=a(i),r.push(r[0]),e=new ni(t,r),v.push(e)):i&&i.x&&i.y&&i.r&&(e=new dt(t,new u(i.x,i.y),i.r),v.push(e));if(n.hbrs){n.highlightBoundRegions=[];var p=n.highlightBoundRegions,y=n.hbrs,h=y.length;while(h--){f=y[h];if(f)switch(f.t){case"polygon":r=a(f.v),r.push(r[0]),o=new ni(t,r),p.push(o);break;case"circle":o=new dt(t,new u(f.x,f.y),f.r),p.push(o)}}}return c=/^YN/i,s=n.ypid,s&&c.test(s)&&(n.ypid=s.substring(2)),n.getLocationCenter=yt.prototype.getLocationCenter,n.getMercatorBounds=yt.prototype.getMercatorBounds,n}function hi(n){this.hotRegions=n}function ni(n,t){this._tileId=n,this._quadkeyTilePoints=t}function dt(n,t,i){this._tileId=n,this._quadkeyTilePointCenter=t,this._quadkeyTilePointRadius=i}function vr(i){function b(n){var r=!1,t;return n.hotRegion.type==="vm"&&(f.VenueMaps?(s||(s=new f.VenueMaps.VenueMapFactory(i)),t=s.getActiveVenueMap(),t&&n.hotRegion.vmid===t.id||(r=!0)):r=!0),r}function ht(n){b(n)&&(n.cancelDefault=!0,o!==n.hotRegion.vmid&&it(n.hotRegion.vmid))}function ct(n){b(n)&&(n.cancelDefault=!0,e=c.get_style("cursor"),rt.isWebkit&&e.toLowerCase().indexOf("/cursors/grab.cur")!==-1?e=k.Grab:t.Browser.is_ie&&(e+=", "+k.Grab),o===n.hotRegion.vmid?c.set_style({cursor:"wait"}):c.set_style({cursor:"pointer"}),u=n.hotRegion,st())}function at(n){b(n)&&(e&&(c.set_style({cursor:e}),e=null),w(),u=null)}function w(){g(),l&&(i.entities.remove(l),l=null)}function st(){var r,f,n,t;w();if(u){l=new ki({zIndex:-1}),r=u.highlightBoundRegions?u.highlightBoundRegions:u.boundRegions,f=r.length;while(f--)n=r[f],n.type==="polygon"&&(t=new iu(n.getLocations(),{strokeThickness:1,strokeColor:new si(255,0,0,0),fillColor:new si(0,0,0,0)}),t.pointerEvents="none",l.push(t));i.entities.push(l),o!==u.vmid&&vt()}}function vt(){if(!r){d=n.addHandler(i,"mousemove",lt),r=document.createElement("span"),r.style.cssText="position:absolute;visibility:hidden;background-color:white;border: 1px solid black;padding:5px;";var t=u.name?nr.replace("{0}",u.name):nr.replace(" {0}","");r.appendChild(document.createTextNode(t)),i.getRootElement().appendChild(r)}}function g(){r&&(n.removeHandler(d),r.parentNode.removeChild(r),r=null)}function lt(n){r.style.visibility="visible",r.style.left=i.getWidth()/2+16+n.getX()+"px",r.style.top=i.getHeight()/2+16+n.getY()+"px"}function ot(){a||(a=n.addHandler(i.getComponent("hotRegions"),"click",ht),y=n.addHandler(i.getComponent("hotRegions"),"enter",ct),v=n.addHandler(i.getComponent("hotRegions"),"leave",at))}function tt(){a&&(n.removeHandler(a),a=null),y&&(n.removeHandler(y),y=null),v&&(n.removeHandler(v),v=null)}function it(n){et(n),f.loadModule("Microsoft.Maps.VenueMaps",{callback:function(){s||(s=new f.VenueMaps.VenueMapFactory(i));var t=s.getActiveVenueMap();t&&t.dispose(),s.create({venueMapId:n,success:ut,error:ft})}})}function ut(n){if(o===n.id){var r=n.bestMapView;r.animate=!0,i.setView(r),n.show(),nt(!0)}}function et(t){o=t,u&&(c.set_style({cursor:"wait"}),g()),n.invoke(h,"activationstart",t)}function nt(t){var i=o;o=null,u&&(e&&(c.set_style({cursor:e}),e=null),w()),n.invoke(h,"activationend",{isSuccess:t,venueMapId:i})}function ft(n,t){o===t.venueMapId&&nt(!1)}var h=this,a,y,v,s,o,e,k={Grab:"url("+p.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},c=t(i.getRootElement()),u,l,r,d;h.enable=function(){ot()},h.disable=function(){tt(),o=null},i.addComponent("venueMapsExplorer",h),h.enable()}function b(){return null}function cr(n,t){function e(r,u){var s,f,e;r||u&&u.httpStatus===401?(s=r&&r.authenticationResultCode=="ValidCredentials",i=s&&typeof r.sessionId=="string"&&r.sessionId.length>0?r.sessionId:null,s||(f=document.createElement("div"),f.style.cssText="position:absolute; width:100%; top:50%; text-Align:center",e=document.createElement("div"),e.innerHTML=sr,e.style.cssText="background: #f8f7f5; padding:10px; color: #000;",f.appendChild(e),n.getRootElement().appendChild(f))):i=t,o()}var f=this,u=p.logServiceUriFormat,r,s,i;if(u){r=[],u=u.replace(/{credentials}/,t),this.getCredentials=function(n){r.push(n)};function o(){f.getCredentials=function(n){n(i)};var n=r.length;while(n--)f.getCredentials(r[n])}at.getObjectAsyncWithNoJsonso(u,e,ti.getNext(),1e4)}else i=t,this.getCredentials=function(n){n(i)}}function h(t){function r(n){if(!n||n.handled!==!0){f&&f.dispose();var i=h.getRenderer(t.overlays);typeof i=="function"&&(f=new i(t,t.getRootElement(),t.overlays))}}var f,u=[["entityadded",r],["entityremoved",r],["entitychanged",r]],i=u.length;while(i--)u[i][2]=n.addHandler(t.overlays,u[i][0],u[i][1]);this.update=r}function ai(n){this.setOptions(n)}function pi(n){this.setOptions(n)}function yi(n){this.setOptions(n)}function ut(n){ut.baseConstructor.call(this,n),this.setOptions(n)}function wi(n){this.setOptions(n)}function vi(n){this.setOptions(n)}function bi(n){this.setOptions(n)}function ri(n){this.setOptions(n)}var f=window.Microsoft.Maps,a=f.InternalNamespaceForDelay,ci=a.Common,yr=a.DelayMap,ti=a.IdGenerator,at=a.Network,ei=a.PRF,v,g,lt,w,ft,k;ei.start("mapdelay");var sr='Invalid Credentials. Sign up for a developer account at: <a href="http://www.microsoft.com/maps/developers">http://www.microsoft.com/maps/developers</a>',hr="{num} km",wr="{num} m",br="{num} miles",pr="{num} yds",or="{num} feet",nf="Click to pan in any direction",uf="Rotate left",ku="Rotate right",ff="Zoom in",sf="Zoom out",yu="Move slider to zoom in or out",tu="N",uu="Automatic",ru="Switches to the best map style as you zoom",dr="Road",kr="A standard road map",nu="Aerial",gr="A detailed look from above",ur="Bird's eye",su="A better angle of aerial photography",hu="London Street Map",eu="Detailed maps for Greater London",ou="Ordnance Survey Map",au="Maps for outdoor life",li="show labels",vu="show angled view",gi="Search on Bing",cu="Search on Bing",lu="Bing Maps",fu="World",nr="View {0} Map",t=f.Gimme,p=f.Globals,yf=f.Map,u=f.Point,d=f.LabelOverlay,n=f.Events,bt=f.LocationRect,pt=f.Location,af=f.Pushpin,y=f.MapTypeId,ki=f.EntityCollection,nt=a.MercatorCube,di=a.SpatialCache,gt=f.QuadKey,vt=a.TileId,vf=f.AltitudeReference,kt=a.Rect,si=f.Color,iu=f.Polygon,ht=a.MapMath,rt=a.Quirks,of=a.IOSec,c=new function(){function s(n,t,i){var r=document.createElement(n||"div");return t&&(r.className=t),i&&i.appendChild(r),r}function e(n){var i,t=u.length;while(t--)u[t][0]===n&&(i=u[t][1]);return i}function o(t,i,r){n.invoke(t,i,r)}function f(n){n.stopPropagation()}function r(n){h=!0,n.stopPropagation()}var u=[],h=!1;this.addIgnoreEvents=function(n){t(n).add_event("mousedown",i).add_event("mouseup",i).add_event("mousewheel",i).add_event("dblclick",i).add_event("contextmenu",i).add_event("keydown",f).add_event("keyup",i).add_event("click",i).add_event("touchstart",r).add_event("touchmove",r).add_event("touchend",r).add_event("touchcancel",r)},this.removeIgnoreEvents=function(n){t(n).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousewheel",i).remove_event("dblclick",i).remove_event("contextmenu",i).remove_event("keydown",f).remove_event("keyup",i).remove_event("click",i).remove_event("touchstart",r).remove_event("touchmove",r).remove_event("touchend",r).remove_event("touchcancel",r)},this.createElement=s,this.createToolButton=function(n,t){var i=s("a","NavBar_button NavBar_toolButton "+(n||""));return i.href="#",t&&(i.title=t),i},this.registerNavigationBar=function(n,t){u.push([n,t])},this.removeNavigationBar=function(n){var t=u.length;while(t--)if(u[t][0]===n){u.splice(t,1);break}},this.reportAction=function(n,t){var r=e(n),i;r&&(i=t.currentTarget,i&&o(r,"navbaraction",{id:i.id,typeName:i.className,title:i.title}))},this.getNavBar=e,this.invokeEvent=o,this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=f,this.isTouch=function(){return h},this.addClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n+(n.search(i)===-1?" "+t:"")},this.removeClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n.replace(i,"$1").replace(/^\s+|\s+$/g,"")}},it={auto:{title:uu,description:ru},r:{title:dr,description:kr},a:{title:nu,description:gr},be:{title:ur,description:su},cb:{title:hu,description:eu},os:{title:ou,description:au}};v={left:0,middle:1,right:2,getName:function(n){switch(n){case v.left:return"left";case v.middle:return"middle";case v.right:return"right"}return""},isValid:function(n){return n===v.left||n===v.middle||n===v.right}},f.ClientRegion=v,st._clearChildNodes=function(n){if(n.hasChildNodes&&n.removeChild)while(n.hasChildNodes())n.removeChild(n.firstChild)},g={light:0,dark:1},g.getImageryBackground=function(n){return n==="Aerial"||n==="EnhancedBirdseye"||n==="NativeBirdseye"?g.dark:g.light},lt={milesFeet:0,milesYards:1,kilometersMeters:2},w={metersPerKm:1e3,yardsPerMeter:1.0936133,yardsPerMile:1760,feetPerYard:3,feetPerMeter:3.2808399,feetPerMile:5280},yt.prototype={getLocationCenter:function(){var i=this.highlightBoundRegions?this.highlightBoundRegions:this.boundRegions,f=0,e=0,n=i.length,r=n,t;while(r--)t=i[r].getMercatorCenter(),f+=t.x,e+=t.y;return this._locationCenter=nt.toLocation(new u(f/n,e/n)),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorBounds:function(){var i=null,t=null,u=null,f=null,h=this.boundRegions,r=this.boundRegions.length-1,n;if(r>-1){n=h[r].getMercatorBounds(),i=n.y,t=n.x,u=n.getRight(),f=n.getBottom();while(r--){var n=h[r].getMercatorBounds(),c=n.y,s=n.x,e=n.getRight(),o=n.getBottom();c<i&&(i=c),o>f&&(f=o),s<t&&(t=s),e>u&&(u=e)}}return this._mercatorBounds=new kt(t,i,u-t,f-i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds}},hi.prototype={getHotRegionsForTile:function(n){var r={},v,s,t,a,e,f;for(this._tileIndexedHotRegions=r,v=n.length,s=this.hotRegions,t=0,a=s.length;t<a;t++){var o=s[t],i=o.getMercatorBounds(),y=new u(i.x,i.y),p=new u(i.getRight(),i.getBottom()),w=l.getMercatorBoundsDescriptor(y,p,v),h=l.getQuadkeysForBounds(w),c=h.length;while(c--)e=h[c],f=r[e],f?f.push(o):r[e]=[o]}return this.getHotRegionsForTile=function(n){var t=this._tileIndexedHotRegions[n];return t?t:[]},this.getHotRegionsForTile(n)}};var ot=function(n,t,i){function k(n,t){return n.z-t.z}function h(n){var t;return t=n==="l1"?1:n==="l2"?2:n.length+2}function it(n,t){var e=h(n),o=f[e],r=c[e],p,y,a,u,w,v;o||(o=f[e]={},r=c[e]=[]);if(o[n])return!1;o[n]=t,r.push(n),p=(Math.ceil(i.getHeight()/1024)+2*s)*(Math.ceil(i.getWidth()/1024)+2*s);while(r.length>p){for(y||(y=nt(l.getMapTargetMercatorBounds(i),Math.max(e-2,0))),a=!1,u=0,w=r.length;u<w;u++)if(tt(y,r[u])===-1){v=r.splice(0,u+1),delete o[v.pop()],r=r.concat(v),a=!0;break}if(!a)break}return!0}function tt(n,t){var i=n.length;while(i--)if(n[i]===t)return i;return-1}function nt(n,t){var f=new u(n.left,n.top),r=new u(n.right,n.bottom),i=l.getMercatorBoundsDescriptor(f,r,t);return l.getQuadkeysForBounds(i)}function b(n,t){var i,f,e;delete r[t];if(n&&w(n.hrs)){i=null,i=t==="l1"?new vt(-1,0,0):t==="l2"?new vt(0,0,0):gt.toTileId(t);var u=[],o=n.hrs,s=o.length;while(s--)f=new yt(o[s],i),u.push(f);u.sort(k),e=new hi(u),it(t,e)}}function o(i){var a=h(i),l=f[a],u,o,e,c,s;l&&l[i]||(y(),r[i]||(r[i]={requestTime:+new Date},u="",o="",i==="l1"?o="&lod=1":i!=="l2"&&(u=i),e="0",u!==""&&(e=u.charAt(u.length-1)),c=typeof t=="function"?t(i):n,s=c.replace("{subdomain}",e).replace("{quadkey}",u).replace("{jsonp}",g).replace("{jsonso}",encodeURIComponent(n+"|"+i))+o,at.getObjectAsyncCacheFriendly(s)))}function a(){r={}}function y(){var i=+new Date,t,n;for(t in r)n=r[t].requestTime,n&&i-n>d&&delete r[t]}function v(n){var r=l.tileQuadkeyToSheetQuadkey(n),u=n.length,i=f[u],t;if(i){t=i[r];if(t)return t.getHotRegionsForTile(n);o(r)}return[]}function p(n,t){var i;if(t===1)o("l1");else if(t===2)o("l2");else{var c=Math.max(t-2,0),v=new u(n.left,n.top),h=new u(n.right,n.bottom),a=l.getMercatorBoundsDescriptor(v,h,c),s=l.getQuadkeysForBounds(a),e=f[t],r=s.length;while(r--)i=s[r],e&&e[i]||o(i)}}function w(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"}var e=this,g="microsoftMapsHotRegionsCacheCallback",f={},c={},s=1,d=1e4,r={};e.getTileHotRegionsForQuadkey=v,e.loadQuadkeysForMercatorBounds=p,e.getHotRegionsNetworkCallback=b,e.clearRequestedQuadkeys=a,e.getUrl=function(){return n}},ir=function(){function i(t){var i=n.length;while(i--)if(n[i].layer.getUrl()===t)return i;return null}function o(t,r){if(r){var f=decodeURIComponent(r).split("|"),e=f[0],o=f[1],u=i(e);u!==null&&n[u].layer.getHotRegionsNetworkCallback(t,o)}}function c(t){var i=[],r=n.length;while(r--)i=i.concat(n[r].layer.getTileHotRegionsForQuadkey(t));return i}function h(t,i){var r=n.length;while(r--)n[r].layer.loadQuadkeysForMercatorBounds(t,i)}function u(n,t){return t.zIndex-n.zIndex}function r(t,r){t instanceof ot&&(r||(r=0),i(t.getUrl())===null&&(n.push({zIndex:r,layer:t}),n.sort(u)))}function e(t){if(t instanceof ot){var r=i(t.getUrl());r!==null&&(n.splice(r,1),t.clearRequestedQuadkeys())}}function f(){return n.length}var t=this,s="microsoftMapsHotRegionsCacheCallback",n=[];t.addLayer=r,t.removeLayer=e,t.getLayerCount=f,t.getTileHotRegionsForQuadkey=c,t.loadQuadkeysForMercatorBounds=h,window[s]=o},l=new function(){this.tilePixelToLocation=function(n,t){var u=this._tilePixelToMapPixel(n,t),r=this._mapPixelToMercatorPoint(n.levelOfDetail,u);return nt.toLocation(r)},this.tilePixelToMapPixel=function(n,t){return new u(n.x*1024+t.x,n.y*1024+t.y)},this.mapPixelToMercatorPoint=function(n,t){var i,r;return i=n<0?1/(1<<Math.abs(n)):1<<n,r=new u(t.x/i/1024,t.y/i/1024)},this.getMapTargetMercatorBounds=function(n){var r=n.getMode().tryPixelToMercatorPoint,f,t;if(r){var e=n.getHeight()/2,o=n.getWidth()/2,s=new u(-o,-e),i=r(s);return i.x=(i.x%1+1)%1,i.y=(i.y%1+1)%1,f=new u(o,e),t=r(f),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1,{left:i.x,right:t.x,top:i.y,bottom:t.y}}return null},this.getQuadkeysForBounds=function(n){var h=n.levelOfDetails,o=n.tileIdXCount,c=n.tileIdYCount,a=n.tileIdX0,l=n.tileIdY0,s=n.tileIdCount,r=[],i,u,e,t,f;while(o--){i=c,u=(a+o)%s;while(i--)e=(l+i)%s,t=gt.fromTileId(new vt(h,u,e)),t.length===0&&(f=0,f++),r.push(t)}return r},this.getMercatorBoundsDescriptor=function(n,t,i){var u=di.mercatorXYToTileId(n,i),o=di.mercatorXYToTileId(t,i),r=1<<i,s=(o.x-u.x+r)%r+1,h=u.x,e,f;return s===1&&t.x<n.x&&(s=r,h=0),f=(o.y-u.y+r)%r+1,e=u.y,f===1&&t.y<n.y&&(f=r,e=0),{mercatorTL:n,mercatorBR:t,levelOfDetails:i,tileIdTL:u,tileIdBR:o,tileIdX0:h,tileIdY0:e,tileIdXCount:s,tileIdYCount:f,tileIdCount:r}},this.tileQuadkeyToSheetQuadkey=function(n){var i=n.length,t="l1";return i>2?t=n.substr(0,i-2):i===2&&(t="l2"),t}};ni.prototype={type:"polygon",getLocations:function(){var n,t;this._locations=[];var r=this._locations,u=this.getMercatorPoints(),i=u.length;while(i--)n=u[i],t=nt.toLocation(n),r.push(t);return this.getLocations=function(){return this._locations},r},getMercatorPoints:function(){var n,t;this._mercatorPoints=[];var r=this._mercatorPoints,u=this.getMapPixels(),i=u.length;while(i--)n=u[i],t=l.mapPixelToMercatorPoint(this._tileId.levelOfDetail,n),r.push(t);return this.getMercatorPoints=function(){return this._mercatorPoints},r},getMapPixels:function(){var t;this._mapPixels=[];var i=this._mapPixels,r=this._quadkeyTilePoints,n=r.length;while(n--)t=l.tilePixelToMapPixel(this._tileId,r[n]),i.push(t);return this.getMapPixels=function(){return this._mapPixels},i},getMercatorBounds:function(){var e=null,o=null,f=null,u=null,t=this.getMercatorPoints(),n=t.length-1,i,r;if(n>-1){e=f=t[n].x,o=u=t[n].y;while(n--)i=t[n].x,r=t[n].y,i>e?e=i:i<f&&(f=i),r>o?o=r:r<u&&(u=r)}return this._mercatorBounds=new kt(f,u,e-f,o-u),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){for(var i=this.getMercatorPoints(),h=i.length-1,l=n.x,e=n.y,f=!1,t=0,r=h-1;t<h;r=t++){var u=i[t].y,o=i[r].y,s=i[t].x,c=i[r].x;u>e!=o>e&&l<(c-s)*(e-u)/(o-u)+s&&(f=!f)}return f}},dt.prototype={getLocations:function(){var n=this.getMercatorBounds(),o=new u(n.x,n.y),e=new u(n.getRight(),n.y),h=new u(n.getRight(),n.getBottom()),s=new u(n.x,n.getBottom()),t=nt.toLocation(o),r=nt.toLocation(e),i=nt.toLocation(h),f=nt.toLocation(s);return this._locationBounds=[t,r,i,f,t],this.getLocations=function(){return this._locationBounds},this._locationBounds},type:"circle",getLocationCenter:function(){return this._locationCenter=nt.toLocation(this.getMercatorCenter()),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorCenter:function(){return this._mercatorCenter=l.mapPixelToMercatorPoint(this._tileId.levelOfDetail,this.getMapCenter()),this.getMercatorPoints=function(){return this._mercatorCenter},this._mercatorCenter},getMercatorRadius:function(){return this._mercatorRadius=l.mapPixelToMercatorPoint(this._tileId.levelOfDetail,new u(0,this._quadkeyTilePointRadius)).y,this.getMercatorRadius=function(){return this._mercatorRadius},this._mercatorRadius},getPixelRadius:function(){return this._quadkeyTilePointRadius},getMapCenter:function(){return this._mapCenter=l.tilePixelToMapPixel(this._tileId,this._quadkeyTilePointCenter),this.getMapCenter=function(){return this._mapCenter},this._mapCenter},getMercatorBounds:function(){var i=this.getMercatorCenter(),n=this.getMercatorRadius(),t=2*n;return this._mercatorBounds=new kt(i.x-n,i.y-n,t,t),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){var r=this.getMercatorCenter(),u=this.getMercatorRadius(),t=n.x-r.x,i=n.y-r.y;return t*t+i*i-u*u<=0}};var i=c.ignoreEvent,s=c.stopPropagation,o=c.reportAction,e=c.invokeEvent,r=c.createElement,et=c.createToolButton,tt=c.addIgnoreEvents,fi=c.removeIgnoreEvents,ct=c.isTouch,wt=c.addClass,lr=c.removeClass,ar=ci.extend,tr=ci.isArray;ft=yr.prototype,ft.showOverlays=function(t){var r,i,s,u,c,f,e,l,o;if(this._map){r=this._map,i=new ut({className:"MicrosoftNav"}),t.showDashboard!==!1&&(t.showDualMapTypeSelector&&(i.setOptions({className:wt(i.getClassName(),"NavBar_typeButton_count2")}),t.mapTypes=[]),u=new ut({className:"OverlaysTL",stopPropagation:!0}),t.showBreadcrumb===!0&&(i.setOptions({className:wt(i.getClassName(),"NavBar_breadcrumb")}),u.push(new ri(t))),u.push(new yi),u.push(new pi),t.showMapTypeSelector!==!1&&(c=new ai(t),u.push(c),s=new du(r,u,c)),i.push(u)),(t.showScalebar!==!1||t.showCopyright!==!1)&&(f=new ut({className:"OverlaysBR"}),t.showScalebar!==!1&&f.push(new bi),t.showCopyright!==!1&&f.push(new wi),i.push(f)),t.showLogo!==!1&&i.push(new vi(t));function a(){var n=i.getClassName();e&&(n=lr(n,"MapTypeId_"+e)),e=r.getMapTypeId(),n=wt(n,"MapTypeId_"+e),i.setOptions({className:n})}l=n.addHandler(r,"maptypechanged",a),a();function v(){o&&(n.removeHandler(o),o=null,n.removeHandler(l))}o=n.addHandler(r,"ondispose",v),r.overlays=i,n.invoke(r,"overlayscreationstart",{map:r,overlays:i}),this._overlays||(this._overlays=new h(r),this._overlays.update()),s&&r.addComponent("navigationBar",s)}},ft.showHotRegions=function(n){this._map&&new fr(this._map,n)},ft.showVenueMapsExplorer=function(){this._map&&new vr(this._map)},ft.authenticate=function(n){this._map&&(this._authentication=new cr(this._map,n))},ft.getCredentials=function(n){this._map&&this._authentication.getCredentials(n)},h.renderers={},h.registerOverlay=function(n,t){h.renderers[n]=t},h.getRenderer=function(n){return h.renderers[n.toString()]},ai.prototype={_className:"NavBar_modeSelectorControlContainer",_mapTypes:null,_disableBirdseye:!1,getDomElement:b,getClassName:function(){return this._className},getMapTypes:function(){return this._mapTypes},getDisableBirdseye:function(){return this._disableBirdseye},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),tr(t.mapTypes)&&(this._mapTypes=t.mapTypes,i=!0),typeof t.disableBirdseye=="boolean"&&(this._disableBirdseye=t.disableBirdseye,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ModeSelectorControl]"}},h.registerOverlay("[ModeSelectorControl]",wu),pi.prototype={_className:"NavBar_zoomControlContainer",_zoomInVisible:!0,_zoomOutVisible:!0,_zoomBarVisible:!0,_zoomBarToggle:!0,getDomElement:b,getClassName:function(){return this._className},getZoomInVisible:function(){return this._zoomInVisible},getZoomOutVisible:function(){return this._zoomOutVisible},getZoomBarVisible:function(){return this._zoomBarVisible},getZoomBarToggle:function(){return this._zoomBarToggle},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.zoomInVisible=="boolean"&&(this._zoomInVisible=t.zoomInVisible,i=!0),typeof t.zoomOutVisible=="boolean"&&(this._zoomOutVisible=t.zoomOutVisible,i=!0),typeof t.zoomBarVisible=="boolean"&&(this._zoomBarVisible=t.zoomBarVisible,i=!0),typeof t.zoomBarToggle=="boolean"&&(this._zoomBarToggle=t.zoomBarToggle,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ZoomControl]"}},h.registerOverlay("[ZoomControl]",pu),yi.prototype={_className:"NavBar_compassControlContainer",_compassVisible:!0,_rotateVisible:!0,getDomElement:b,getClassName:function(){return this._className},getCompassVisible:function(){return this._compassVisible},getRotateVisible:function(){return this._rotateVisible},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.compassVisible=="boolean"&&(this._compassVisible=t.compassVisible,i=!0),typeof t.rotateVisible=="boolean"&&(this._rotateVisible=t.rotateVisible,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CompassControl]"}},h.registerOverlay("[CompassControl]",ef),ar(ut,ki),k=ut.prototype,k.getDomElement=b,k._className="",k.getClassName=function(){return this._className},k._stopPropagation=!1,k.getStopPropagation=function(){return this._stopPropagation},k.setOptions=function(t,i){var r=ut.superClass.setOptions.call(this,t,!0);return t&&(typeof t.className=="string"&&(this._className=t.className,r=!0),typeof t.stopPropagation=="boolean"&&(this._stopPropagation=t.stopPropagation,r=!0)),r&&!i&&n.invoke(this,"entitychanged",{entity:this}),r},k.toString=function(){return"[OverlayEntityCollection]"},h.registerOverlay("[OverlayEntityCollection]",rf),wi.prototype={_className:"CopyrightContainer",getDomElement:b,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CopyrightControl]"}},h.registerOverlay("[CopyrightControl]",tf),vi.prototype={_className:"LogoContainer",_clickable:!0,_enableSearch:!0,getDomElement:b,getClassName:function(){return this._className},getClickable:function(){return this._clickable},getEnableSearch:function(){return this._enableSearch},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.clickable=="boolean"&&(this._clickable=t.clickable,i=!0),typeof t.enableSearch=="boolean"&&(this._enableSearch=t.enableSearch,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[LogoControl]"}},h.registerOverlay("[LogoControl]",gu),bi.prototype={_className:"ScaleBarContainer",getDomElement:b,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ScalebarControl]"}},h.registerOverlay("[ScalebarControl]",er),ri.prototype={_className:"BreadcrumbContainer",getDomElement:b,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[BreadcrumbControl]"}},h.registerOverlay("[BreadcrumbControl]",bu),delete window.Microsoft.Maps.initMapDelayCode,a.Dynamic&&a.Dynamic.done("Microsoft.Maps.Overlays"),ei.end("Map delay initialized","mapdelay")},Microsoft.Maps.Map&&Microsoft.Maps.initMapDelayCode&&window.Microsoft.Maps.initMapDelayCode(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.initInfoboxRenderer=function(){function s(i){function f(t,i,r){if(u.hasHandler(t,i)){var f=n.Screen.get_mouse_pos(r),e=new a(s,"infobox",t,i,f.x,f.y,0,!1,r);u.invoke(t,i,e)}}var s=i,c="cm"+h.getNext(),r=c+"_etr";this.shouldDraw=function(n,t){return n.getVisible()&&t.currentBounds.contains(n.getLocation())},this.update=function(i,h){var bt=h.customRenderer,tt=h.update,l,c=i[r],et,k,a,it,vi,wt,ei,d,ft,p,w,y,yt,v,b,g,ot,pt,kt,pi,nt,hi,lt,ci,ut,at,ni,ii,dt,ri,ui,gt,vt,st;c?(tt=c.updateEntity||tt,c.updateEntity=!1):(l=t(null,e.safariRenderHack),c={dom:l},i[r]=c,tt=!0),l=c.dom,et=i.getTypeName(),k=i.getHtmlContent()==null||i.getTitle()!==null&&i.getTitle()!==""||i.getDescription()!==null&&i.getDescription()!="";if(tt){c.htmlContent!=null&&k&&(c.htmlContent.style.display="none",c.infoBoxNode!=null&&(c.infoBoxNode.style.display=""));if(k){c.infoBoxNode==null?(a=t("div"),l.appendChild(a),a.className=et,c.infoBoxNode=a):(a=c.infoBoxNode,a.className=et),i.getShowCloseButton()&&c.closeButtonNode==null&&k?(it=t("a"),vi=document.createTextNode("x"),a.appendChild(it),it.className="infobox-close",it.href="#",it.appendChild(vi),wt=function(n){n.preventDefault(),i.setOptions({visible:!1})},n(it).add_event("click",wt).add_event("touchend",wt),c.closeButtonHideEvent=wt,c.closeButtonNode=it):i.getShowCloseButton()&&k||!c.closeButtonNode||(n(c.closeButtonNode).remove_event("click",c.closeButtonHideEvent).remove_event("touchend",c.closeButtonHideEvent),c.closeButtonHideEvent=null,a.removeChild(c.closeButtonNode),c.closeButtonNode=null),ei=i.getHeight()-55,i.getActions().length>0&&(ei-=32),d=i.getTitle(),d===""&&(d=null),ft=i.getDescription(),ft===""&&(ft=null),p=c.contentNode,p==null&&k?(p=t("div"),p.className="infobox-body",a.appendChild(p),c.contentNode=p):p==null||k||(a.removeChild(p),c.contentNode=null),d!=null&&(c.titleDivNode==null?(w=t("div"),w.className="infobox-title",p.insertBefore(w,p.firstChild),c.titleDivNode=w):w=c.titleDivNode),y=c.titleLinkNode,y!=null&&(c.titleLinkHandler!=null&&(n(y).remove_event("click",c.titleLinkHandler).remove_event("touchend",c.titleLinkHandler),c.titleLinkHandler=null),y.firstChild&&y.removeChild(y.firstChild),w.removeChild(y),c.titleLinkNode=null,y=null),w!=null&&w.firstChild&&w.removeChild(w.firstChild),d==null&&c.titleDivNode!=null&&(p.removeChild(c.titleDivNode),c.titleDivNode=null),d!=null&&(i.getTitleClickHandler()!=null?(y=t("a"),w.appendChild(y),c.titleLinkNode=y,y.innerHTML=d,y.setAttribute("href","#"),n(y).add_event("click",i.getTitleClickHandler()).add_event("touchend",i.getTitleClickHandler()),c.titleLinkHandler=i.getTitleClickHandler()):w.innerHTML=d),d!==null&&i.getTitleAction()!==null&&(yt=i.getTitleAction(),c.titleAction=[],v=t("a"),v.className="infobox-titleActionLink",v.appendChild(document.createTextNode(yt.label)),v.setAttribute("href","#"),w.appendChild(v),n(v).add_event("click",yt.eventHandler).add_event("touchend",yt.eventHandler)),b=c.descriptionNode,ft!=null&&b==null&&(b=t("div"),b.cssText="height:"+ei+"px",b.className="infobox-info",c.actionsNode?p.insertBefore(b,c.actionsNode):p.appendChild(b),c.descriptionNode=b),ft!=null?b.innerHTML=ft:b&&(l.removeChild(b),c.descriptionNode=null),g=i.getActions();if(g.length>0)if(c.actionsNode!=null){while(c.actionsNode.firstChild)c.actionsNode.removeChild(c.actionsNode.firstChild);ot=c.actionsNode}else ot=t("div"),c.actionsNode=ot,ot.className="infobox-actions",p.appendChild(ot);if(c.actionsEventHandlers!=null)try{while((pt=c.actionsEventHandlers.pop())!=null)n(pt.elem).remove_event("click",pt.event).remove_event("touchend",pt.event)}catch(di){}if(g.length>0){for(kt=t("ul"),kt.className="infobox-actions-list",pi=[],c.actionsEventHandlers=[],nt=0;nt<g.length;nt++){var ai=t("li"),v=t("a"),si,ki=s.getImageryId();switch(ki){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":si="dark";break;default:si="light"}hi=g[nt][si+"Icon"]||g[nt].icon,hi?(v.className="icon",v.style.cssText="background: url("+hi+") no-repeat 0 0;",v.setAttribute("href","#"),v.innerHTML="&nbsp;"):(v.innerHTML=g[nt].label,v.setAttribute("href","#")),ai.appendChild(v),kt.appendChild(ai),n(v).add_event("click",g[nt].eventHandler).add_event("touchend",g[nt].eventHandler),c.actionsEventHandlers.push({elem:v,event:g[nt].eventHandler})}ot.appendChild(kt)}i.getShowPointer()&&c.pointerNode==null&&k?(lt=t("div"),lt.className="infobox-stalk",a.appendChild(lt),c.pointerNode=lt):i.getShowPointer()&&k||!c.pointerNode||(a.removeChild(c.pointerNode),c.pointerNode=null)}else ci=i.getHtmlContent(),ut=c.htmlContent,d==null&&ft==null&&ci!=null&&(ut==null&&(ut=t("div"),l.appendChild(ut),c.htmlContent=ut),ut.innerHTML=ci,a=ut,c.infoBoxNode!=null&&(c.infoBoxNode.style.display="none"),c.pointerNode!=null&&(c.pointerNode.style.display="none"))}var ht="position:absolute;overflow:visible;white-space:normal;line-height:16px;pointer-events:none;",oi="position:absolute;background-color:white;border:1px solid rgb(136, 136, 136);left:0px;top:0px;pointer-events:auto;",li="width:33px;height:38px;overflow:hidden;position:absolute;z-index:1;";if(!bt&&(!h.linear||!c.isDrawn)){at=s.tryLocationToPixel(i.getLocation());if(at){var yi=i.getOffset(),fi=i.getAnchor(),bi=h.parentOffsetLeft||0,wi=h.parentOffsetTop||0,ct=at.x-bi,rt=at.y-wi;ct=ct+yi.x-fi.x,rt=rt-yi.y-fi.y,tt&&k?(ht+="left:"+ct+"px;",ht+="top:"+rt+"px;"):(l.style.position="absolute",l.style.left=ct+"px",l.style.top=rt+"px",l.style.display="")}else tt?ht+="display:none;":l.style.display="none"}if(tt&&k){ni=i.getZIndex(),typeof ni=="number"&&(ht+="z-index:"+ni+";"),oi+="width:"+i.getWidth()+"px;",oi+="height:"+i.getHeight()+"px;",l.style.cssText=ht+e.safariRenderHack,li+="left:20px;",li+="top:"+i.getHeight()+"px;";if(et==="Infobox")c.infoBoxNode.style.cssText=oi;else{var vt=i.getWidth(),st=i.getHeight(),ti="";vt&&(ti+="width:"+vt+"px;"),st&&(ti+="height:"+st+"px;"),c.infoBoxNode.style.cssText=ti}i.getShowPointer()&&et==="Infobox"&&(c.pointerNode.style.cssText=li)}c.mapImageryChanged||(ii=function(){u.invoke(i,"entitychanged",{entity:i})},u.addHandler(s,"imagerychanged",ii),c.mapImageryChanged=ii),c.mouseDoubleClickInfobox||(dt=function(n){f(i,"dblclick",n),n.stopPropagation()},n(l).add_event("dblclick",dt,!0),c.mouseDoubleClickInfobox=dt),c.mouseEnterInfobox||(ri=function(n){f(i,"mouseenter",n),n.stopPropagation()},n(l).add_event("mouseenter",ri,!0),c.mouseEnterInfobox=ri),c.mouseLeaveInfobox||(ui=function(n){f(i,"mouseleave",n),n.stopPropagation()},n(l).add_event("mouseleave",ui,!0),c.mouseLeaveInfobox=ui),c.mouseClickInfobox||(gt=function(n){f(i,"click",n),n.stopPropagation()},n(l).add_event("click",gt,!1),c.mouseClickInfobox=gt),n(l).add_event("touchstart",o),bt?c.isDrawn?tt&&bt.updateEntity(i):(bt.addEntity(i,l),c.isDrawn=!0):(c.isDrawn||(h.parentDom.appendChild(l),c.isDrawn=!0),a&&tt===!0&&(et!==Microsoft.Maps.InfoboxType.standard||i.getHtmlContent()!==null)&&(vt=a.offsetWidth,st=a.offsetHeight,i.setCalculatedSize({width:vt,height:st}),rt=rt+fi.y-st,l.style.top=rt+"px"))},this.remove=function(t,i){if(t&&t[r]){var f=t[r],e=f.dom;e&&(u.removeHandler(f.mapImageryChanged),n(e).remove_event("mouseenter",f.mouseEnterInfobox,!0).remove_event("mouseleave",f.mouseLeaveInfobox,!0).remove_event("click",f.mouseClickInfobox,!1).remove_event("dblclick",f.mouseDoubleClickInfobox,!0).remove_event("touchstart",o,!1),f.mapImageryChanged=f.mouseEnterInfobox=f.mouseLeaveInfobox=f.mouseClickInfobox=f.mouseDoubleClickInfobox=null,!i.parentRemoved&&e.parentNode&&e.parentNode.removeChild(e)),f.updateEntity=f.updateEntity||i.update,f.isDrawn=!1,i.customRenderer&&i.customRenderer.removeEntity(t)}},this.dispose=function(n){delete n[r]}}var r=window.Microsoft.Maps,n=r.Gimme,v=r.Globals,u=r.Events,c=r.Infobox,i=r.InternalNamespaceForDelay,l=i.CompositeMode,f=i.Common,a=i.MouseEventArgs,l=i.CompositeMode,h=i.IdGenerator,e=i.Quirks,o=f.stopPropagation,t=f.createElement,o=f.stopPropagation,t=f.createElement;new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof c){f=n.length;while(f--)n[f]===i&&(u=t[f]);u||(u=new s(i),n.push(i),t.push(u))}return u};l.registerEntityRenderer(i)},delete window.Microsoft.Maps.initInfoboxRenderer},Microsoft.Maps.Map&&Microsoft.Maps.initInfoboxRenderer&&Microsoft.Maps.initInfoboxRenderer(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.Streetside=window.Microsoft.Maps.Streetside||{},window.Microsoft.Maps.initStreetsideAvailabilityCode=function(){function a(i,r,u){var e=i.bounds,a=i.center,p=i.radius||n.BlockLookupService.defaultRadiusInMeters,y,f,l,w,h;u=u||t.streetside360,u===t.streetside360?(y=n.CubeLookupService,f=[1,e],e instanceof s||(l=c(p),e=new s(a,l,l),f=[1,e])):(y=n.BlockLookupService,f=[a,p],a instanceof o||(w=v(e),f=[e.center,w])),h=nt(u,r),f.push(h.available,h.unavailable,h.error),y.lookup.apply(window,f)}function v(n){var i=n.height*h.earthCircumferenceInMeters/360,t=n.width*Math.cos(n.center.latitude*w.radiansPerDegree)*h.earthCircumferenceInMeters/360;return Math.floor(Math.sqrt(t*t+i*i)/2)}function c(n){return n*720/h.earthCircumferenceInMeters}function nt(n,i){function f(n){i(!0,{mapTypeId:t.streetside360,cubeID:n[1].id,center:new o(n[1].la,n[1].lo,n[1].al,g.ellipsoid),cubePitch:n[1].pi,cubeHeading:n[1].he,cubeRoll:n[1].ro})}function e(n,r){n.streetsideMetadata=r,n.mapTypeId=t.streetsideSlide,n.center=n.projectedLatitude!=null&&n.projectedLongitude!=null?new o(n.projectedLatitude,n.projectedLongitude):location,i(!0,n)}function r(){i(!1,null)}function u(){i(!1,null)}return{available:n===t.streetside360?f:e,unavailable:r,error:u}}var r=window.Microsoft.Maps,d=r.Map,y=r.Gimme,i=r.Globals,o=r.Location,s=r.LocationRect,t=r.MapTypeId,g=r.AltitudeReference,n=r.Streetside,u=r.InternalNamespaceForDelay,k=u.Dispatcher,h,w,p,l,e,b,f;u.Streetside=u.Streetside||{},h=u.MapMath,w=u.VectorMath,t.streetside360="ss360",t.streetsideSlide="ssSlide",p=1e6,l=8.5,n.isAvailabilityRectTooLarge=function(i,r){return r===t.streetsideSlide?n.isAvailabilityRadiusTooLarge(v(i),r):i.getNorth()-i.getSouth()>l||i.getEast()-i.getWest()>l},n.isAvailabilityRadiusTooLarge=function(i,r){if(r===t.streetsideSlide)return i>p;var u=c(i),f=new location(0,0);return n.isAvailabilityRectTooLarge(new s(f,u,u))},n.isValidMapTypeId=function(n){return n===t.streetside360||n===t.streetsideSlide},n.checkAvailabilityRadius=function(n,t,i,r){if(n instanceof o&&t>=0){var u={center:n,radius:t,bounds:{}};a(u,i,r)}else throw"Cannot invoke availability lookup service -- insufficient or invalid location and/or radius data";},n.checkAvailabilityRect=function(n,t,i){if(n instanceof s){var r={center:{},radius:null,bounds:n};a(r,t,i)}else throw"Cannot invoke availability lookup service -- insufficient or invalid locationRect";},u.Streetside.estimateRectHeightAndWidthFromRadius=c,d.prototype.isStreetside=function(){var n=this.getMapTypeId();return n===t.streetside360||t===n.streetsideSlide},e=n.Config,function(){if(e)return;n.Config={Debug:!0},e=n.Config}(),n.Debug=function(){this.assert=function(n,t){if(!n&&e.Debug)throw"assert failed: "+t;},this.log=function(n){var t=window.console||{};e.Debug&&t.log&&t.log(n)}},b=n.Debug=new n.Debug,f=new function(){var u,e=0,d="microsoftMapsStreetsideCacheableNetworkCallback{0}",g="microsoftMapsStreetsideNetworkCallback{0}",o=5e3,w=30,b=.5,nt=function(){return u||(u=y("HEAD").element()),u},t={},rt=function(){var i=0,n;for(n in t)t.hasOwnProperty(n)&&++i;return i},ut=function(n,t){return n.time>t.time?1:n.time<t.time?-1:0},tt=function(){var f=rt(),e=Math.floor(f*b),r,n,i=[],u;if(f>=w){for(r in t)t.hasOwnProperty(r)&&(u=t[r],u.id=r,i.push(u));for(i.sort(ut),n=0;n<f-e;++n)i[n].inflight===!1&&delete t[i[n].id]}},it=function(n,i){tt();if(t[n]){if(t[n].listeners.length>0){for(var r=0;r<t[n].listeners.length;++r)t[n].listeners[r](i);t[n].listeners.length=0}}else t[n]={},t[n].listeners=[];t[n].inflight=!1,t[n].data=i,t[n].time=new Date},c=function(n){delete t[n]},h=function(i,r,u){t[r]===undefined&&(t[r]={},t[r].listeners=[],t[r].inflight=!1),t[r].data!==undefined?(t[r].time=new Date,k.dispatch(n.Utils.createCallback(null,u,t[r].data))):(t[r].listeners.push(u),t[r].inflight||(t[r].inflight=!0,a(i,r)))},f=function(t,i,r){t?it(r,i):(n.Debug.log("timed out or 404ed id = "+r),c(r))},l=function(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))},r=function(n,t){var n=n,t=t;return function(){if(window[n]!==undefined)try{delete window[n]}catch(i){window[n]=null}l(y("#"+n).element()),t&&window.clearTimeout(t)}},p=function(n,t,i){var n=n,t=t,i=i,u=r(t,i);return function(t){f(!0,t,n),u()}},v=function(n,t){var n=n,t=t,i=r(t);return function(){f(!1,null,n),i()}},s=function(n,t){var i=document.createElement("script");i.type="text/javascript",i.language="javascript",i.src=n,i.id=t,nt().appendChild(i)},a=function(n,t){var i=d.replace("{0}",t),u=window.setTimeout(v(t,i),o),r;window[i]=p(t,i,u),r=n.replace("{callbackName}",i),s(r,i)};this.getChunkMetadataAsync=function(n,t,r){var u=i.streetsideChunkMetadataUriFormat.replace("{0}",i.locale).replace("{1}",t).replace("{2}",n).replace("{3}",i.streetsideTileGeneration).replace("{4}","{callbackName}");h(u,n,r)},this.getGlobalMetadataAsync=function(n,t,r){var u=i.streetsideGlobalMetadataUriFormat.replace("{0}",i.locale).replace("{1}",t).replace("{2}",n).replace("{3}",i.streetsideTileGeneration).replace("{4}","{callbackName}");h(u,n,r)},this.getJsonAsync=function(n,t){var i=g.replace("{0}",e),h=n.replace("{callbackName}",i),f=function(n,t,i){var u=r(n,t),i=i;return function(n){u(),i(n)}},u=window.setTimeout(r(i),o);window[i]=f(i,u,t),++e,s(h,i)}},n.MetadataService=f,n.BlockLookupService=new function(){this.defaultRadiusInMeters=20;var r=15,u=10,e=1e6,t=function(t,i,r){return function(u){u===null?i():u.statusCode&&u.statusCode!==200?(n.Debug.log("Invalid JSON data"+u.errorDetails),r(u)):u.bl&&u.smd?t(u.bl,u.smd):(n.Debug.log("Unexpected JSON response"),r(u))}};this.lookup=function(o,s,h,c,l){if(o&&o.latitude&&o.longitude&&s&&typeof h=="function"&&typeof c=="function"&&typeof l=="function"){s=Math.min(Math.max(s,u),e);var a=i.streetsideSingleBlockLookupWithDataUriFormat.replace("{0}",i.locale).replace("{1}",i.streetsideTileGeneration).replace("{2}",o.latitude.toFixed(r)).replace("{3}",o.longitude.toFixed(r)).replace("{4}",s).replace("{5}","{callbackName}");f.getJsonAsync(a,t(h,c,l))}else n.Debug.assert(!1,"Expected location, radius, and 3 callback functions as arguments")},this.tokenLookup=function(r,u,e,o){if(r&&typeof u=="function"&&typeof e=="function"&&typeof o=="function"){var s=i.streetsideSingleBlockTokenLookupWithDataUriFormat.replace("{0}",i.locale).replace("{1}",i.streetsideTileGeneration).replace("{2}",r).replace("{3}","{callbackName}");f.getJsonAsync(s,t(u,e,o))}else n.Debug.assert(!1,"Expected token, and 3 callback functions as arguments")}},n.CubeLookupService=new function(){function t(t,i,r){return function(u){u===null?(n.Debug.log("Unexpected JSON response"),r(u)):u.length>1?t(u):i()}}var r=i.streetsideCubeDataLookupUriFormat;this.lookup=function(i,u,e,o,s){i=i||1,o=o||function(){},s=s||function(){},n.Debug.assert(u&&e,"Minimum expected arguments: locationRect, and a callback function");var h=r.replace("{0}",i).replace("{1}",u.getNorth()).replace("{2}",u.getSouth()).replace("{3}",u.getEast()).replace("{4}",u.getWest()).replace("{5}","{callbackName}");f.getJsonAsync(h,t(e,o,s))}},delete window.Microsoft.Maps.initStreetsideAvailabilityCode},Microsoft.Maps.Map&&Microsoft.Maps.initStreetsideAvailabilityCode&&window.Microsoft.Maps.initStreetsideAvailabilityCode()